<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type='text/xsl' href="scriptsql.xsl"?>
<root xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<database includeDrop="true">DeveloperPM_Copy</database>
<procedures>
		
		<procedure owner="dbo" name="DictionaryName_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the DictionaryName table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[DictionaryNameCode],
					[NAME],
					[ProjectCode],
					[Remark]
				FROM
					dbo.[DictionaryName]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="DictionaryName_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the DictionaryName table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DictionaryNameCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (DictionaryNameCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DictionaryNameCode]'
				SET @SQL = @SQL + ' FROM dbo.[DictionaryName]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[DictionaryNameCode], O.[NAME], O.[ProjectCode], O.[Remark]
				FROM
				    dbo.[DictionaryName] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[DictionaryNameCode] = PageIndex.[DictionaryNameCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[DictionaryName]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="DictionaryName_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the DictionaryName table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@NAME" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="400" precision="0" scale="0" param="(400)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[DictionaryName]
					(
					[DictionaryNameCode]
					,[NAME]
					,[ProjectCode]
					,[Remark]
					)
				VALUES
					(
					@DictionaryNameCode
					,@NAME
					,@ProjectCode
					,@Remark
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="DictionaryName_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the DictionaryName table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalDictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@NAME" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="400" precision="0" scale="0" param="(400)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[DictionaryName]
				SET
					[DictionaryNameCode] = @DictionaryNameCode
					,[NAME] = @NAME
					,[ProjectCode] = @ProjectCode
					,[Remark] = @Remark
				WHERE
[DictionaryNameCode] = @OriginalDictionaryNameCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="DictionaryName_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the DictionaryName table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[DictionaryName] WITH (ROWLOCK) 
				WHERE
					[DictionaryNameCode] = @DictionaryNameCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="DictionaryName_GetByDictionaryNameCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the DictionaryName table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[DictionaryNameCode],
					[NAME],
					[ProjectCode],
					[Remark]
				FROM
					dbo.[DictionaryName]
				WHERE
					[DictionaryNameCode] = @DictionaryNameCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="DictionaryName_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the DictionaryName table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@NAME" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="400" precision="0" scale="0" param="(400)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DictionaryNameCode]
	, [NAME]
	, [ProjectCode]
	, [Remark]
    FROM
	dbo.[DictionaryName]
    WHERE 
	 ([DictionaryNameCode] = @DictionaryNameCode OR @DictionaryNameCode is null)
	AND ([NAME] = @NAME OR @NAME is null)
	AND ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([Remark] = @Remark OR @Remark is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DictionaryNameCode]
	, [NAME]
	, [ProjectCode]
	, [Remark]
    FROM
	dbo.[DictionaryName]
    WHERE 
	 ([DictionaryNameCode] = @DictionaryNameCode AND @DictionaryNameCode is not null)
	OR ([NAME] = @NAME AND @NAME is not null)
	OR ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="DictionaryName_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the DictionaryName table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DictionaryNameCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( DictionaryNameCode )
				SELECT TOP {3} [DictionaryNameCode]
				FROM dbo.[DictionaryName] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[DictionaryNameCode], O.[NAME], O.[ProjectCode], O.[Remark]
				FROM
				    dbo.[DictionaryName] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[DictionaryNameCode] = PageIndex.[DictionaryNameCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[DictionaryName] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="InspectSituation_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the InspectSituation table
-- Table Comment: 现场巡查情况记录表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[InspectSituationID],
					[InspectSituationNO],
					[ProjectCode],
					[InspectDate],
					[Weather],
					[InspectUserIpecialty],
					[InspectUser],
					[KeyPoint],
					[Status]
				FROM
					dbo.[InspectSituation]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="InspectSituation_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the InspectSituation table passing page index and page count parameters
-- Table Comment: 现场巡查情况记录表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [InspectSituationID] int 
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (InspectSituationID)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [InspectSituationID]'
				SET @SQL = @SQL + ' FROM dbo.[InspectSituation]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[InspectSituationID], O.[InspectSituationNO], O.[ProjectCode], O.[InspectDate], O.[Weather], O.[InspectUserIpecialty], O.[InspectUser], O.[KeyPoint], O.[Status]
				FROM
				    dbo.[InspectSituation] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[InspectSituationID] = PageIndex.[InspectSituationID]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[InspectSituation]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="InspectSituation_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the InspectSituation table
-- Table Comment: 现场巡查情况记录表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@InspectSituationID" type="int" direction="Output" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@InspectSituationNO" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InspectDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Weather" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InspectUserIpecialty" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@InspectUser" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@KeyPoint" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[InspectSituation]
					(
					[InspectSituationNO]
					,[ProjectCode]
					,[InspectDate]
					,[Weather]
					,[InspectUserIpecialty]
					,[InspectUser]
					,[KeyPoint]
					,[Status]
					)
				VALUES
					(
					@InspectSituationNO
					,@ProjectCode
					,@InspectDate
					,@Weather
					,@InspectUserIpecialty
					,@InspectUser
					,@KeyPoint
					,@Status
					)
				
				-- Get the identity value
				SET @InspectSituationID = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="InspectSituation_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the InspectSituation table
-- Table Comment: 现场巡查情况记录表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@InspectSituationID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@InspectSituationNO" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InspectDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Weather" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InspectUserIpecialty" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@InspectUser" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@KeyPoint" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[InspectSituation]
				SET
					[InspectSituationNO] = @InspectSituationNO
					,[ProjectCode] = @ProjectCode
					,[InspectDate] = @InspectDate
					,[Weather] = @Weather
					,[InspectUserIpecialty] = @InspectUserIpecialty
					,[InspectUser] = @InspectUser
					,[KeyPoint] = @KeyPoint
					,[Status] = @Status
				WHERE
[InspectSituationID] = @InspectSituationID 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="InspectSituation_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the InspectSituation table
-- Table Comment: 现场巡查情况记录表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@InspectSituationID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[InspectSituation] WITH (ROWLOCK) 
				WHERE
					[InspectSituationID] = @InspectSituationID
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="InspectSituation_GetByProjectCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the InspectSituation table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[InspectSituationID],
					[InspectSituationNO],
					[ProjectCode],
					[InspectDate],
					[Weather],
					[InspectUserIpecialty],
					[InspectUser],
					[KeyPoint],
					[Status]
				FROM
					dbo.[InspectSituation]
				WHERE
					[ProjectCode] = @ProjectCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="InspectSituation_GetByInspectUser" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the InspectSituation table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@InspectUser" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[InspectSituationID],
					[InspectSituationNO],
					[ProjectCode],
					[InspectDate],
					[Weather],
					[InspectUserIpecialty],
					[InspectUser],
					[KeyPoint],
					[Status]
				FROM
					dbo.[InspectSituation]
				WHERE
					[InspectUser] = @InspectUser
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="InspectSituation_GetByInspectSituationID" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the InspectSituation table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@InspectSituationID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[InspectSituationID],
					[InspectSituationNO],
					[ProjectCode],
					[InspectDate],
					[Weather],
					[InspectUserIpecialty],
					[InspectUser],
					[KeyPoint],
					[Status]
				FROM
					dbo.[InspectSituation]
				WHERE
					[InspectSituationID] = @InspectSituationID
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="InspectSituation_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the InspectSituation table passing nullable parameters
-- Table Comment: 现场巡查情况记录表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@InspectSituationID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@InspectSituationNO" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@InspectDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Weather" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@InspectUserIpecialty" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@InspectUser" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@KeyPoint" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [InspectSituationID]
	, [InspectSituationNO]
	, [ProjectCode]
	, [InspectDate]
	, [Weather]
	, [InspectUserIpecialty]
	, [InspectUser]
	, [KeyPoint]
	, [Status]
    FROM
	dbo.[InspectSituation]
    WHERE 
	 ([InspectSituationID] = @InspectSituationID OR @InspectSituationID is null)
	AND ([InspectSituationNO] = @InspectSituationNO OR @InspectSituationNO is null)
	AND ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([InspectDate] = @InspectDate OR @InspectDate is null)
	AND ([Weather] = @Weather OR @Weather is null)
	AND ([InspectUserIpecialty] = @InspectUserIpecialty OR @InspectUserIpecialty is null)
	AND ([InspectUser] = @InspectUser OR @InspectUser is null)
	AND ([KeyPoint] = @KeyPoint OR @KeyPoint is null)
	AND ([Status] = @Status OR @Status is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [InspectSituationID]
	, [InspectSituationNO]
	, [ProjectCode]
	, [InspectDate]
	, [Weather]
	, [InspectUserIpecialty]
	, [InspectUser]
	, [KeyPoint]
	, [Status]
    FROM
	dbo.[InspectSituation]
    WHERE 
	 ([InspectSituationID] = @InspectSituationID AND @InspectSituationID is not null)
	OR ([InspectSituationNO] = @InspectSituationNO AND @InspectSituationNO is not null)
	OR ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([InspectDate] = @InspectDate AND @InspectDate is not null)
	OR ([Weather] = @Weather AND @Weather is not null)
	OR ([InspectUserIpecialty] = @InspectUserIpecialty AND @InspectUserIpecialty is not null)
	OR ([InspectUser] = @InspectUser AND @InspectUser is not null)
	OR ([KeyPoint] = @KeyPoint AND @KeyPoint is not null)
	OR ([Status] = @Status AND @Status is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="InspectSituation_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the InspectSituation table using a dynamically generated query.
-- Table Comment: 现场巡查情况记录表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [InspectSituationID] int 
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( InspectSituationID )
				SELECT TOP {3} [InspectSituationID]
				FROM dbo.[InspectSituation] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[InspectSituationID], O.[InspectSituationNO], O.[ProjectCode], O.[InspectDate], O.[Weather], O.[InspectUserIpecialty], O.[InspectUser], O.[KeyPoint], O.[Status]
				FROM
				    dbo.[InspectSituation] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[InspectSituationID] = PageIndex.[InspectSituationID]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[InspectSituation] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Material_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the Material table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[MaterialCode],
					[MaterialName],
					[GroupCode],
					[Spec],
					[Unit],
					[StandardPrice],
					[InputPerson],
					[InputDate],
					[Remark]
				FROM
					dbo.[Material]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Material_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Material table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MaterialCode] int 
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (MaterialCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MaterialCode]'
				SET @SQL = @SQL + ' FROM dbo.[Material]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[MaterialCode], O.[MaterialName], O.[GroupCode], O.[Spec], O.[Unit], O.[StandardPrice], O.[InputPerson], O.[InputDate], O.[Remark]
				FROM
				    dbo.[Material] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[MaterialCode] = PageIndex.[MaterialCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Material]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Material_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the Material table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@MaterialName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Spec" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Unit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@StandardPrice" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@InputPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InputDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Material]
					(
					[MaterialCode]
					,[MaterialName]
					,[GroupCode]
					,[Spec]
					,[Unit]
					,[StandardPrice]
					,[InputPerson]
					,[InputDate]
					,[Remark]
					)
				VALUES
					(
					@MaterialCode
					,@MaterialName
					,@GroupCode
					,@Spec
					,@Unit
					,@StandardPrice
					,@InputPerson
					,@InputDate
					,@Remark
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Material_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the Material table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalMaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@MaterialName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Spec" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Unit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@StandardPrice" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@InputPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InputDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Material]
				SET
					[MaterialCode] = @MaterialCode
					,[MaterialName] = @MaterialName
					,[GroupCode] = @GroupCode
					,[Spec] = @Spec
					,[Unit] = @Unit
					,[StandardPrice] = @StandardPrice
					,[InputPerson] = @InputPerson
					,[InputDate] = @InputDate
					,[Remark] = @Remark
				WHERE
[MaterialCode] = @OriginalMaterialCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Material_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the Material table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Material] WITH (ROWLOCK) 
				WHERE
					[MaterialCode] = @MaterialCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Material_GetByMaterialCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Material table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[MaterialCode],
					[MaterialName],
					[GroupCode],
					[Spec],
					[Unit],
					[StandardPrice],
					[InputPerson],
					[InputDate],
					[Remark]
				FROM
					dbo.[Material]
				WHERE
					[MaterialCode] = @MaterialCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Material_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the Material table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@MaterialName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Spec" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@Unit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@StandardPrice" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@InputPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@InputDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MaterialCode]
	, [MaterialName]
	, [GroupCode]
	, [Spec]
	, [Unit]
	, [StandardPrice]
	, [InputPerson]
	, [InputDate]
	, [Remark]
    FROM
	dbo.[Material]
    WHERE 
	 ([MaterialCode] = @MaterialCode OR @MaterialCode is null)
	AND ([MaterialName] = @MaterialName OR @MaterialName is null)
	AND ([GroupCode] = @GroupCode OR @GroupCode is null)
	AND ([Spec] = @Spec OR @Spec is null)
	AND ([Unit] = @Unit OR @Unit is null)
	AND ([StandardPrice] = @StandardPrice OR @StandardPrice is null)
	AND ([InputPerson] = @InputPerson OR @InputPerson is null)
	AND ([InputDate] = @InputDate OR @InputDate is null)
	AND ([Remark] = @Remark OR @Remark is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MaterialCode]
	, [MaterialName]
	, [GroupCode]
	, [Spec]
	, [Unit]
	, [StandardPrice]
	, [InputPerson]
	, [InputDate]
	, [Remark]
    FROM
	dbo.[Material]
    WHERE 
	 ([MaterialCode] = @MaterialCode AND @MaterialCode is not null)
	OR ([MaterialName] = @MaterialName AND @MaterialName is not null)
	OR ([GroupCode] = @GroupCode AND @GroupCode is not null)
	OR ([Spec] = @Spec AND @Spec is not null)
	OR ([Unit] = @Unit AND @Unit is not null)
	OR ([StandardPrice] = @StandardPrice AND @StandardPrice is not null)
	OR ([InputPerson] = @InputPerson AND @InputPerson is not null)
	OR ([InputDate] = @InputDate AND @InputDate is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="Material_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Material table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MaterialCode] int 
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( MaterialCode )
				SELECT TOP {3} [MaterialCode]
				FROM dbo.[Material] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[MaterialCode], O.[MaterialName], O.[GroupCode], O.[Spec], O.[Unit], O.[StandardPrice], O.[InputPerson], O.[InputDate], O.[Remark]
				FROM
				    dbo.[Material] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[MaterialCode] = PageIndex.[MaterialCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[Material] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="DictionaryItem_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the DictionaryItem table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[DictionaryItemCode],
					[ProjectCode],
					[DictionaryNameCode],
					[SortID],
					[Name]
				FROM
					dbo.[DictionaryItem]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="DictionaryItem_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the DictionaryItem table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DictionaryItemCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (DictionaryItemCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DictionaryItemCode]'
				SET @SQL = @SQL + ' FROM dbo.[DictionaryItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[DictionaryItemCode], O.[ProjectCode], O.[DictionaryNameCode], O.[SortID], O.[Name]
				FROM
				    dbo.[DictionaryItem] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[DictionaryItemCode] = PageIndex.[DictionaryItemCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[DictionaryItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="DictionaryItem_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the DictionaryItem table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SortID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[DictionaryItem]
					(
					[DictionaryItemCode]
					,[ProjectCode]
					,[DictionaryNameCode]
					,[SortID]
					,[Name]
					)
				VALUES
					(
					@DictionaryItemCode
					,@ProjectCode
					,@DictionaryNameCode
					,@SortID
					,@Name
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="DictionaryItem_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the DictionaryItem table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalDictionaryItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SortID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[DictionaryItem]
				SET
					[DictionaryItemCode] = @DictionaryItemCode
					,[ProjectCode] = @ProjectCode
					,[DictionaryNameCode] = @DictionaryNameCode
					,[SortID] = @SortID
					,[Name] = @Name
				WHERE
[DictionaryItemCode] = @OriginalDictionaryItemCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="DictionaryItem_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the DictionaryItem table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[DictionaryItem] WITH (ROWLOCK) 
				WHERE
					[DictionaryItemCode] = @DictionaryItemCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="DictionaryItem_GetByDictionaryNameCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the DictionaryItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[DictionaryItemCode],
					[ProjectCode],
					[DictionaryNameCode],
					[SortID],
					[Name]
				FROM
					dbo.[DictionaryItem]
				WHERE
					[DictionaryNameCode] = @DictionaryNameCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="DictionaryItem_GetByDictionaryItemCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the DictionaryItem table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@DictionaryItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[DictionaryItemCode],
					[ProjectCode],
					[DictionaryNameCode],
					[SortID],
					[Name]
				FROM
					dbo.[DictionaryItem]
				WHERE
					[DictionaryItemCode] = @DictionaryItemCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="DictionaryItem_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the DictionaryItem table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@DictionaryItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@DictionaryNameCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@SortID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Name" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DictionaryItemCode]
	, [ProjectCode]
	, [DictionaryNameCode]
	, [SortID]
	, [Name]
    FROM
	dbo.[DictionaryItem]
    WHERE 
	 ([DictionaryItemCode] = @DictionaryItemCode OR @DictionaryItemCode is null)
	AND ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([DictionaryNameCode] = @DictionaryNameCode OR @DictionaryNameCode is null)
	AND ([SortID] = @SortID OR @SortID is null)
	AND ([Name] = @Name OR @Name is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DictionaryItemCode]
	, [ProjectCode]
	, [DictionaryNameCode]
	, [SortID]
	, [Name]
    FROM
	dbo.[DictionaryItem]
    WHERE 
	 ([DictionaryItemCode] = @DictionaryItemCode AND @DictionaryItemCode is not null)
	OR ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([DictionaryNameCode] = @DictionaryNameCode AND @DictionaryNameCode is not null)
	OR ([SortID] = @SortID AND @SortID is not null)
	OR ([Name] = @Name AND @Name is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="DictionaryItem_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the DictionaryItem table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DictionaryItemCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( DictionaryItemCode )
				SELECT TOP {3} [DictionaryItemCode]
				FROM dbo.[DictionaryItem] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[DictionaryItemCode], O.[ProjectCode], O.[DictionaryNameCode], O.[SortID], O.[Name]
				FROM
				    dbo.[DictionaryItem] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[DictionaryItemCode] = PageIndex.[DictionaryItemCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[DictionaryItem] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="SystemUser_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the SystemUser table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[UserCode],
					[UserID],
					[UserName],
					[OwnName],
					[PassWord],
					[Sex],
					[Phone],
					[MailBox],
					[Note],
					[BirthDay],
					[PhoneHome],
					[Address],
					[Mobile],
					[Fax],
					[Status],
					[LastProjectCode],
					[SortID],
					[ShortUserName]
				FROM
					dbo.[SystemUser]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="SystemUser_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the SystemUser table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [UserCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (UserCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [UserCode]'
				SET @SQL = @SQL + ' FROM dbo.[SystemUser]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[UserCode], O.[UserID], O.[UserName], O.[OwnName], O.[PassWord], O.[Sex], O.[Phone], O.[MailBox], O.[Note], O.[BirthDay], O.[PhoneHome], O.[Address], O.[Mobile], O.[Fax], O.[Status], O.[LastProjectCode], O.[SortID], O.[ShortUserName]
				FROM
				    dbo.[SystemUser] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[UserCode] = PageIndex.[UserCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[SystemUser]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="SystemUser_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the SystemUser table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@UserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@UserID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@UserName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OwnName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PassWord" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Sex" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Phone" type="varchar" direction="Input" size="16" precision="0" scale="0" param="(16)" nulldefault=""/>
				<parameter name="@MailBox" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault=""/>
				<parameter name="@Note" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BirthDay" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PhoneHome" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Address" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Mobile" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Fax" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LastProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SortID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ShortUserName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[SystemUser]
					(
					[UserCode]
					,[UserID]
					,[UserName]
					,[OwnName]
					,[PassWord]
					,[Sex]
					,[Phone]
					,[MailBox]
					,[Note]
					,[BirthDay]
					,[PhoneHome]
					,[Address]
					,[Mobile]
					,[Fax]
					,[Status]
					,[LastProjectCode]
					,[SortID]
					,[ShortUserName]
					)
				VALUES
					(
					@UserCode
					,@UserID
					,@UserName
					,@OwnName
					,@PassWord
					,@Sex
					,@Phone
					,@MailBox
					,@Note
					,@BirthDay
					,@PhoneHome
					,@Address
					,@Mobile
					,@Fax
					,@Status
					,@LastProjectCode
					,@SortID
					,@ShortUserName
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="SystemUser_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the SystemUser table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@UserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalUserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@UserID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@UserName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OwnName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PassWord" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Sex" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Phone" type="varchar" direction="Input" size="16" precision="0" scale="0" param="(16)" nulldefault=""/>
				<parameter name="@MailBox" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault=""/>
				<parameter name="@Note" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BirthDay" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PhoneHome" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Address" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Mobile" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Fax" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LastProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SortID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ShortUserName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[SystemUser]
				SET
					[UserCode] = @UserCode
					,[UserID] = @UserID
					,[UserName] = @UserName
					,[OwnName] = @OwnName
					,[PassWord] = @PassWord
					,[Sex] = @Sex
					,[Phone] = @Phone
					,[MailBox] = @MailBox
					,[Note] = @Note
					,[BirthDay] = @BirthDay
					,[PhoneHome] = @PhoneHome
					,[Address] = @Address
					,[Mobile] = @Mobile
					,[Fax] = @Fax
					,[Status] = @Status
					,[LastProjectCode] = @LastProjectCode
					,[SortID] = @SortID
					,[ShortUserName] = @ShortUserName
				WHERE
[UserCode] = @OriginalUserCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="SystemUser_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the SystemUser table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@UserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[SystemUser] WITH (ROWLOCK) 
				WHERE
					[UserCode] = @UserCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="SystemUser_GetByUserCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the SystemUser table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@UserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[UserCode],
					[UserID],
					[UserName],
					[OwnName],
					[PassWord],
					[Sex],
					[Phone],
					[MailBox],
					[Note],
					[BirthDay],
					[PhoneHome],
					[Address],
					[Mobile],
					[Fax],
					[Status],
					[LastProjectCode],
					[SortID],
					[ShortUserName]
				FROM
					dbo.[SystemUser]
				WHERE
					[UserCode] = @UserCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="SystemUser_GetByUserID" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the SystemUser table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@UserID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[UserCode],
					[UserID],
					[UserName],
					[OwnName],
					[PassWord],
					[Sex],
					[Phone],
					[MailBox],
					[Note],
					[BirthDay],
					[PhoneHome],
					[Address],
					[Mobile],
					[Fax],
					[Status],
					[LastProjectCode],
					[SortID],
					[ShortUserName]
				FROM
					dbo.[SystemUser]
				WHERE
					[UserID] = @UserID
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="SystemUser_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the SystemUser table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@UserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@UserID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@UserName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@OwnName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PassWord" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Sex" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Phone" type="varchar" direction="Input" size="16" precision="0" scale="0" param="(16)" nulldefault="null"/>
				<parameter name="@MailBox" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault="null"/>
				<parameter name="@Note" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BirthDay" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@PhoneHome" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Address" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Mobile" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Fax" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@LastProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@SortID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ShortUserName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [UserCode]
	, [UserID]
	, [UserName]
	, [OwnName]
	, [PassWord]
	, [Sex]
	, [Phone]
	, [MailBox]
	, [Note]
	, [BirthDay]
	, [PhoneHome]
	, [Address]
	, [Mobile]
	, [Fax]
	, [Status]
	, [LastProjectCode]
	, [SortID]
	, [ShortUserName]
    FROM
	dbo.[SystemUser]
    WHERE 
	 ([UserCode] = @UserCode OR @UserCode is null)
	AND ([UserID] = @UserID OR @UserID is null)
	AND ([UserName] = @UserName OR @UserName is null)
	AND ([OwnName] = @OwnName OR @OwnName is null)
	AND ([PassWord] = @PassWord OR @PassWord is null)
	AND ([Sex] = @Sex OR @Sex is null)
	AND ([Phone] = @Phone OR @Phone is null)
	AND ([MailBox] = @MailBox OR @MailBox is null)
	AND ([Note] = @Note OR @Note is null)
	AND ([BirthDay] = @BirthDay OR @BirthDay is null)
	AND ([PhoneHome] = @PhoneHome OR @PhoneHome is null)
	AND ([Address] = @Address OR @Address is null)
	AND ([Mobile] = @Mobile OR @Mobile is null)
	AND ([Fax] = @Fax OR @Fax is null)
	AND ([Status] = @Status OR @Status is null)
	AND ([LastProjectCode] = @LastProjectCode OR @LastProjectCode is null)
	AND ([SortID] = @SortID OR @SortID is null)
	AND ([ShortUserName] = @ShortUserName OR @ShortUserName is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [UserCode]
	, [UserID]
	, [UserName]
	, [OwnName]
	, [PassWord]
	, [Sex]
	, [Phone]
	, [MailBox]
	, [Note]
	, [BirthDay]
	, [PhoneHome]
	, [Address]
	, [Mobile]
	, [Fax]
	, [Status]
	, [LastProjectCode]
	, [SortID]
	, [ShortUserName]
    FROM
	dbo.[SystemUser]
    WHERE 
	 ([UserCode] = @UserCode AND @UserCode is not null)
	OR ([UserID] = @UserID AND @UserID is not null)
	OR ([UserName] = @UserName AND @UserName is not null)
	OR ([OwnName] = @OwnName AND @OwnName is not null)
	OR ([PassWord] = @PassWord AND @PassWord is not null)
	OR ([Sex] = @Sex AND @Sex is not null)
	OR ([Phone] = @Phone AND @Phone is not null)
	OR ([MailBox] = @MailBox AND @MailBox is not null)
	OR ([Note] = @Note AND @Note is not null)
	OR ([BirthDay] = @BirthDay AND @BirthDay is not null)
	OR ([PhoneHome] = @PhoneHome AND @PhoneHome is not null)
	OR ([Address] = @Address AND @Address is not null)
	OR ([Mobile] = @Mobile AND @Mobile is not null)
	OR ([Fax] = @Fax AND @Fax is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([LastProjectCode] = @LastProjectCode AND @LastProjectCode is not null)
	OR ([SortID] = @SortID AND @SortID is not null)
	OR ([ShortUserName] = @ShortUserName AND @ShortUserName is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="SystemUser_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the SystemUser table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [UserCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( UserCode )
				SELECT TOP {3} [UserCode]
				FROM dbo.[SystemUser] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[UserCode], O.[UserID], O.[UserName], O.[OwnName], O.[PassWord], O.[Sex], O.[Phone], O.[MailBox], O.[Note], O.[BirthDay], O.[PhoneHome], O.[Address], O.[Mobile], O.[Fax], O.[Status], O.[LastProjectCode], O.[SortID], O.[ShortUserName]
				FROM
				    dbo.[SystemUser] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[UserCode] = PageIndex.[UserCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[SystemUser] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Project_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the Project table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ProjectCode],
					[ProjectName],
					[City],
					[Area],
					[BlockName],
					[BlockID],
					[BuildSpace],
					[AfforestingRate],
					[TotalBuildingSpace],
					[TotalFloorSpace],
					[PlannedVolumeRate],
					[BuildingDensity],
					[BuildingSpaceForVolumeRate],
					[BuildingSpaceNotVolumeRate],
					[IsEstimate],
					[Remark],
					[Tj_date],
					[SubjectSetCode],
					[Status],
					[ProjectId],
					[ProjectAddress],
					[ImagePath],
					[UnitCode],
					[jd],
					[jdxz],
					[JDBM],
					[DevelopUnit],
					[SalProjectCode],
					[kgDate],
					[jgDate],
					[PlanStartDate],
					[PlanEndDate],
					[ProjectShortName],
					[UnderBuildingSpace],
					[UnderFloorSpace],
					[AfforestingSpace],
					[CenterAfforestingSpace],
					[CenterAfforestingRate],
					[ParkingSpace],
					[UnderParkingSpace],
					[HouseCount],
					[HouseUse],
					[PTFeeType],
					[PTFeeVoucherID],
					[HouseBuildingSpace],
					[BsBuildingSpace],
					[Manager],
					[U8Code],
					[DevelopUnitAddress],
					[waterspace],
					[peripheryspace],
					[IsUseShortName]
				FROM
					dbo.[Project]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Project_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Project table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ProjectCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ProjectCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ProjectCode]'
				SET @SQL = @SQL + ' FROM dbo.[Project]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ProjectCode], O.[ProjectName], O.[City], O.[Area], O.[BlockName], O.[BlockID], O.[BuildSpace], O.[AfforestingRate], O.[TotalBuildingSpace], O.[TotalFloorSpace], O.[PlannedVolumeRate], O.[BuildingDensity], O.[BuildingSpaceForVolumeRate], O.[BuildingSpaceNotVolumeRate], O.[IsEstimate], O.[Remark], O.[Tj_date], O.[SubjectSetCode], O.[Status], O.[ProjectId], O.[ProjectAddress], O.[ImagePath], O.[UnitCode], O.[jd], O.[jdxz], O.[JDBM], O.[DevelopUnit], O.[SalProjectCode], O.[kgDate], O.[jgDate], O.[PlanStartDate], O.[PlanEndDate], O.[ProjectShortName], O.[UnderBuildingSpace], O.[UnderFloorSpace], O.[AfforestingSpace], O.[CenterAfforestingSpace], O.[CenterAfforestingRate], O.[ParkingSpace], O.[UnderParkingSpace], O.[HouseCount], O.[HouseUse], O.[PTFeeType], O.[PTFeeVoucherID], O.[HouseBuildingSpace], O.[BsBuildingSpace], O.[Manager], O.[U8Code], O.[DevelopUnitAddress], O.[waterspace], O.[peripheryspace], O.[IsUseShortName]
				FROM
				    dbo.[Project] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ProjectCode] = PageIndex.[ProjectCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Project]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Project_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the Project table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@City" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Area" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BlockName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BlockID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BuildSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AfforestingRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalFloorSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PlannedVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@BuildingDensity" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@BuildingSpaceForVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@BuildingSpaceNotVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@IsEstimate" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Tj_date" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@SubjectSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Status" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectId" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectAddress" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@ImagePath" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Jd" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Jdxz" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@JDBM" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@DevelopUnit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SalProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@KgDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@JgDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PlanStartDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PlanEndDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ProjectShortName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@UnderBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@UnderFloorSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AfforestingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CenterAfforestingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CenterAfforestingRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ParkingSpace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@UnderParkingSpace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@HouseCount" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@HouseUse" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PTFeeType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PTFeeVoucherID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@HouseBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@BsBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Manager" type="varchar" direction="Input" size="150" precision="0" scale="0" param="(150)" nulldefault=""/>
				<parameter name="@U8Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@DevelopUnitAddress" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Waterspace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@Peripheryspace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@IsUseShortName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Project]
					(
					[ProjectCode]
					,[ProjectName]
					,[City]
					,[Area]
					,[BlockName]
					,[BlockID]
					,[BuildSpace]
					,[AfforestingRate]
					,[TotalBuildingSpace]
					,[TotalFloorSpace]
					,[PlannedVolumeRate]
					,[BuildingDensity]
					,[BuildingSpaceForVolumeRate]
					,[BuildingSpaceNotVolumeRate]
					,[IsEstimate]
					,[Remark]
					,[Tj_date]
					,[SubjectSetCode]
					,[Status]
					,[ProjectId]
					,[ProjectAddress]
					,[ImagePath]
					,[UnitCode]
					,[jd]
					,[jdxz]
					,[JDBM]
					,[DevelopUnit]
					,[SalProjectCode]
					,[kgDate]
					,[jgDate]
					,[PlanStartDate]
					,[PlanEndDate]
					,[ProjectShortName]
					,[UnderBuildingSpace]
					,[UnderFloorSpace]
					,[AfforestingSpace]
					,[CenterAfforestingSpace]
					,[CenterAfforestingRate]
					,[ParkingSpace]
					,[UnderParkingSpace]
					,[HouseCount]
					,[HouseUse]
					,[PTFeeType]
					,[PTFeeVoucherID]
					,[HouseBuildingSpace]
					,[BsBuildingSpace]
					,[Manager]
					,[U8Code]
					,[DevelopUnitAddress]
					,[waterspace]
					,[peripheryspace]
					,[IsUseShortName]
					)
				VALUES
					(
					@ProjectCode
					,@ProjectName
					,@City
					,@Area
					,@BlockName
					,@BlockID
					,@BuildSpace
					,@AfforestingRate
					,@TotalBuildingSpace
					,@TotalFloorSpace
					,@PlannedVolumeRate
					,@BuildingDensity
					,@BuildingSpaceForVolumeRate
					,@BuildingSpaceNotVolumeRate
					,@IsEstimate
					,@Remark
					,@Tj_date
					,@SubjectSetCode
					,@Status
					,@ProjectId
					,@ProjectAddress
					,@ImagePath
					,@UnitCode
					,@Jd
					,@Jdxz
					,@JDBM
					,@DevelopUnit
					,@SalProjectCode
					,@KgDate
					,@JgDate
					,@PlanStartDate
					,@PlanEndDate
					,@ProjectShortName
					,@UnderBuildingSpace
					,@UnderFloorSpace
					,@AfforestingSpace
					,@CenterAfforestingSpace
					,@CenterAfforestingRate
					,@ParkingSpace
					,@UnderParkingSpace
					,@HouseCount
					,@HouseUse
					,@PTFeeType
					,@PTFeeVoucherID
					,@HouseBuildingSpace
					,@BsBuildingSpace
					,@Manager
					,@U8Code
					,@DevelopUnitAddress
					,@Waterspace
					,@Peripheryspace
					,@IsUseShortName
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Project_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the Project table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@City" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Area" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BlockName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BlockID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BuildSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AfforestingRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalFloorSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PlannedVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@BuildingDensity" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@BuildingSpaceForVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@BuildingSpaceNotVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@IsEstimate" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Tj_date" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@SubjectSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Status" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectId" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectAddress" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@ImagePath" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Jd" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Jdxz" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@JDBM" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@DevelopUnit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SalProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@KgDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@JgDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PlanStartDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PlanEndDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ProjectShortName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@UnderBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@UnderFloorSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AfforestingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CenterAfforestingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CenterAfforestingRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ParkingSpace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@UnderParkingSpace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@HouseCount" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@HouseUse" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PTFeeType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PTFeeVoucherID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@HouseBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@BsBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Manager" type="varchar" direction="Input" size="150" precision="0" scale="0" param="(150)" nulldefault=""/>
				<parameter name="@U8Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@DevelopUnitAddress" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Waterspace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@Peripheryspace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@IsUseShortName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Project]
				SET
					[ProjectCode] = @ProjectCode
					,[ProjectName] = @ProjectName
					,[City] = @City
					,[Area] = @Area
					,[BlockName] = @BlockName
					,[BlockID] = @BlockID
					,[BuildSpace] = @BuildSpace
					,[AfforestingRate] = @AfforestingRate
					,[TotalBuildingSpace] = @TotalBuildingSpace
					,[TotalFloorSpace] = @TotalFloorSpace
					,[PlannedVolumeRate] = @PlannedVolumeRate
					,[BuildingDensity] = @BuildingDensity
					,[BuildingSpaceForVolumeRate] = @BuildingSpaceForVolumeRate
					,[BuildingSpaceNotVolumeRate] = @BuildingSpaceNotVolumeRate
					,[IsEstimate] = @IsEstimate
					,[Remark] = @Remark
					,[Tj_date] = @Tj_date
					,[SubjectSetCode] = @SubjectSetCode
					,[Status] = @Status
					,[ProjectId] = @ProjectId
					,[ProjectAddress] = @ProjectAddress
					,[ImagePath] = @ImagePath
					,[UnitCode] = @UnitCode
					,[jd] = @Jd
					,[jdxz] = @Jdxz
					,[JDBM] = @JDBM
					,[DevelopUnit] = @DevelopUnit
					,[SalProjectCode] = @SalProjectCode
					,[kgDate] = @KgDate
					,[jgDate] = @JgDate
					,[PlanStartDate] = @PlanStartDate
					,[PlanEndDate] = @PlanEndDate
					,[ProjectShortName] = @ProjectShortName
					,[UnderBuildingSpace] = @UnderBuildingSpace
					,[UnderFloorSpace] = @UnderFloorSpace
					,[AfforestingSpace] = @AfforestingSpace
					,[CenterAfforestingSpace] = @CenterAfforestingSpace
					,[CenterAfforestingRate] = @CenterAfforestingRate
					,[ParkingSpace] = @ParkingSpace
					,[UnderParkingSpace] = @UnderParkingSpace
					,[HouseCount] = @HouseCount
					,[HouseUse] = @HouseUse
					,[PTFeeType] = @PTFeeType
					,[PTFeeVoucherID] = @PTFeeVoucherID
					,[HouseBuildingSpace] = @HouseBuildingSpace
					,[BsBuildingSpace] = @BsBuildingSpace
					,[Manager] = @Manager
					,[U8Code] = @U8Code
					,[DevelopUnitAddress] = @DevelopUnitAddress
					,[waterspace] = @Waterspace
					,[peripheryspace] = @Peripheryspace
					,[IsUseShortName] = @IsUseShortName
				WHERE
[ProjectCode] = @OriginalProjectCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Project_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the Project table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Project] WITH (ROWLOCK) 
				WHERE
					[ProjectCode] = @ProjectCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Project_GetByProjectCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Project table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ProjectCode],
					[ProjectName],
					[City],
					[Area],
					[BlockName],
					[BlockID],
					[BuildSpace],
					[AfforestingRate],
					[TotalBuildingSpace],
					[TotalFloorSpace],
					[PlannedVolumeRate],
					[BuildingDensity],
					[BuildingSpaceForVolumeRate],
					[BuildingSpaceNotVolumeRate],
					[IsEstimate],
					[Remark],
					[Tj_date],
					[SubjectSetCode],
					[Status],
					[ProjectId],
					[ProjectAddress],
					[ImagePath],
					[UnitCode],
					[jd],
					[jdxz],
					[JDBM],
					[DevelopUnit],
					[SalProjectCode],
					[kgDate],
					[jgDate],
					[PlanStartDate],
					[PlanEndDate],
					[ProjectShortName],
					[UnderBuildingSpace],
					[UnderFloorSpace],
					[AfforestingSpace],
					[CenterAfforestingSpace],
					[CenterAfforestingRate],
					[ParkingSpace],
					[UnderParkingSpace],
					[HouseCount],
					[HouseUse],
					[PTFeeType],
					[PTFeeVoucherID],
					[HouseBuildingSpace],
					[BsBuildingSpace],
					[Manager],
					[U8Code],
					[DevelopUnitAddress],
					[waterspace],
					[peripheryspace],
					[IsUseShortName]
				FROM
					dbo.[Project]
				WHERE
					[ProjectCode] = @ProjectCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Project_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the Project table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ProjectName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@City" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Area" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BlockName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BlockID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BuildSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AfforestingRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@TotalBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@TotalFloorSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PlannedVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@BuildingDensity" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@BuildingSpaceForVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@BuildingSpaceNotVolumeRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@IsEstimate" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@Tj_date" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@SubjectSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Status" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ProjectId" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ProjectAddress" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@ImagePath" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Jd" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Jdxz" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@JDBM" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@DevelopUnit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@SalProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@KgDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@JgDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@PlanStartDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@PlanEndDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ProjectShortName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@UnderBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@UnderFloorSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AfforestingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@CenterAfforestingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@CenterAfforestingRate" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ParkingSpace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault="null"/>
				<parameter name="@UnderParkingSpace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault="null"/>
				<parameter name="@HouseCount" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault="null"/>
				<parameter name="@HouseUse" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PTFeeType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PTFeeVoucherID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@HouseBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@BsBuildingSpace" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@Manager" type="varchar" direction="Input" size="150" precision="0" scale="0" param="(150)" nulldefault="null"/>
				<parameter name="@U8Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@DevelopUnitAddress" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@Waterspace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault="null"/>
				<parameter name="@Peripheryspace" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault="null"/>
				<parameter name="@IsUseShortName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ProjectCode]
	, [ProjectName]
	, [City]
	, [Area]
	, [BlockName]
	, [BlockID]
	, [BuildSpace]
	, [AfforestingRate]
	, [TotalBuildingSpace]
	, [TotalFloorSpace]
	, [PlannedVolumeRate]
	, [BuildingDensity]
	, [BuildingSpaceForVolumeRate]
	, [BuildingSpaceNotVolumeRate]
	, [IsEstimate]
	, [Remark]
	, [Tj_date]
	, [SubjectSetCode]
	, [Status]
	, [ProjectId]
	, [ProjectAddress]
	, [ImagePath]
	, [UnitCode]
	, [jd]
	, [jdxz]
	, [JDBM]
	, [DevelopUnit]
	, [SalProjectCode]
	, [kgDate]
	, [jgDate]
	, [PlanStartDate]
	, [PlanEndDate]
	, [ProjectShortName]
	, [UnderBuildingSpace]
	, [UnderFloorSpace]
	, [AfforestingSpace]
	, [CenterAfforestingSpace]
	, [CenterAfforestingRate]
	, [ParkingSpace]
	, [UnderParkingSpace]
	, [HouseCount]
	, [HouseUse]
	, [PTFeeType]
	, [PTFeeVoucherID]
	, [HouseBuildingSpace]
	, [BsBuildingSpace]
	, [Manager]
	, [U8Code]
	, [DevelopUnitAddress]
	, [waterspace]
	, [peripheryspace]
	, [IsUseShortName]
    FROM
	dbo.[Project]
    WHERE 
	 ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([ProjectName] = @ProjectName OR @ProjectName is null)
	AND ([City] = @City OR @City is null)
	AND ([Area] = @Area OR @Area is null)
	AND ([BlockName] = @BlockName OR @BlockName is null)
	AND ([BlockID] = @BlockID OR @BlockID is null)
	AND ([BuildSpace] = @BuildSpace OR @BuildSpace is null)
	AND ([AfforestingRate] = @AfforestingRate OR @AfforestingRate is null)
	AND ([TotalBuildingSpace] = @TotalBuildingSpace OR @TotalBuildingSpace is null)
	AND ([TotalFloorSpace] = @TotalFloorSpace OR @TotalFloorSpace is null)
	AND ([PlannedVolumeRate] = @PlannedVolumeRate OR @PlannedVolumeRate is null)
	AND ([BuildingDensity] = @BuildingDensity OR @BuildingDensity is null)
	AND ([BuildingSpaceForVolumeRate] = @BuildingSpaceForVolumeRate OR @BuildingSpaceForVolumeRate is null)
	AND ([BuildingSpaceNotVolumeRate] = @BuildingSpaceNotVolumeRate OR @BuildingSpaceNotVolumeRate is null)
	AND ([IsEstimate] = @IsEstimate OR @IsEstimate is null)
	AND ([Remark] = @Remark OR @Remark is null)
	AND ([Tj_date] = @Tj_date OR @Tj_date is null)
	AND ([SubjectSetCode] = @SubjectSetCode OR @SubjectSetCode is null)
	AND ([Status] = @Status OR @Status is null)
	AND ([ProjectId] = @ProjectId OR @ProjectId is null)
	AND ([ProjectAddress] = @ProjectAddress OR @ProjectAddress is null)
	AND ([ImagePath] = @ImagePath OR @ImagePath is null)
	AND ([UnitCode] = @UnitCode OR @UnitCode is null)
	AND ([jd] = @Jd OR @Jd is null)
	AND ([jdxz] = @Jdxz OR @Jdxz is null)
	AND ([JDBM] = @JDBM OR @JDBM is null)
	AND ([DevelopUnit] = @DevelopUnit OR @DevelopUnit is null)
	AND ([SalProjectCode] = @SalProjectCode OR @SalProjectCode is null)
	AND ([kgDate] = @KgDate OR @KgDate is null)
	AND ([jgDate] = @JgDate OR @JgDate is null)
	AND ([PlanStartDate] = @PlanStartDate OR @PlanStartDate is null)
	AND ([PlanEndDate] = @PlanEndDate OR @PlanEndDate is null)
	AND ([ProjectShortName] = @ProjectShortName OR @ProjectShortName is null)
	AND ([UnderBuildingSpace] = @UnderBuildingSpace OR @UnderBuildingSpace is null)
	AND ([UnderFloorSpace] = @UnderFloorSpace OR @UnderFloorSpace is null)
	AND ([AfforestingSpace] = @AfforestingSpace OR @AfforestingSpace is null)
	AND ([CenterAfforestingSpace] = @CenterAfforestingSpace OR @CenterAfforestingSpace is null)
	AND ([CenterAfforestingRate] = @CenterAfforestingRate OR @CenterAfforestingRate is null)
	AND ([ParkingSpace] = @ParkingSpace OR @ParkingSpace is null)
	AND ([UnderParkingSpace] = @UnderParkingSpace OR @UnderParkingSpace is null)
	AND ([HouseCount] = @HouseCount OR @HouseCount is null)
	AND ([HouseUse] = @HouseUse OR @HouseUse is null)
	AND ([PTFeeType] = @PTFeeType OR @PTFeeType is null)
	AND ([PTFeeVoucherID] = @PTFeeVoucherID OR @PTFeeVoucherID is null)
	AND ([HouseBuildingSpace] = @HouseBuildingSpace OR @HouseBuildingSpace is null)
	AND ([BsBuildingSpace] = @BsBuildingSpace OR @BsBuildingSpace is null)
	AND ([Manager] = @Manager OR @Manager is null)
	AND ([U8Code] = @U8Code OR @U8Code is null)
	AND ([DevelopUnitAddress] = @DevelopUnitAddress OR @DevelopUnitAddress is null)
	AND ([waterspace] = @Waterspace OR @Waterspace is null)
	AND ([peripheryspace] = @Peripheryspace OR @Peripheryspace is null)
	AND ([IsUseShortName] = @IsUseShortName OR @IsUseShortName is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ProjectCode]
	, [ProjectName]
	, [City]
	, [Area]
	, [BlockName]
	, [BlockID]
	, [BuildSpace]
	, [AfforestingRate]
	, [TotalBuildingSpace]
	, [TotalFloorSpace]
	, [PlannedVolumeRate]
	, [BuildingDensity]
	, [BuildingSpaceForVolumeRate]
	, [BuildingSpaceNotVolumeRate]
	, [IsEstimate]
	, [Remark]
	, [Tj_date]
	, [SubjectSetCode]
	, [Status]
	, [ProjectId]
	, [ProjectAddress]
	, [ImagePath]
	, [UnitCode]
	, [jd]
	, [jdxz]
	, [JDBM]
	, [DevelopUnit]
	, [SalProjectCode]
	, [kgDate]
	, [jgDate]
	, [PlanStartDate]
	, [PlanEndDate]
	, [ProjectShortName]
	, [UnderBuildingSpace]
	, [UnderFloorSpace]
	, [AfforestingSpace]
	, [CenterAfforestingSpace]
	, [CenterAfforestingRate]
	, [ParkingSpace]
	, [UnderParkingSpace]
	, [HouseCount]
	, [HouseUse]
	, [PTFeeType]
	, [PTFeeVoucherID]
	, [HouseBuildingSpace]
	, [BsBuildingSpace]
	, [Manager]
	, [U8Code]
	, [DevelopUnitAddress]
	, [waterspace]
	, [peripheryspace]
	, [IsUseShortName]
    FROM
	dbo.[Project]
    WHERE 
	 ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([ProjectName] = @ProjectName AND @ProjectName is not null)
	OR ([City] = @City AND @City is not null)
	OR ([Area] = @Area AND @Area is not null)
	OR ([BlockName] = @BlockName AND @BlockName is not null)
	OR ([BlockID] = @BlockID AND @BlockID is not null)
	OR ([BuildSpace] = @BuildSpace AND @BuildSpace is not null)
	OR ([AfforestingRate] = @AfforestingRate AND @AfforestingRate is not null)
	OR ([TotalBuildingSpace] = @TotalBuildingSpace AND @TotalBuildingSpace is not null)
	OR ([TotalFloorSpace] = @TotalFloorSpace AND @TotalFloorSpace is not null)
	OR ([PlannedVolumeRate] = @PlannedVolumeRate AND @PlannedVolumeRate is not null)
	OR ([BuildingDensity] = @BuildingDensity AND @BuildingDensity is not null)
	OR ([BuildingSpaceForVolumeRate] = @BuildingSpaceForVolumeRate AND @BuildingSpaceForVolumeRate is not null)
	OR ([BuildingSpaceNotVolumeRate] = @BuildingSpaceNotVolumeRate AND @BuildingSpaceNotVolumeRate is not null)
	OR ([IsEstimate] = @IsEstimate AND @IsEstimate is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	OR ([Tj_date] = @Tj_date AND @Tj_date is not null)
	OR ([SubjectSetCode] = @SubjectSetCode AND @SubjectSetCode is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([ProjectId] = @ProjectId AND @ProjectId is not null)
	OR ([ProjectAddress] = @ProjectAddress AND @ProjectAddress is not null)
	OR ([ImagePath] = @ImagePath AND @ImagePath is not null)
	OR ([UnitCode] = @UnitCode AND @UnitCode is not null)
	OR ([jd] = @Jd AND @Jd is not null)
	OR ([jdxz] = @Jdxz AND @Jdxz is not null)
	OR ([JDBM] = @JDBM AND @JDBM is not null)
	OR ([DevelopUnit] = @DevelopUnit AND @DevelopUnit is not null)
	OR ([SalProjectCode] = @SalProjectCode AND @SalProjectCode is not null)
	OR ([kgDate] = @KgDate AND @KgDate is not null)
	OR ([jgDate] = @JgDate AND @JgDate is not null)
	OR ([PlanStartDate] = @PlanStartDate AND @PlanStartDate is not null)
	OR ([PlanEndDate] = @PlanEndDate AND @PlanEndDate is not null)
	OR ([ProjectShortName] = @ProjectShortName AND @ProjectShortName is not null)
	OR ([UnderBuildingSpace] = @UnderBuildingSpace AND @UnderBuildingSpace is not null)
	OR ([UnderFloorSpace] = @UnderFloorSpace AND @UnderFloorSpace is not null)
	OR ([AfforestingSpace] = @AfforestingSpace AND @AfforestingSpace is not null)
	OR ([CenterAfforestingSpace] = @CenterAfforestingSpace AND @CenterAfforestingSpace is not null)
	OR ([CenterAfforestingRate] = @CenterAfforestingRate AND @CenterAfforestingRate is not null)
	OR ([ParkingSpace] = @ParkingSpace AND @ParkingSpace is not null)
	OR ([UnderParkingSpace] = @UnderParkingSpace AND @UnderParkingSpace is not null)
	OR ([HouseCount] = @HouseCount AND @HouseCount is not null)
	OR ([HouseUse] = @HouseUse AND @HouseUse is not null)
	OR ([PTFeeType] = @PTFeeType AND @PTFeeType is not null)
	OR ([PTFeeVoucherID] = @PTFeeVoucherID AND @PTFeeVoucherID is not null)
	OR ([HouseBuildingSpace] = @HouseBuildingSpace AND @HouseBuildingSpace is not null)
	OR ([BsBuildingSpace] = @BsBuildingSpace AND @BsBuildingSpace is not null)
	OR ([Manager] = @Manager AND @Manager is not null)
	OR ([U8Code] = @U8Code AND @U8Code is not null)
	OR ([DevelopUnitAddress] = @DevelopUnitAddress AND @DevelopUnitAddress is not null)
	OR ([waterspace] = @Waterspace AND @Waterspace is not null)
	OR ([peripheryspace] = @Peripheryspace AND @Peripheryspace is not null)
	OR ([IsUseShortName] = @IsUseShortName AND @IsUseShortName is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="Project_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Project table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ProjectCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ProjectCode )
				SELECT TOP {3} [ProjectCode]
				FROM dbo.[Project] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ProjectCode], O.[ProjectName], O.[City], O.[Area], O.[BlockName], O.[BlockID], O.[BuildSpace], O.[AfforestingRate], O.[TotalBuildingSpace], O.[TotalFloorSpace], O.[PlannedVolumeRate], O.[BuildingDensity], O.[BuildingSpaceForVolumeRate], O.[BuildingSpaceNotVolumeRate], O.[IsEstimate], O.[Remark], O.[Tj_date], O.[SubjectSetCode], O.[Status], O.[ProjectId], O.[ProjectAddress], O.[ImagePath], O.[UnitCode], O.[jd], O.[jdxz], O.[JDBM], O.[DevelopUnit], O.[SalProjectCode], O.[kgDate], O.[jgDate], O.[PlanStartDate], O.[PlanEndDate], O.[ProjectShortName], O.[UnderBuildingSpace], O.[UnderFloorSpace], O.[AfforestingSpace], O.[CenterAfforestingSpace], O.[CenterAfforestingRate], O.[ParkingSpace], O.[UnderParkingSpace], O.[HouseCount], O.[HouseUse], O.[PTFeeType], O.[PTFeeVoucherID], O.[HouseBuildingSpace], O.[BsBuildingSpace], O.[Manager], O.[U8Code], O.[DevelopUnitAddress], O.[waterspace], O.[peripheryspace], O.[IsUseShortName]
				FROM
				    dbo.[Project] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ProjectCode] = PageIndex.[ProjectCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[Project] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Payout_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the Payout table
-- Table Comment: 付款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[PayoutCode],
					[PayoutID],
					[ProjectCode],
					[PaymentCodes],
					[PayoutDate],
					[PaymentType],
					[Payer],
					[SupplyCode],
					[BillNo],
					[InvoNo],
					[BankName],
					[BankAccount],
					[SubjectCode],
					[Money],
					[Status],
					[InputPerson],
					[InputDate],
					[CheckPerson],
					[CheckDate],
					[CheckOpinion],
					[SupplyName],
					[Remark],
					[ReceiptCount],
					[GroupCode],
					[IsApportioned],
					[Cash],
					[MoneyType],
					[ExchangeRate],
					[VoucherNo],
					[SubjectSetCode]
				FROM
					dbo.[Payout]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Payout_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Payout table passing page index and page count parameters
-- Table Comment: 付款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [PayoutCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (PayoutCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [PayoutCode]'
				SET @SQL = @SQL + ' FROM dbo.[Payout]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[PayoutCode], O.[PayoutID], O.[ProjectCode], O.[PaymentCodes], O.[PayoutDate], O.[PaymentType], O.[Payer], O.[SupplyCode], O.[BillNo], O.[InvoNo], O.[BankName], O.[BankAccount], O.[SubjectCode], O.[Money], O.[Status], O.[InputPerson], O.[InputDate], O.[CheckPerson], O.[CheckDate], O.[CheckOpinion], O.[SupplyName], O.[Remark], O.[ReceiptCount], O.[GroupCode], O.[IsApportioned], O.[Cash], O.[MoneyType], O.[ExchangeRate], O.[VoucherNo], O.[SubjectSetCode]
				FROM
				    dbo.[Payout] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[PayoutCode] = PageIndex.[PayoutCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Payout]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Payout_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the Payout table
-- Table Comment: 付款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayoutID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentCodes" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@PayoutDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PaymentType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Payer" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SupplyCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BillNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InvoNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BankName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@BankAccount" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SubjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@InputPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InputDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@SupplyName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@ReceiptCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@IsApportioned" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Cash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
				<parameter name="@VoucherNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SubjectSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Payout]
					(
					[PayoutCode]
					,[PayoutID]
					,[ProjectCode]
					,[PaymentCodes]
					,[PayoutDate]
					,[PaymentType]
					,[Payer]
					,[SupplyCode]
					,[BillNo]
					,[InvoNo]
					,[BankName]
					,[BankAccount]
					,[SubjectCode]
					,[Money]
					,[Status]
					,[InputPerson]
					,[InputDate]
					,[CheckPerson]
					,[CheckDate]
					,[CheckOpinion]
					,[SupplyName]
					,[Remark]
					,[ReceiptCount]
					,[GroupCode]
					,[IsApportioned]
					,[Cash]
					,[MoneyType]
					,[ExchangeRate]
					,[VoucherNo]
					,[SubjectSetCode]
					)
				VALUES
					(
					@PayoutCode
					,@PayoutID
					,@ProjectCode
					,@PaymentCodes
					,@PayoutDate
					,@PaymentType
					,@Payer
					,@SupplyCode
					,@BillNo
					,@InvoNo
					,@BankName
					,@BankAccount
					,@SubjectCode
					,@Money
					,@Status
					,@InputPerson
					,@InputDate
					,@CheckPerson
					,@CheckDate
					,@CheckOpinion
					,@SupplyName
					,@Remark
					,@ReceiptCount
					,@GroupCode
					,@IsApportioned
					,@Cash
					,@MoneyType
					,@ExchangeRate
					,@VoucherNo
					,@SubjectSetCode
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payout_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the Payout table
-- Table Comment: 付款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalPayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayoutID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentCodes" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@PayoutDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PaymentType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Payer" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SupplyCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BillNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InvoNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BankName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@BankAccount" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SubjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@InputPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@InputDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@SupplyName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@ReceiptCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@IsApportioned" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Cash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
				<parameter name="@VoucherNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SubjectSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Payout]
				SET
					[PayoutCode] = @PayoutCode
					,[PayoutID] = @PayoutID
					,[ProjectCode] = @ProjectCode
					,[PaymentCodes] = @PaymentCodes
					,[PayoutDate] = @PayoutDate
					,[PaymentType] = @PaymentType
					,[Payer] = @Payer
					,[SupplyCode] = @SupplyCode
					,[BillNo] = @BillNo
					,[InvoNo] = @InvoNo
					,[BankName] = @BankName
					,[BankAccount] = @BankAccount
					,[SubjectCode] = @SubjectCode
					,[Money] = @Money
					,[Status] = @Status
					,[InputPerson] = @InputPerson
					,[InputDate] = @InputDate
					,[CheckPerson] = @CheckPerson
					,[CheckDate] = @CheckDate
					,[CheckOpinion] = @CheckOpinion
					,[SupplyName] = @SupplyName
					,[Remark] = @Remark
					,[ReceiptCount] = @ReceiptCount
					,[GroupCode] = @GroupCode
					,[IsApportioned] = @IsApportioned
					,[Cash] = @Cash
					,[MoneyType] = @MoneyType
					,[ExchangeRate] = @ExchangeRate
					,[VoucherNo] = @VoucherNo
					,[SubjectSetCode] = @SubjectSetCode
				WHERE
[PayoutCode] = @OriginalPayoutCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payout_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the Payout table
-- Table Comment: 付款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Payout] WITH (ROWLOCK) 
				WHERE
					[PayoutCode] = @PayoutCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payout_GetByProjectCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Payout table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[PayoutCode],
					[PayoutID],
					[ProjectCode],
					[PaymentCodes],
					[PayoutDate],
					[PaymentType],
					[Payer],
					[SupplyCode],
					[BillNo],
					[InvoNo],
					[BankName],
					[BankAccount],
					[SubjectCode],
					[Money],
					[Status],
					[InputPerson],
					[InputDate],
					[CheckPerson],
					[CheckDate],
					[CheckOpinion],
					[SupplyName],
					[Remark],
					[ReceiptCount],
					[GroupCode],
					[IsApportioned],
					[Cash],
					[MoneyType],
					[ExchangeRate],
					[VoucherNo],
					[SubjectSetCode]
				FROM
					dbo.[Payout]
				WHERE
					[ProjectCode] = @ProjectCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payout_GetByPayoutCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Payout table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[PayoutCode],
					[PayoutID],
					[ProjectCode],
					[PaymentCodes],
					[PayoutDate],
					[PaymentType],
					[Payer],
					[SupplyCode],
					[BillNo],
					[InvoNo],
					[BankName],
					[BankAccount],
					[SubjectCode],
					[Money],
					[Status],
					[InputPerson],
					[InputDate],
					[CheckPerson],
					[CheckDate],
					[CheckOpinion],
					[SupplyName],
					[Remark],
					[ReceiptCount],
					[GroupCode],
					[IsApportioned],
					[Cash],
					[MoneyType],
					[ExchangeRate],
					[VoucherNo],
					[SubjectSetCode]
				FROM
					dbo.[Payout]
				WHERE
					[PayoutCode] = @PayoutCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Payout_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the Payout table passing nullable parameters
-- Table Comment: 付款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PayoutID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PaymentCodes" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault="null"/>
				<parameter name="@PayoutDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@PaymentType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Payer" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@SupplyCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BillNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@InvoNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BankName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
				<parameter name="@BankAccount" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@SubjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@InputPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@InputDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@SupplyName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@ReceiptCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@IsApportioned" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Cash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault="null"/>
				<parameter name="@VoucherNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@SubjectSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [PayoutCode]
	, [PayoutID]
	, [ProjectCode]
	, [PaymentCodes]
	, [PayoutDate]
	, [PaymentType]
	, [Payer]
	, [SupplyCode]
	, [BillNo]
	, [InvoNo]
	, [BankName]
	, [BankAccount]
	, [SubjectCode]
	, [Money]
	, [Status]
	, [InputPerson]
	, [InputDate]
	, [CheckPerson]
	, [CheckDate]
	, [CheckOpinion]
	, [SupplyName]
	, [Remark]
	, [ReceiptCount]
	, [GroupCode]
	, [IsApportioned]
	, [Cash]
	, [MoneyType]
	, [ExchangeRate]
	, [VoucherNo]
	, [SubjectSetCode]
    FROM
	dbo.[Payout]
    WHERE 
	 ([PayoutCode] = @PayoutCode OR @PayoutCode is null)
	AND ([PayoutID] = @PayoutID OR @PayoutID is null)
	AND ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([PaymentCodes] = @PaymentCodes OR @PaymentCodes is null)
	AND ([PayoutDate] = @PayoutDate OR @PayoutDate is null)
	AND ([PaymentType] = @PaymentType OR @PaymentType is null)
	AND ([Payer] = @Payer OR @Payer is null)
	AND ([SupplyCode] = @SupplyCode OR @SupplyCode is null)
	AND ([BillNo] = @BillNo OR @BillNo is null)
	AND ([InvoNo] = @InvoNo OR @InvoNo is null)
	AND ([BankName] = @BankName OR @BankName is null)
	AND ([BankAccount] = @BankAccount OR @BankAccount is null)
	AND ([SubjectCode] = @SubjectCode OR @SubjectCode is null)
	AND ([Money] = @Money OR @Money is null)
	AND ([Status] = @Status OR @Status is null)
	AND ([InputPerson] = @InputPerson OR @InputPerson is null)
	AND ([InputDate] = @InputDate OR @InputDate is null)
	AND ([CheckPerson] = @CheckPerson OR @CheckPerson is null)
	AND ([CheckDate] = @CheckDate OR @CheckDate is null)
	AND ([CheckOpinion] = @CheckOpinion OR @CheckOpinion is null)
	AND ([SupplyName] = @SupplyName OR @SupplyName is null)
	AND ([Remark] = @Remark OR @Remark is null)
	AND ([ReceiptCount] = @ReceiptCount OR @ReceiptCount is null)
	AND ([GroupCode] = @GroupCode OR @GroupCode is null)
	AND ([IsApportioned] = @IsApportioned OR @IsApportioned is null)
	AND ([Cash] = @Cash OR @Cash is null)
	AND ([MoneyType] = @MoneyType OR @MoneyType is null)
	AND ([ExchangeRate] = @ExchangeRate OR @ExchangeRate is null)
	AND ([VoucherNo] = @VoucherNo OR @VoucherNo is null)
	AND ([SubjectSetCode] = @SubjectSetCode OR @SubjectSetCode is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [PayoutCode]
	, [PayoutID]
	, [ProjectCode]
	, [PaymentCodes]
	, [PayoutDate]
	, [PaymentType]
	, [Payer]
	, [SupplyCode]
	, [BillNo]
	, [InvoNo]
	, [BankName]
	, [BankAccount]
	, [SubjectCode]
	, [Money]
	, [Status]
	, [InputPerson]
	, [InputDate]
	, [CheckPerson]
	, [CheckDate]
	, [CheckOpinion]
	, [SupplyName]
	, [Remark]
	, [ReceiptCount]
	, [GroupCode]
	, [IsApportioned]
	, [Cash]
	, [MoneyType]
	, [ExchangeRate]
	, [VoucherNo]
	, [SubjectSetCode]
    FROM
	dbo.[Payout]
    WHERE 
	 ([PayoutCode] = @PayoutCode AND @PayoutCode is not null)
	OR ([PayoutID] = @PayoutID AND @PayoutID is not null)
	OR ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([PaymentCodes] = @PaymentCodes AND @PaymentCodes is not null)
	OR ([PayoutDate] = @PayoutDate AND @PayoutDate is not null)
	OR ([PaymentType] = @PaymentType AND @PaymentType is not null)
	OR ([Payer] = @Payer AND @Payer is not null)
	OR ([SupplyCode] = @SupplyCode AND @SupplyCode is not null)
	OR ([BillNo] = @BillNo AND @BillNo is not null)
	OR ([InvoNo] = @InvoNo AND @InvoNo is not null)
	OR ([BankName] = @BankName AND @BankName is not null)
	OR ([BankAccount] = @BankAccount AND @BankAccount is not null)
	OR ([SubjectCode] = @SubjectCode AND @SubjectCode is not null)
	OR ([Money] = @Money AND @Money is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([InputPerson] = @InputPerson AND @InputPerson is not null)
	OR ([InputDate] = @InputDate AND @InputDate is not null)
	OR ([CheckPerson] = @CheckPerson AND @CheckPerson is not null)
	OR ([CheckDate] = @CheckDate AND @CheckDate is not null)
	OR ([CheckOpinion] = @CheckOpinion AND @CheckOpinion is not null)
	OR ([SupplyName] = @SupplyName AND @SupplyName is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	OR ([ReceiptCount] = @ReceiptCount AND @ReceiptCount is not null)
	OR ([GroupCode] = @GroupCode AND @GroupCode is not null)
	OR ([IsApportioned] = @IsApportioned AND @IsApportioned is not null)
	OR ([Cash] = @Cash AND @Cash is not null)
	OR ([MoneyType] = @MoneyType AND @MoneyType is not null)
	OR ([ExchangeRate] = @ExchangeRate AND @ExchangeRate is not null)
	OR ([VoucherNo] = @VoucherNo AND @VoucherNo is not null)
	OR ([SubjectSetCode] = @SubjectSetCode AND @SubjectSetCode is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="Payout_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Payout table using a dynamically generated query.
-- Table Comment: 付款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [PayoutCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( PayoutCode )
				SELECT TOP {3} [PayoutCode]
				FROM dbo.[Payout] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[PayoutCode], O.[PayoutID], O.[ProjectCode], O.[PaymentCodes], O.[PayoutDate], O.[PaymentType], O.[Payer], O.[SupplyCode], O.[BillNo], O.[InvoNo], O.[BankName], O.[BankAccount], O.[SubjectCode], O.[Money], O.[Status], O.[InputPerson], O.[InputDate], O.[CheckPerson], O.[CheckDate], O.[CheckOpinion], O.[SupplyName], O.[Remark], O.[ReceiptCount], O.[GroupCode], O.[IsApportioned], O.[Cash], O.[MoneyType], O.[ExchangeRate], O.[VoucherNo], O.[SubjectSetCode]
				FROM
				    dbo.[Payout] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[PayoutCode] = PageIndex.[PayoutCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[Payout] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Trouble_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the Trouble table
-- Table Comment: 现场实际施工情况/隐患描述
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[TroubleID],
					[InspectSituationID],
					[Requirement],
					[Suggestion],
					[ExecutionTime],
					[place],
					[TroubleCompendium],
					[Remark],
					[Status]
				FROM
					dbo.[Trouble]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Trouble_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Trouble table passing page index and page count parameters
-- Table Comment: 现场实际施工情况/隐患描述
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [TroubleID] int 
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (TroubleID)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [TroubleID]'
				SET @SQL = @SQL + ' FROM dbo.[Trouble]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[TroubleID], O.[InspectSituationID], O.[Requirement], O.[Suggestion], O.[ExecutionTime], O.[place], O.[TroubleCompendium], O.[Remark], O.[Status]
				FROM
				    dbo.[Trouble] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[TroubleID] = PageIndex.[TroubleID]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Trouble]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Trouble_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the Trouble table
-- Table Comment: 现场实际施工情况/隐患描述
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@TroubleID" type="int" direction="Output" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@InspectSituationID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Requirement" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault=""/>
				<parameter name="@Suggestion" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault=""/>
				<parameter name="@ExecutionTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Place" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@TroubleCompendium" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="4000" precision="0" scale="0" param="(4000)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Trouble]
					(
					[InspectSituationID]
					,[Requirement]
					,[Suggestion]
					,[ExecutionTime]
					,[place]
					,[TroubleCompendium]
					,[Remark]
					,[Status]
					)
				VALUES
					(
					@InspectSituationID
					,@Requirement
					,@Suggestion
					,@ExecutionTime
					,@Place
					,@TroubleCompendium
					,@Remark
					,@Status
					)
				
				-- Get the identity value
				SET @TroubleID = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Trouble_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the Trouble table
-- Table Comment: 现场实际施工情况/隐患描述
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@TroubleID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@InspectSituationID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Requirement" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault=""/>
				<parameter name="@Suggestion" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault=""/>
				<parameter name="@ExecutionTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Place" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@TroubleCompendium" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="4000" precision="0" scale="0" param="(4000)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Trouble]
				SET
					[InspectSituationID] = @InspectSituationID
					,[Requirement] = @Requirement
					,[Suggestion] = @Suggestion
					,[ExecutionTime] = @ExecutionTime
					,[place] = @Place
					,[TroubleCompendium] = @TroubleCompendium
					,[Remark] = @Remark
					,[Status] = @Status
				WHERE
[TroubleID] = @TroubleID 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Trouble_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the Trouble table
-- Table Comment: 现场实际施工情况/隐患描述
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@TroubleID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Trouble] WITH (ROWLOCK) 
				WHERE
					[TroubleID] = @TroubleID
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Trouble_GetByInspectSituationID" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Trouble table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@InspectSituationID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[TroubleID],
					[InspectSituationID],
					[Requirement],
					[Suggestion],
					[ExecutionTime],
					[place],
					[TroubleCompendium],
					[Remark],
					[Status]
				FROM
					dbo.[Trouble]
				WHERE
					[InspectSituationID] = @InspectSituationID
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Trouble_GetByTroubleID" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Trouble table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@TroubleID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[TroubleID],
					[InspectSituationID],
					[Requirement],
					[Suggestion],
					[ExecutionTime],
					[place],
					[TroubleCompendium],
					[Remark],
					[Status]
				FROM
					dbo.[Trouble]
				WHERE
					[TroubleID] = @TroubleID
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Trouble_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the Trouble table passing nullable parameters
-- Table Comment: 现场实际施工情况/隐患描述
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@TroubleID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@InspectSituationID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Requirement" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault="null"/>
				<parameter name="@Suggestion" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" nulldefault="null"/>
				<parameter name="@ExecutionTime" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Place" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@TroubleCompendium" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="4000" precision="0" scale="0" param="(4000)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [TroubleID]
	, [InspectSituationID]
	, [Requirement]
	, [Suggestion]
	, [ExecutionTime]
	, [place]
	, [TroubleCompendium]
	, [Remark]
	, [Status]
    FROM
	dbo.[Trouble]
    WHERE 
	 ([TroubleID] = @TroubleID OR @TroubleID is null)
	AND ([InspectSituationID] = @InspectSituationID OR @InspectSituationID is null)
	AND ([Requirement] = @Requirement OR @Requirement is null)
	AND ([Suggestion] = @Suggestion OR @Suggestion is null)
	AND ([ExecutionTime] = @ExecutionTime OR @ExecutionTime is null)
	AND ([place] = @Place OR @Place is null)
	AND ([TroubleCompendium] = @TroubleCompendium OR @TroubleCompendium is null)
	AND ([Remark] = @Remark OR @Remark is null)
	AND ([Status] = @Status OR @Status is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [TroubleID]
	, [InspectSituationID]
	, [Requirement]
	, [Suggestion]
	, [ExecutionTime]
	, [place]
	, [TroubleCompendium]
	, [Remark]
	, [Status]
    FROM
	dbo.[Trouble]
    WHERE 
	 ([TroubleID] = @TroubleID AND @TroubleID is not null)
	OR ([InspectSituationID] = @InspectSituationID AND @InspectSituationID is not null)
	OR ([Requirement] = @Requirement AND @Requirement is not null)
	OR ([Suggestion] = @Suggestion AND @Suggestion is not null)
	OR ([ExecutionTime] = @ExecutionTime AND @ExecutionTime is not null)
	OR ([place] = @Place AND @Place is not null)
	OR ([TroubleCompendium] = @TroubleCompendium AND @TroubleCompendium is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	OR ([Status] = @Status AND @Status is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="Trouble_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Trouble table using a dynamically generated query.
-- Table Comment: 现场实际施工情况/隐患描述
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [TroubleID] int 
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( TroubleID )
				SELECT TOP {3} [TroubleID]
				FROM dbo.[Trouble] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[TroubleID], O.[InspectSituationID], O.[Requirement], O.[Suggestion], O.[ExecutionTime], O.[place], O.[TroubleCompendium], O.[Remark], O.[Status]
				FROM
				    dbo.[Trouble] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[TroubleID] = PageIndex.[TroubleID]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[Trouble] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="MaterialPurchas_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the MaterialPurchas table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[MaterialPurchasID],
					[MaterialPurchasCode],
					[PurchasUnitCode],
					[PurchasDate],
					[ProjectCode],
					[Title],
					[Description],
					[FollowUserCode],
					[Status]
				FROM
					dbo.[MaterialPurchas]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="MaterialPurchas_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the MaterialPurchas table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MaterialPurchasID] int 
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (MaterialPurchasID)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MaterialPurchasID]'
				SET @SQL = @SQL + ' FROM dbo.[MaterialPurchas]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[MaterialPurchasID], O.[MaterialPurchasCode], O.[PurchasUnitCode], O.[PurchasDate], O.[ProjectCode], O.[Title], O.[Description], O.[FollowUserCode], O.[Status]
				FROM
				    dbo.[MaterialPurchas] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[MaterialPurchasID] = PageIndex.[MaterialPurchasID]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[MaterialPurchas]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="MaterialPurchas_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the MaterialPurchas table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasID" type="int" direction="Output" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@MaterialPurchasCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PurchasUnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PurchasDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Title" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="5000" precision="0" scale="0" param="(5000)" nulldefault=""/>
				<parameter name="@FollowUserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Status" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[MaterialPurchas]
					(
					[MaterialPurchasCode]
					,[PurchasUnitCode]
					,[PurchasDate]
					,[ProjectCode]
					,[Title]
					,[Description]
					,[FollowUserCode]
					,[Status]
					)
				VALUES
					(
					@MaterialPurchasCode
					,@PurchasUnitCode
					,@PurchasDate
					,@ProjectCode
					,@Title
					,@Description
					,@FollowUserCode
					,@Status
					)
				
				-- Get the identity value
				SET @MaterialPurchasID = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="MaterialPurchas_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the MaterialPurchas table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@MaterialPurchasCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PurchasUnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PurchasDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Title" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="5000" precision="0" scale="0" param="(5000)" nulldefault=""/>
				<parameter name="@FollowUserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Status" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[MaterialPurchas]
				SET
					[MaterialPurchasCode] = @MaterialPurchasCode
					,[PurchasUnitCode] = @PurchasUnitCode
					,[PurchasDate] = @PurchasDate
					,[ProjectCode] = @ProjectCode
					,[Title] = @Title
					,[Description] = @Description
					,[FollowUserCode] = @FollowUserCode
					,[Status] = @Status
				WHERE
[MaterialPurchasID] = @MaterialPurchasID 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="MaterialPurchas_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the MaterialPurchas table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[MaterialPurchas] WITH (ROWLOCK) 
				WHERE
					[MaterialPurchasID] = @MaterialPurchasID
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="MaterialPurchas_GetByProjectCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the MaterialPurchas table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[MaterialPurchasID],
					[MaterialPurchasCode],
					[PurchasUnitCode],
					[PurchasDate],
					[ProjectCode],
					[Title],
					[Description],
					[FollowUserCode],
					[Status]
				FROM
					dbo.[MaterialPurchas]
				WHERE
					[ProjectCode] = @ProjectCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="MaterialPurchas_GetByMaterialPurchasID" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the MaterialPurchas table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[MaterialPurchasID],
					[MaterialPurchasCode],
					[PurchasUnitCode],
					[PurchasDate],
					[ProjectCode],
					[Title],
					[Description],
					[FollowUserCode],
					[Status]
				FROM
					dbo.[MaterialPurchas]
				WHERE
					[MaterialPurchasID] = @MaterialPurchasID
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="MaterialPurchas_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the MaterialPurchas table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@MaterialPurchasID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@MaterialPurchasCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PurchasUnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PurchasDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Title" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Description" type="varchar" direction="Input" size="5000" precision="0" scale="0" param="(5000)" nulldefault="null"/>
				<parameter name="@FollowUserCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Status" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MaterialPurchasID]
	, [MaterialPurchasCode]
	, [PurchasUnitCode]
	, [PurchasDate]
	, [ProjectCode]
	, [Title]
	, [Description]
	, [FollowUserCode]
	, [Status]
    FROM
	dbo.[MaterialPurchas]
    WHERE 
	 ([MaterialPurchasID] = @MaterialPurchasID OR @MaterialPurchasID is null)
	AND ([MaterialPurchasCode] = @MaterialPurchasCode OR @MaterialPurchasCode is null)
	AND ([PurchasUnitCode] = @PurchasUnitCode OR @PurchasUnitCode is null)
	AND ([PurchasDate] = @PurchasDate OR @PurchasDate is null)
	AND ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([Title] = @Title OR @Title is null)
	AND ([Description] = @Description OR @Description is null)
	AND ([FollowUserCode] = @FollowUserCode OR @FollowUserCode is null)
	AND ([Status] = @Status OR @Status is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MaterialPurchasID]
	, [MaterialPurchasCode]
	, [PurchasUnitCode]
	, [PurchasDate]
	, [ProjectCode]
	, [Title]
	, [Description]
	, [FollowUserCode]
	, [Status]
    FROM
	dbo.[MaterialPurchas]
    WHERE 
	 ([MaterialPurchasID] = @MaterialPurchasID AND @MaterialPurchasID is not null)
	OR ([MaterialPurchasCode] = @MaterialPurchasCode AND @MaterialPurchasCode is not null)
	OR ([PurchasUnitCode] = @PurchasUnitCode AND @PurchasUnitCode is not null)
	OR ([PurchasDate] = @PurchasDate AND @PurchasDate is not null)
	OR ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([Title] = @Title AND @Title is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([FollowUserCode] = @FollowUserCode AND @FollowUserCode is not null)
	OR ([Status] = @Status AND @Status is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="MaterialPurchas_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the MaterialPurchas table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MaterialPurchasID] int 
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( MaterialPurchasID )
				SELECT TOP {3} [MaterialPurchasID]
				FROM dbo.[MaterialPurchas] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[MaterialPurchasID], O.[MaterialPurchasCode], O.[PurchasUnitCode], O.[PurchasDate], O.[ProjectCode], O.[Title], O.[Description], O.[FollowUserCode], O.[Status]
				FROM
				    dbo.[MaterialPurchas] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[MaterialPurchasID] = PageIndex.[MaterialPurchasID]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[MaterialPurchas] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="MaterialPurchasDtl_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the MaterialPurchasDtl table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[MaterialPurchasDtlID],
					[MaterialPurchasID],
					[TypeStandard],
					[Unit],
					[Number],
					[NeedDate],
					[SignDate],
					[SearchPriceDtl],
					[FinalPrice]
				FROM
					dbo.[MaterialPurchasDtl]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="MaterialPurchasDtl_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the MaterialPurchasDtl table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MaterialPurchasDtlID] int 
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (MaterialPurchasDtlID)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MaterialPurchasDtlID]'
				SET @SQL = @SQL + ' FROM dbo.[MaterialPurchasDtl]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[MaterialPurchasDtlID], O.[MaterialPurchasID], O.[TypeStandard], O.[Unit], O.[Number], O.[NeedDate], O.[SignDate], O.[SearchPriceDtl], O.[FinalPrice]
				FROM
				    dbo.[MaterialPurchasDtl] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[MaterialPurchasDtlID] = PageIndex.[MaterialPurchasDtlID]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[MaterialPurchasDtl]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="MaterialPurchasDtl_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the MaterialPurchasDtl table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasDtlID" type="int" direction="Output" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@MaterialPurchasID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@TypeStandard" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Unit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Number" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@NeedDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@SignDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@SearchPriceDtl" type="varchar" direction="Input" size="5000" precision="0" scale="0" param="(5000)" nulldefault=""/>
				<parameter name="@FinalPrice" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[MaterialPurchasDtl]
					(
					[MaterialPurchasID]
					,[TypeStandard]
					,[Unit]
					,[Number]
					,[NeedDate]
					,[SignDate]
					,[SearchPriceDtl]
					,[FinalPrice]
					)
				VALUES
					(
					@MaterialPurchasID
					,@TypeStandard
					,@Unit
					,@Number
					,@NeedDate
					,@SignDate
					,@SearchPriceDtl
					,@FinalPrice
					)
				
				-- Get the identity value
				SET @MaterialPurchasDtlID = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="MaterialPurchasDtl_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the MaterialPurchasDtl table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasDtlID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@MaterialPurchasID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@TypeStandard" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Unit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Number" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@NeedDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@SignDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@SearchPriceDtl" type="varchar" direction="Input" size="5000" precision="0" scale="0" param="(5000)" nulldefault=""/>
				<parameter name="@FinalPrice" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[MaterialPurchasDtl]
				SET
					[MaterialPurchasID] = @MaterialPurchasID
					,[TypeStandard] = @TypeStandard
					,[Unit] = @Unit
					,[Number] = @Number
					,[NeedDate] = @NeedDate
					,[SignDate] = @SignDate
					,[SearchPriceDtl] = @SearchPriceDtl
					,[FinalPrice] = @FinalPrice
				WHERE
[MaterialPurchasDtlID] = @MaterialPurchasDtlID 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="MaterialPurchasDtl_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the MaterialPurchasDtl table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasDtlID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[MaterialPurchasDtl] WITH (ROWLOCK) 
				WHERE
					[MaterialPurchasDtlID] = @MaterialPurchasDtlID
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="MaterialPurchasDtl_GetByMaterialPurchasID" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the MaterialPurchasDtl table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[MaterialPurchasDtlID],
					[MaterialPurchasID],
					[TypeStandard],
					[Unit],
					[Number],
					[NeedDate],
					[SignDate],
					[SearchPriceDtl],
					[FinalPrice]
				FROM
					dbo.[MaterialPurchasDtl]
				WHERE
					[MaterialPurchasID] = @MaterialPurchasID
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="MaterialPurchasDtl_GetByMaterialPurchasDtlID" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the MaterialPurchasDtl table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialPurchasDtlID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[MaterialPurchasDtlID],
					[MaterialPurchasID],
					[TypeStandard],
					[Unit],
					[Number],
					[NeedDate],
					[SignDate],
					[SearchPriceDtl],
					[FinalPrice]
				FROM
					dbo.[MaterialPurchasDtl]
				WHERE
					[MaterialPurchasDtlID] = @MaterialPurchasDtlID
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="MaterialPurchasDtl_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the MaterialPurchasDtl table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@MaterialPurchasDtlID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@MaterialPurchasID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@TypeStandard" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Unit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Number" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault="null"/>
				<parameter name="@NeedDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@SignDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@SearchPriceDtl" type="varchar" direction="Input" size="5000" precision="0" scale="0" param="(5000)" nulldefault="null"/>
				<parameter name="@FinalPrice" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MaterialPurchasDtlID]
	, [MaterialPurchasID]
	, [TypeStandard]
	, [Unit]
	, [Number]
	, [NeedDate]
	, [SignDate]
	, [SearchPriceDtl]
	, [FinalPrice]
    FROM
	dbo.[MaterialPurchasDtl]
    WHERE 
	 ([MaterialPurchasDtlID] = @MaterialPurchasDtlID OR @MaterialPurchasDtlID is null)
	AND ([MaterialPurchasID] = @MaterialPurchasID OR @MaterialPurchasID is null)
	AND ([TypeStandard] = @TypeStandard OR @TypeStandard is null)
	AND ([Unit] = @Unit OR @Unit is null)
	AND ([Number] = @Number OR @Number is null)
	AND ([NeedDate] = @NeedDate OR @NeedDate is null)
	AND ([SignDate] = @SignDate OR @SignDate is null)
	AND ([SearchPriceDtl] = @SearchPriceDtl OR @SearchPriceDtl is null)
	AND ([FinalPrice] = @FinalPrice OR @FinalPrice is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MaterialPurchasDtlID]
	, [MaterialPurchasID]
	, [TypeStandard]
	, [Unit]
	, [Number]
	, [NeedDate]
	, [SignDate]
	, [SearchPriceDtl]
	, [FinalPrice]
    FROM
	dbo.[MaterialPurchasDtl]
    WHERE 
	 ([MaterialPurchasDtlID] = @MaterialPurchasDtlID AND @MaterialPurchasDtlID is not null)
	OR ([MaterialPurchasID] = @MaterialPurchasID AND @MaterialPurchasID is not null)
	OR ([TypeStandard] = @TypeStandard AND @TypeStandard is not null)
	OR ([Unit] = @Unit AND @Unit is not null)
	OR ([Number] = @Number AND @Number is not null)
	OR ([NeedDate] = @NeedDate AND @NeedDate is not null)
	OR ([SignDate] = @SignDate AND @SignDate is not null)
	OR ([SearchPriceDtl] = @SearchPriceDtl AND @SearchPriceDtl is not null)
	OR ([FinalPrice] = @FinalPrice AND @FinalPrice is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="MaterialPurchasDtl_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the MaterialPurchasDtl table using a dynamically generated query.
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MaterialPurchasDtlID] int 
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( MaterialPurchasDtlID )
				SELECT TOP {3} [MaterialPurchasDtlID]
				FROM dbo.[MaterialPurchasDtl] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[MaterialPurchasDtlID], O.[MaterialPurchasID], O.[TypeStandard], O.[Unit], O.[Number], O.[NeedDate], O.[SignDate], O.[SearchPriceDtl], O.[FinalPrice]
				FROM
				    dbo.[MaterialPurchasDtl] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[MaterialPurchasDtlID] = PageIndex.[MaterialPurchasDtlID]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[MaterialPurchasDtl] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Contract_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the Contract table
-- Table Comment: 合同主表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractCode],
					[ContractID],
					[ProjectCode],
					[ContractName],
					[Type],
					[SupplierCode],
					[Supplier2Code],
					[ContractPerson],
					[ContractDate],
					[TotalMoney],
					[CreateDate],
					[CreatePerson],
					[LastModifyPerson],
					[LastModifyDate],
					[Remark],
					[Status],
					[CheckPerson],
					[CheckOpinion],
					[CheckDate],
					[ContractObject],
					[UnitCode],
					[ThirdParty],
					[BeforeAccountTotalMoney],
					[oldSumMoney],
					[OriginalMoney],
					[Mostly],
					[BiddingCode],
					[BudgetMoney],
					[AdjustMoney],
					[DevelopUnit],
					[CreateMode],
					[WorkTime],
					[MarkSegment],
					[GroupName],
					[Building],
					[PayMode],
					[QualityRequire],
					[ContractArea],
					[ContractDefaultValueCode],
					[BaoHan],
					[PerformingCircs],
					[AccountStatus],
					[AuditingStatus],
					[ChangeStatus],
					[ChangeCount],
					[WorkStartDate],
					[WorkEndDate],
					[PerCash0],
					[PerCash1],
					[PerCash2],
					[PerCash3],
					[PerCash4],
					[PerCash5],
					[PerCash6],
					[PerCash7],
					[PerCash8],
					[PerCash9],
					[StampDutyID],
					[StampDuty],
					[AdIssueDate],
					[MoneyType],
					[ExchangeRate]
				FROM
					dbo.[Contract]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Contract_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Contract table passing page index and page count parameters
-- Table Comment: 合同主表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractCode]'
				SET @SQL = @SQL + ' FROM dbo.[Contract]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractCode], O.[ContractID], O.[ProjectCode], O.[ContractName], O.[Type], O.[SupplierCode], O.[Supplier2Code], O.[ContractPerson], O.[ContractDate], O.[TotalMoney], O.[CreateDate], O.[CreatePerson], O.[LastModifyPerson], O.[LastModifyDate], O.[Remark], O.[Status], O.[CheckPerson], O.[CheckOpinion], O.[CheckDate], O.[ContractObject], O.[UnitCode], O.[ThirdParty], O.[BeforeAccountTotalMoney], O.[oldSumMoney], O.[OriginalMoney], O.[Mostly], O.[BiddingCode], O.[BudgetMoney], O.[AdjustMoney], O.[DevelopUnit], O.[CreateMode], O.[WorkTime], O.[MarkSegment], O.[GroupName], O.[Building], O.[PayMode], O.[QualityRequire], O.[ContractArea], O.[ContractDefaultValueCode], O.[BaoHan], O.[PerformingCircs], O.[AccountStatus], O.[AuditingStatus], O.[ChangeStatus], O.[ChangeCount], O.[WorkStartDate], O.[WorkEndDate], O.[PerCash0], O.[PerCash1], O.[PerCash2], O.[PerCash3], O.[PerCash4], O.[PerCash5], O.[PerCash6], O.[PerCash7], O.[PerCash8], O.[PerCash9], O.[StampDutyID], O.[StampDuty], O.[AdIssueDate], O.[MoneyType], O.[ExchangeRate]
				FROM
				    dbo.[Contract] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractCode] = PageIndex.[ContractCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Contract]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Contract_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the Contract table
-- Table Comment: 合同主表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Type" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SupplierCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Supplier2Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@TotalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CreateDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CreatePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@LastModifyPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@LastModifyDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ContractObject" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ThirdParty" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@BeforeAccountTotalMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OldSumMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Mostly" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BiddingCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BudgetMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AdjustMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@DevelopUnit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CreateMode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@WorkTime" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@MarkSegment" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@GroupName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Building" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayMode" type="text" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@QualityRequire" type="text" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ContractArea" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@ContractDefaultValueCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BaoHan" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerformingCircs" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@AccountStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@AuditingStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ChangeStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ChangeCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@WorkStartDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@WorkEndDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PerCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@StampDutyID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@StampDuty" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AdIssueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Contract]
					(
					[ContractCode]
					,[ContractID]
					,[ProjectCode]
					,[ContractName]
					,[Type]
					,[SupplierCode]
					,[Supplier2Code]
					,[ContractPerson]
					,[ContractDate]
					,[TotalMoney]
					,[CreateDate]
					,[CreatePerson]
					,[LastModifyPerson]
					,[LastModifyDate]
					,[Remark]
					,[Status]
					,[CheckPerson]
					,[CheckOpinion]
					,[CheckDate]
					,[ContractObject]
					,[UnitCode]
					,[ThirdParty]
					,[BeforeAccountTotalMoney]
					,[oldSumMoney]
					,[OriginalMoney]
					,[Mostly]
					,[BiddingCode]
					,[BudgetMoney]
					,[AdjustMoney]
					,[DevelopUnit]
					,[CreateMode]
					,[WorkTime]
					,[MarkSegment]
					,[GroupName]
					,[Building]
					,[PayMode]
					,[QualityRequire]
					,[ContractArea]
					,[ContractDefaultValueCode]
					,[BaoHan]
					,[PerformingCircs]
					,[AccountStatus]
					,[AuditingStatus]
					,[ChangeStatus]
					,[ChangeCount]
					,[WorkStartDate]
					,[WorkEndDate]
					,[PerCash0]
					,[PerCash1]
					,[PerCash2]
					,[PerCash3]
					,[PerCash4]
					,[PerCash5]
					,[PerCash6]
					,[PerCash7]
					,[PerCash8]
					,[PerCash9]
					,[StampDutyID]
					,[StampDuty]
					,[AdIssueDate]
					,[MoneyType]
					,[ExchangeRate]
					)
				VALUES
					(
					@ContractCode
					,@ContractID
					,@ProjectCode
					,@ContractName
					,@Type
					,@SupplierCode
					,@Supplier2Code
					,@ContractPerson
					,@ContractDate
					,@TotalMoney
					,@CreateDate
					,@CreatePerson
					,@LastModifyPerson
					,@LastModifyDate
					,@Remark
					,@Status
					,@CheckPerson
					,@CheckOpinion
					,@CheckDate
					,@ContractObject
					,@UnitCode
					,@ThirdParty
					,@BeforeAccountTotalMoney
					,@OldSumMoney
					,@OriginalMoney
					,@Mostly
					,@BiddingCode
					,@BudgetMoney
					,@AdjustMoney
					,@DevelopUnit
					,@CreateMode
					,@WorkTime
					,@MarkSegment
					,@GroupName
					,@Building
					,@PayMode
					,@QualityRequire
					,@ContractArea
					,@ContractDefaultValueCode
					,@BaoHan
					,@PerformingCircs
					,@AccountStatus
					,@AuditingStatus
					,@ChangeStatus
					,@ChangeCount
					,@WorkStartDate
					,@WorkEndDate
					,@PerCash0
					,@PerCash1
					,@PerCash2
					,@PerCash3
					,@PerCash4
					,@PerCash5
					,@PerCash6
					,@PerCash7
					,@PerCash8
					,@PerCash9
					,@StampDutyID
					,@StampDuty
					,@AdIssueDate
					,@MoneyType
					,@ExchangeRate
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Contract_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the Contract table
-- Table Comment: 合同主表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Type" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SupplierCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Supplier2Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@TotalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CreateDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CreatePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@LastModifyPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@LastModifyDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ContractObject" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ThirdParty" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@BeforeAccountTotalMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OldSumMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Mostly" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@BiddingCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BudgetMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AdjustMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@DevelopUnit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CreateMode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@WorkTime" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@MarkSegment" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@GroupName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Building" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayMode" type="text" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@QualityRequire" type="text" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ContractArea" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@ContractDefaultValueCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BaoHan" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerformingCircs" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@AccountStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@AuditingStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ChangeStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ChangeCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@WorkStartDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@WorkEndDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PerCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PerCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@StampDutyID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@StampDuty" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AdIssueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Contract]
				SET
					[ContractCode] = @ContractCode
					,[ContractID] = @ContractID
					,[ProjectCode] = @ProjectCode
					,[ContractName] = @ContractName
					,[Type] = @Type
					,[SupplierCode] = @SupplierCode
					,[Supplier2Code] = @Supplier2Code
					,[ContractPerson] = @ContractPerson
					,[ContractDate] = @ContractDate
					,[TotalMoney] = @TotalMoney
					,[CreateDate] = @CreateDate
					,[CreatePerson] = @CreatePerson
					,[LastModifyPerson] = @LastModifyPerson
					,[LastModifyDate] = @LastModifyDate
					,[Remark] = @Remark
					,[Status] = @Status
					,[CheckPerson] = @CheckPerson
					,[CheckOpinion] = @CheckOpinion
					,[CheckDate] = @CheckDate
					,[ContractObject] = @ContractObject
					,[UnitCode] = @UnitCode
					,[ThirdParty] = @ThirdParty
					,[BeforeAccountTotalMoney] = @BeforeAccountTotalMoney
					,[oldSumMoney] = @OldSumMoney
					,[OriginalMoney] = @OriginalMoney
					,[Mostly] = @Mostly
					,[BiddingCode] = @BiddingCode
					,[BudgetMoney] = @BudgetMoney
					,[AdjustMoney] = @AdjustMoney
					,[DevelopUnit] = @DevelopUnit
					,[CreateMode] = @CreateMode
					,[WorkTime] = @WorkTime
					,[MarkSegment] = @MarkSegment
					,[GroupName] = @GroupName
					,[Building] = @Building
					,[PayMode] = @PayMode
					,[QualityRequire] = @QualityRequire
					,[ContractArea] = @ContractArea
					,[ContractDefaultValueCode] = @ContractDefaultValueCode
					,[BaoHan] = @BaoHan
					,[PerformingCircs] = @PerformingCircs
					,[AccountStatus] = @AccountStatus
					,[AuditingStatus] = @AuditingStatus
					,[ChangeStatus] = @ChangeStatus
					,[ChangeCount] = @ChangeCount
					,[WorkStartDate] = @WorkStartDate
					,[WorkEndDate] = @WorkEndDate
					,[PerCash0] = @PerCash0
					,[PerCash1] = @PerCash1
					,[PerCash2] = @PerCash2
					,[PerCash3] = @PerCash3
					,[PerCash4] = @PerCash4
					,[PerCash5] = @PerCash5
					,[PerCash6] = @PerCash6
					,[PerCash7] = @PerCash7
					,[PerCash8] = @PerCash8
					,[PerCash9] = @PerCash9
					,[StampDutyID] = @StampDutyID
					,[StampDuty] = @StampDuty
					,[AdIssueDate] = @AdIssueDate
					,[MoneyType] = @MoneyType
					,[ExchangeRate] = @ExchangeRate
				WHERE
[ContractCode] = @OriginalContractCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Contract_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the Contract table
-- Table Comment: 合同主表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Contract] WITH (ROWLOCK) 
				WHERE
					[ContractCode] = @ContractCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Contract_GetByProjectCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Contract table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractCode],
					[ContractID],
					[ProjectCode],
					[ContractName],
					[Type],
					[SupplierCode],
					[Supplier2Code],
					[ContractPerson],
					[ContractDate],
					[TotalMoney],
					[CreateDate],
					[CreatePerson],
					[LastModifyPerson],
					[LastModifyDate],
					[Remark],
					[Status],
					[CheckPerson],
					[CheckOpinion],
					[CheckDate],
					[ContractObject],
					[UnitCode],
					[ThirdParty],
					[BeforeAccountTotalMoney],
					[oldSumMoney],
					[OriginalMoney],
					[Mostly],
					[BiddingCode],
					[BudgetMoney],
					[AdjustMoney],
					[DevelopUnit],
					[CreateMode],
					[WorkTime],
					[MarkSegment],
					[GroupName],
					[Building],
					[PayMode],
					[QualityRequire],
					[ContractArea],
					[ContractDefaultValueCode],
					[BaoHan],
					[PerformingCircs],
					[AccountStatus],
					[AuditingStatus],
					[ChangeStatus],
					[ChangeCount],
					[WorkStartDate],
					[WorkEndDate],
					[PerCash0],
					[PerCash1],
					[PerCash2],
					[PerCash3],
					[PerCash4],
					[PerCash5],
					[PerCash6],
					[PerCash7],
					[PerCash8],
					[PerCash9],
					[StampDutyID],
					[StampDuty],
					[AdIssueDate],
					[MoneyType],
					[ExchangeRate]
				FROM
					dbo.[Contract]
				WHERE
					[ProjectCode] = @ProjectCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Contract_GetByContractCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Contract table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractCode],
					[ContractID],
					[ProjectCode],
					[ContractName],
					[Type],
					[SupplierCode],
					[Supplier2Code],
					[ContractPerson],
					[ContractDate],
					[TotalMoney],
					[CreateDate],
					[CreatePerson],
					[LastModifyPerson],
					[LastModifyDate],
					[Remark],
					[Status],
					[CheckPerson],
					[CheckOpinion],
					[CheckDate],
					[ContractObject],
					[UnitCode],
					[ThirdParty],
					[BeforeAccountTotalMoney],
					[oldSumMoney],
					[OriginalMoney],
					[Mostly],
					[BiddingCode],
					[BudgetMoney],
					[AdjustMoney],
					[DevelopUnit],
					[CreateMode],
					[WorkTime],
					[MarkSegment],
					[GroupName],
					[Building],
					[PayMode],
					[QualityRequire],
					[ContractArea],
					[ContractDefaultValueCode],
					[BaoHan],
					[PerformingCircs],
					[AccountStatus],
					[AuditingStatus],
					[ChangeStatus],
					[ChangeCount],
					[WorkStartDate],
					[WorkEndDate],
					[PerCash0],
					[PerCash1],
					[PerCash2],
					[PerCash3],
					[PerCash4],
					[PerCash5],
					[PerCash6],
					[PerCash7],
					[PerCash8],
					[PerCash9],
					[StampDutyID],
					[StampDuty],
					[AdIssueDate],
					[MoneyType],
					[ExchangeRate]
				FROM
					dbo.[Contract]
				WHERE
					[ContractCode] = @ContractCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Contract_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the Contract table passing nullable parameters
-- Table Comment: 合同主表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@Type" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@SupplierCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Supplier2Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@TotalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@CreateDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@CreatePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@LastModifyPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@LastModifyDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ContractObject" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault="null"/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ThirdParty" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@BeforeAccountTotalMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@OldSumMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@Mostly" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@BiddingCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BudgetMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AdjustMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@DevelopUnit" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CreateMode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@WorkTime" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@MarkSegment" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@GroupName" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Building" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PayMode" type="text" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@QualityRequire" type="text" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractArea" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@ContractDefaultValueCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BaoHan" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerformingCircs" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault="null"/>
				<parameter name="@AccountStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@AuditingStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ChangeStatus" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ChangeCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@WorkStartDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@WorkEndDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@PerCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PerCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@StampDutyID" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@StampDuty" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AdIssueDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractCode]
	, [ContractID]
	, [ProjectCode]
	, [ContractName]
	, [Type]
	, [SupplierCode]
	, [Supplier2Code]
	, [ContractPerson]
	, [ContractDate]
	, [TotalMoney]
	, [CreateDate]
	, [CreatePerson]
	, [LastModifyPerson]
	, [LastModifyDate]
	, [Remark]
	, [Status]
	, [CheckPerson]
	, [CheckOpinion]
	, [CheckDate]
	, [ContractObject]
	, [UnitCode]
	, [ThirdParty]
	, [BeforeAccountTotalMoney]
	, [oldSumMoney]
	, [OriginalMoney]
	, [Mostly]
	, [BiddingCode]
	, [BudgetMoney]
	, [AdjustMoney]
	, [DevelopUnit]
	, [CreateMode]
	, [WorkTime]
	, [MarkSegment]
	, [GroupName]
	, [Building]
	, [PayMode]
	, [QualityRequire]
	, [ContractArea]
	, [ContractDefaultValueCode]
	, [BaoHan]
	, [PerformingCircs]
	, [AccountStatus]
	, [AuditingStatus]
	, [ChangeStatus]
	, [ChangeCount]
	, [WorkStartDate]
	, [WorkEndDate]
	, [PerCash0]
	, [PerCash1]
	, [PerCash2]
	, [PerCash3]
	, [PerCash4]
	, [PerCash5]
	, [PerCash6]
	, [PerCash7]
	, [PerCash8]
	, [PerCash9]
	, [StampDutyID]
	, [StampDuty]
	, [AdIssueDate]
	, [MoneyType]
	, [ExchangeRate]
    FROM
	dbo.[Contract]
    WHERE 
	 ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([ContractID] = @ContractID OR @ContractID is null)
	AND ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([ContractName] = @ContractName OR @ContractName is null)
	AND ([Type] = @Type OR @Type is null)
	AND ([SupplierCode] = @SupplierCode OR @SupplierCode is null)
	AND ([Supplier2Code] = @Supplier2Code OR @Supplier2Code is null)
	AND ([ContractPerson] = @ContractPerson OR @ContractPerson is null)
	AND ([ContractDate] = @ContractDate OR @ContractDate is null)
	AND ([TotalMoney] = @TotalMoney OR @TotalMoney is null)
	AND ([CreateDate] = @CreateDate OR @CreateDate is null)
	AND ([CreatePerson] = @CreatePerson OR @CreatePerson is null)
	AND ([LastModifyPerson] = @LastModifyPerson OR @LastModifyPerson is null)
	AND ([LastModifyDate] = @LastModifyDate OR @LastModifyDate is null)
	AND ([Remark] = @Remark OR @Remark is null)
	AND ([Status] = @Status OR @Status is null)
	AND ([CheckPerson] = @CheckPerson OR @CheckPerson is null)
	AND ([CheckOpinion] = @CheckOpinion OR @CheckOpinion is null)
	AND ([CheckDate] = @CheckDate OR @CheckDate is null)
	AND ([ContractObject] = @ContractObject OR @ContractObject is null)
	AND ([UnitCode] = @UnitCode OR @UnitCode is null)
	AND ([ThirdParty] = @ThirdParty OR @ThirdParty is null)
	AND ([BeforeAccountTotalMoney] = @BeforeAccountTotalMoney OR @BeforeAccountTotalMoney is null)
	AND ([oldSumMoney] = @OldSumMoney OR @OldSumMoney is null)
	AND ([OriginalMoney] = @OriginalMoney OR @OriginalMoney is null)
	AND ([Mostly] = @Mostly OR @Mostly is null)
	AND ([BiddingCode] = @BiddingCode OR @BiddingCode is null)
	AND ([BudgetMoney] = @BudgetMoney OR @BudgetMoney is null)
	AND ([AdjustMoney] = @AdjustMoney OR @AdjustMoney is null)
	AND ([DevelopUnit] = @DevelopUnit OR @DevelopUnit is null)
	AND ([CreateMode] = @CreateMode OR @CreateMode is null)
	AND ([WorkTime] = @WorkTime OR @WorkTime is null)
	AND ([MarkSegment] = @MarkSegment OR @MarkSegment is null)
	AND ([GroupName] = @GroupName OR @GroupName is null)
	AND ([Building] = @Building OR @Building is null)
	AND ([ContractArea] = @ContractArea OR @ContractArea is null)
	AND ([ContractDefaultValueCode] = @ContractDefaultValueCode OR @ContractDefaultValueCode is null)
	AND ([BaoHan] = @BaoHan OR @BaoHan is null)
	AND ([PerformingCircs] = @PerformingCircs OR @PerformingCircs is null)
	AND ([AccountStatus] = @AccountStatus OR @AccountStatus is null)
	AND ([AuditingStatus] = @AuditingStatus OR @AuditingStatus is null)
	AND ([ChangeStatus] = @ChangeStatus OR @ChangeStatus is null)
	AND ([ChangeCount] = @ChangeCount OR @ChangeCount is null)
	AND ([WorkStartDate] = @WorkStartDate OR @WorkStartDate is null)
	AND ([WorkEndDate] = @WorkEndDate OR @WorkEndDate is null)
	AND ([PerCash0] = @PerCash0 OR @PerCash0 is null)
	AND ([PerCash1] = @PerCash1 OR @PerCash1 is null)
	AND ([PerCash2] = @PerCash2 OR @PerCash2 is null)
	AND ([PerCash3] = @PerCash3 OR @PerCash3 is null)
	AND ([PerCash4] = @PerCash4 OR @PerCash4 is null)
	AND ([PerCash5] = @PerCash5 OR @PerCash5 is null)
	AND ([PerCash6] = @PerCash6 OR @PerCash6 is null)
	AND ([PerCash7] = @PerCash7 OR @PerCash7 is null)
	AND ([PerCash8] = @PerCash8 OR @PerCash8 is null)
	AND ([PerCash9] = @PerCash9 OR @PerCash9 is null)
	AND ([StampDutyID] = @StampDutyID OR @StampDutyID is null)
	AND ([StampDuty] = @StampDuty OR @StampDuty is null)
	AND ([AdIssueDate] = @AdIssueDate OR @AdIssueDate is null)
	AND ([MoneyType] = @MoneyType OR @MoneyType is null)
	AND ([ExchangeRate] = @ExchangeRate OR @ExchangeRate is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractCode]
	, [ContractID]
	, [ProjectCode]
	, [ContractName]
	, [Type]
	, [SupplierCode]
	, [Supplier2Code]
	, [ContractPerson]
	, [ContractDate]
	, [TotalMoney]
	, [CreateDate]
	, [CreatePerson]
	, [LastModifyPerson]
	, [LastModifyDate]
	, [Remark]
	, [Status]
	, [CheckPerson]
	, [CheckOpinion]
	, [CheckDate]
	, [ContractObject]
	, [UnitCode]
	, [ThirdParty]
	, [BeforeAccountTotalMoney]
	, [oldSumMoney]
	, [OriginalMoney]
	, [Mostly]
	, [BiddingCode]
	, [BudgetMoney]
	, [AdjustMoney]
	, [DevelopUnit]
	, [CreateMode]
	, [WorkTime]
	, [MarkSegment]
	, [GroupName]
	, [Building]
	, [PayMode]
	, [QualityRequire]
	, [ContractArea]
	, [ContractDefaultValueCode]
	, [BaoHan]
	, [PerformingCircs]
	, [AccountStatus]
	, [AuditingStatus]
	, [ChangeStatus]
	, [ChangeCount]
	, [WorkStartDate]
	, [WorkEndDate]
	, [PerCash0]
	, [PerCash1]
	, [PerCash2]
	, [PerCash3]
	, [PerCash4]
	, [PerCash5]
	, [PerCash6]
	, [PerCash7]
	, [PerCash8]
	, [PerCash9]
	, [StampDutyID]
	, [StampDuty]
	, [AdIssueDate]
	, [MoneyType]
	, [ExchangeRate]
    FROM
	dbo.[Contract]
    WHERE 
	 ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([ContractID] = @ContractID AND @ContractID is not null)
	OR ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([ContractName] = @ContractName AND @ContractName is not null)
	OR ([Type] = @Type AND @Type is not null)
	OR ([SupplierCode] = @SupplierCode AND @SupplierCode is not null)
	OR ([Supplier2Code] = @Supplier2Code AND @Supplier2Code is not null)
	OR ([ContractPerson] = @ContractPerson AND @ContractPerson is not null)
	OR ([ContractDate] = @ContractDate AND @ContractDate is not null)
	OR ([TotalMoney] = @TotalMoney AND @TotalMoney is not null)
	OR ([CreateDate] = @CreateDate AND @CreateDate is not null)
	OR ([CreatePerson] = @CreatePerson AND @CreatePerson is not null)
	OR ([LastModifyPerson] = @LastModifyPerson AND @LastModifyPerson is not null)
	OR ([LastModifyDate] = @LastModifyDate AND @LastModifyDate is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([CheckPerson] = @CheckPerson AND @CheckPerson is not null)
	OR ([CheckOpinion] = @CheckOpinion AND @CheckOpinion is not null)
	OR ([CheckDate] = @CheckDate AND @CheckDate is not null)
	OR ([ContractObject] = @ContractObject AND @ContractObject is not null)
	OR ([UnitCode] = @UnitCode AND @UnitCode is not null)
	OR ([ThirdParty] = @ThirdParty AND @ThirdParty is not null)
	OR ([BeforeAccountTotalMoney] = @BeforeAccountTotalMoney AND @BeforeAccountTotalMoney is not null)
	OR ([oldSumMoney] = @OldSumMoney AND @OldSumMoney is not null)
	OR ([OriginalMoney] = @OriginalMoney AND @OriginalMoney is not null)
	OR ([Mostly] = @Mostly AND @Mostly is not null)
	OR ([BiddingCode] = @BiddingCode AND @BiddingCode is not null)
	OR ([BudgetMoney] = @BudgetMoney AND @BudgetMoney is not null)
	OR ([AdjustMoney] = @AdjustMoney AND @AdjustMoney is not null)
	OR ([DevelopUnit] = @DevelopUnit AND @DevelopUnit is not null)
	OR ([CreateMode] = @CreateMode AND @CreateMode is not null)
	OR ([WorkTime] = @WorkTime AND @WorkTime is not null)
	OR ([MarkSegment] = @MarkSegment AND @MarkSegment is not null)
	OR ([GroupName] = @GroupName AND @GroupName is not null)
	OR ([Building] = @Building AND @Building is not null)
	OR ([ContractArea] = @ContractArea AND @ContractArea is not null)
	OR ([ContractDefaultValueCode] = @ContractDefaultValueCode AND @ContractDefaultValueCode is not null)
	OR ([BaoHan] = @BaoHan AND @BaoHan is not null)
	OR ([PerformingCircs] = @PerformingCircs AND @PerformingCircs is not null)
	OR ([AccountStatus] = @AccountStatus AND @AccountStatus is not null)
	OR ([AuditingStatus] = @AuditingStatus AND @AuditingStatus is not null)
	OR ([ChangeStatus] = @ChangeStatus AND @ChangeStatus is not null)
	OR ([ChangeCount] = @ChangeCount AND @ChangeCount is not null)
	OR ([WorkStartDate] = @WorkStartDate AND @WorkStartDate is not null)
	OR ([WorkEndDate] = @WorkEndDate AND @WorkEndDate is not null)
	OR ([PerCash0] = @PerCash0 AND @PerCash0 is not null)
	OR ([PerCash1] = @PerCash1 AND @PerCash1 is not null)
	OR ([PerCash2] = @PerCash2 AND @PerCash2 is not null)
	OR ([PerCash3] = @PerCash3 AND @PerCash3 is not null)
	OR ([PerCash4] = @PerCash4 AND @PerCash4 is not null)
	OR ([PerCash5] = @PerCash5 AND @PerCash5 is not null)
	OR ([PerCash6] = @PerCash6 AND @PerCash6 is not null)
	OR ([PerCash7] = @PerCash7 AND @PerCash7 is not null)
	OR ([PerCash8] = @PerCash8 AND @PerCash8 is not null)
	OR ([PerCash9] = @PerCash9 AND @PerCash9 is not null)
	OR ([StampDutyID] = @StampDutyID AND @StampDutyID is not null)
	OR ([StampDuty] = @StampDuty AND @StampDuty is not null)
	OR ([AdIssueDate] = @AdIssueDate AND @AdIssueDate is not null)
	OR ([MoneyType] = @MoneyType AND @MoneyType is not null)
	OR ([ExchangeRate] = @ExchangeRate AND @ExchangeRate is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="Contract_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Contract table using a dynamically generated query.
-- Table Comment: 合同主表
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractCode )
				SELECT TOP {3} [ContractCode]
				FROM dbo.[Contract] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractCode], O.[ContractID], O.[ProjectCode], O.[ContractName], O.[Type], O.[SupplierCode], O.[Supplier2Code], O.[ContractPerson], O.[ContractDate], O.[TotalMoney], O.[CreateDate], O.[CreatePerson], O.[LastModifyPerson], O.[LastModifyDate], O.[Remark], O.[Status], O.[CheckPerson], O.[CheckOpinion], O.[CheckDate], O.[ContractObject], O.[UnitCode], O.[ThirdParty], O.[BeforeAccountTotalMoney], O.[oldSumMoney], O.[OriginalMoney], O.[Mostly], O.[BiddingCode], O.[BudgetMoney], O.[AdjustMoney], O.[DevelopUnit], O.[CreateMode], O.[WorkTime], O.[MarkSegment], O.[GroupName], O.[Building], O.[PayMode], O.[QualityRequire], O.[ContractArea], O.[ContractDefaultValueCode], O.[BaoHan], O.[PerformingCircs], O.[AccountStatus], O.[AuditingStatus], O.[ChangeStatus], O.[ChangeCount], O.[WorkStartDate], O.[WorkEndDate], O.[PerCash0], O.[PerCash1], O.[PerCash2], O.[PerCash3], O.[PerCash4], O.[PerCash5], O.[PerCash6], O.[PerCash7], O.[PerCash8], O.[PerCash9], O.[StampDutyID], O.[StampDuty], O.[AdIssueDate], O.[MoneyType], O.[ExchangeRate]
				FROM
				    dbo.[Contract] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractCode] = PageIndex.[ContractCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[Contract] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractChange_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractChange table
-- Table Comment: 合同变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractChangeCode],
					[ContractChangeId],
					[ContractCode],
					[Voucher],
					[Money],
					[ChangeMoney],
					[NewMoney],
					[OriginalMoney],
					[TotalChangeMoney],
					[SupplierChangeMoney],
					[ConsultantAuditMoney],
					[ProjectAuditMoney],
					[ChangeReason],
					[Status],
					[ChangePerson],
					[ChangeDate],
					[ChangeType],
					[CheckPerson],
					[CheckDate]
				FROM
					dbo.[ContractChange]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractChange_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractChange table passing page index and page count parameters
-- Table Comment: 合同变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractChangeCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractChangeCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractChangeCode]'
				SET @SQL = @SQL + ' FROM dbo.[ContractChange]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractChangeCode], O.[ContractChangeId], O.[ContractCode], O.[Voucher], O.[Money], O.[ChangeMoney], O.[NewMoney], O.[OriginalMoney], O.[TotalChangeMoney], O.[SupplierChangeMoney], O.[ConsultantAuditMoney], O.[ProjectAuditMoney], O.[ChangeReason], O.[Status], O.[ChangePerson], O.[ChangeDate], O.[ChangeType], O.[CheckPerson], O.[CheckDate]
				FROM
				    dbo.[ContractChange] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractChangeCode] = PageIndex.[ContractChangeCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractChange]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractChange_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractChange table
-- Table Comment: 合同变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractChangeId" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Voucher" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@NewMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@SupplierChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ConsultantAuditMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ProjectAuditMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ChangeReason" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ChangePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ChangeDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ChangeType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractChange]
					(
					[ContractChangeCode]
					,[ContractChangeId]
					,[ContractCode]
					,[Voucher]
					,[Money]
					,[ChangeMoney]
					,[NewMoney]
					,[OriginalMoney]
					,[TotalChangeMoney]
					,[SupplierChangeMoney]
					,[ConsultantAuditMoney]
					,[ProjectAuditMoney]
					,[ChangeReason]
					,[Status]
					,[ChangePerson]
					,[ChangeDate]
					,[ChangeType]
					,[CheckPerson]
					,[CheckDate]
					)
				VALUES
					(
					@ContractChangeCode
					,@ContractChangeId
					,@ContractCode
					,@Voucher
					,@Money
					,@ChangeMoney
					,@NewMoney
					,@OriginalMoney
					,@TotalChangeMoney
					,@SupplierChangeMoney
					,@ConsultantAuditMoney
					,@ProjectAuditMoney
					,@ChangeReason
					,@Status
					,@ChangePerson
					,@ChangeDate
					,@ChangeType
					,@CheckPerson
					,@CheckDate
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractChange_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractChange table
-- Table Comment: 合同变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractChangeId" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Voucher" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@NewMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@SupplierChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ConsultantAuditMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ProjectAuditMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ChangeReason" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ChangePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ChangeDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ChangeType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractChange]
				SET
					[ContractChangeCode] = @ContractChangeCode
					,[ContractChangeId] = @ContractChangeId
					,[ContractCode] = @ContractCode
					,[Voucher] = @Voucher
					,[Money] = @Money
					,[ChangeMoney] = @ChangeMoney
					,[NewMoney] = @NewMoney
					,[OriginalMoney] = @OriginalMoney
					,[TotalChangeMoney] = @TotalChangeMoney
					,[SupplierChangeMoney] = @SupplierChangeMoney
					,[ConsultantAuditMoney] = @ConsultantAuditMoney
					,[ProjectAuditMoney] = @ProjectAuditMoney
					,[ChangeReason] = @ChangeReason
					,[Status] = @Status
					,[ChangePerson] = @ChangePerson
					,[ChangeDate] = @ChangeDate
					,[ChangeType] = @ChangeType
					,[CheckPerson] = @CheckPerson
					,[CheckDate] = @CheckDate
				WHERE
[ContractChangeCode] = @OriginalContractChangeCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractChange_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractChange table
-- Table Comment: 合同变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractChange] WITH (ROWLOCK) 
				WHERE
					[ContractChangeCode] = @ContractChangeCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractChange_GetByContractCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractChange table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractChangeCode],
					[ContractChangeId],
					[ContractCode],
					[Voucher],
					[Money],
					[ChangeMoney],
					[NewMoney],
					[OriginalMoney],
					[TotalChangeMoney],
					[SupplierChangeMoney],
					[ConsultantAuditMoney],
					[ProjectAuditMoney],
					[ChangeReason],
					[Status],
					[ChangePerson],
					[ChangeDate],
					[ChangeType],
					[CheckPerson],
					[CheckDate]
				FROM
					dbo.[ContractChange]
				WHERE
					[ContractCode] = @ContractCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractChange_GetByContractChangeCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractChange table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractChangeCode],
					[ContractChangeId],
					[ContractCode],
					[Voucher],
					[Money],
					[ChangeMoney],
					[NewMoney],
					[OriginalMoney],
					[TotalChangeMoney],
					[SupplierChangeMoney],
					[ConsultantAuditMoney],
					[ProjectAuditMoney],
					[ChangeReason],
					[Status],
					[ChangePerson],
					[ChangeDate],
					[ChangeType],
					[CheckPerson],
					[CheckDate]
				FROM
					dbo.[ContractChange]
				WHERE
					[ContractChangeCode] = @ContractChangeCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractChange_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractChange table passing nullable parameters
-- Table Comment: 合同变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractChangeId" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Voucher" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@NewMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@TotalChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@SupplierChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ConsultantAuditMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ProjectAuditMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ChangeReason" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ChangePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ChangeDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ChangeType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractChangeCode]
	, [ContractChangeId]
	, [ContractCode]
	, [Voucher]
	, [Money]
	, [ChangeMoney]
	, [NewMoney]
	, [OriginalMoney]
	, [TotalChangeMoney]
	, [SupplierChangeMoney]
	, [ConsultantAuditMoney]
	, [ProjectAuditMoney]
	, [ChangeReason]
	, [Status]
	, [ChangePerson]
	, [ChangeDate]
	, [ChangeType]
	, [CheckPerson]
	, [CheckDate]
    FROM
	dbo.[ContractChange]
    WHERE 
	 ([ContractChangeCode] = @ContractChangeCode OR @ContractChangeCode is null)
	AND ([ContractChangeId] = @ContractChangeId OR @ContractChangeId is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([Voucher] = @Voucher OR @Voucher is null)
	AND ([Money] = @Money OR @Money is null)
	AND ([ChangeMoney] = @ChangeMoney OR @ChangeMoney is null)
	AND ([NewMoney] = @NewMoney OR @NewMoney is null)
	AND ([OriginalMoney] = @OriginalMoney OR @OriginalMoney is null)
	AND ([TotalChangeMoney] = @TotalChangeMoney OR @TotalChangeMoney is null)
	AND ([SupplierChangeMoney] = @SupplierChangeMoney OR @SupplierChangeMoney is null)
	AND ([ConsultantAuditMoney] = @ConsultantAuditMoney OR @ConsultantAuditMoney is null)
	AND ([ProjectAuditMoney] = @ProjectAuditMoney OR @ProjectAuditMoney is null)
	AND ([ChangeReason] = @ChangeReason OR @ChangeReason is null)
	AND ([Status] = @Status OR @Status is null)
	AND ([ChangePerson] = @ChangePerson OR @ChangePerson is null)
	AND ([ChangeDate] = @ChangeDate OR @ChangeDate is null)
	AND ([ChangeType] = @ChangeType OR @ChangeType is null)
	AND ([CheckPerson] = @CheckPerson OR @CheckPerson is null)
	AND ([CheckDate] = @CheckDate OR @CheckDate is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractChangeCode]
	, [ContractChangeId]
	, [ContractCode]
	, [Voucher]
	, [Money]
	, [ChangeMoney]
	, [NewMoney]
	, [OriginalMoney]
	, [TotalChangeMoney]
	, [SupplierChangeMoney]
	, [ConsultantAuditMoney]
	, [ProjectAuditMoney]
	, [ChangeReason]
	, [Status]
	, [ChangePerson]
	, [ChangeDate]
	, [ChangeType]
	, [CheckPerson]
	, [CheckDate]
    FROM
	dbo.[ContractChange]
    WHERE 
	 ([ContractChangeCode] = @ContractChangeCode AND @ContractChangeCode is not null)
	OR ([ContractChangeId] = @ContractChangeId AND @ContractChangeId is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([Voucher] = @Voucher AND @Voucher is not null)
	OR ([Money] = @Money AND @Money is not null)
	OR ([ChangeMoney] = @ChangeMoney AND @ChangeMoney is not null)
	OR ([NewMoney] = @NewMoney AND @NewMoney is not null)
	OR ([OriginalMoney] = @OriginalMoney AND @OriginalMoney is not null)
	OR ([TotalChangeMoney] = @TotalChangeMoney AND @TotalChangeMoney is not null)
	OR ([SupplierChangeMoney] = @SupplierChangeMoney AND @SupplierChangeMoney is not null)
	OR ([ConsultantAuditMoney] = @ConsultantAuditMoney AND @ConsultantAuditMoney is not null)
	OR ([ProjectAuditMoney] = @ProjectAuditMoney AND @ProjectAuditMoney is not null)
	OR ([ChangeReason] = @ChangeReason AND @ChangeReason is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([ChangePerson] = @ChangePerson AND @ChangePerson is not null)
	OR ([ChangeDate] = @ChangeDate AND @ChangeDate is not null)
	OR ([ChangeType] = @ChangeType AND @ChangeType is not null)
	OR ([CheckPerson] = @CheckPerson AND @CheckPerson is not null)
	OR ([CheckDate] = @CheckDate AND @CheckDate is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractChange_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractChange table using a dynamically generated query.
-- Table Comment: 合同变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractChangeCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractChangeCode )
				SELECT TOP {3} [ContractChangeCode]
				FROM dbo.[ContractChange] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractChangeCode], O.[ContractChangeId], O.[ContractCode], O.[Voucher], O.[Money], O.[ChangeMoney], O.[NewMoney], O.[OriginalMoney], O.[TotalChangeMoney], O.[SupplierChangeMoney], O.[ConsultantAuditMoney], O.[ProjectAuditMoney], O.[ChangeReason], O.[Status], O.[ChangePerson], O.[ChangeDate], O.[ChangeType], O.[CheckPerson], O.[CheckDate]
				FROM
				    dbo.[ContractChange] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractChangeCode] = PageIndex.[ContractChangeCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractChange] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Payment_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the Payment table
-- Table Comment: 请款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[PaymentCode],
					[PaymentTitle],
					[PaymentID],
					[VoucherID],
					[RecieptCount],
					[ProjectCode],
					[ApplyPerson],
					[ApplyDate],
					[Accountant],
					[AccountDate],
					[Payer],
					[PayDate],
					[Purpose],
					[Money],
					[CheckPerson],
					[CheckDate],
					[CheckOpinion],
					[IsContract],
					[ContractCode],
					[Status],
					[WBSCode],
					[IsApportion],
					[SupplyCode],
					[UnitCode],
					[SupplyName],
					[Remark],
					[OldMoney],
					[GroupCode],
					[BankName],
					[BankAccount],
					[OtherAttachMent],
					[PayType],
					[Issue],
					[IssueMode],
					[FactPayDate],
					[TotalPayMoney],
					[AHMoney],
					[APMoney],
					[UPMoney],
					[SupplierApplyMoney],
					[MaxPayMoney],
					[PlanPayMoney],
					[ContractMoney],
					[AdjustedContractMoney],
					[PayoutMoney],
					[AHCash],
					[APCash],
					[UPCash],
					[PayoutCash],
					[AHCash0],
					[AHCash1],
					[AHCash2],
					[AHCash3],
					[AHCash4],
					[AHCash5],
					[AHCash6],
					[AHCash7],
					[AHCash8],
					[AHCash9],
					[PaymentName],
					[TotalViseChangeMoney],
					[SumCode],
					[PaymentCodition],
					[CheckRemark]
				FROM
					dbo.[Payment]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Payment_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Payment table passing page index and page count parameters
-- Table Comment: 请款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [PaymentCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (PaymentCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [PaymentCode]'
				SET @SQL = @SQL + ' FROM dbo.[Payment]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[PaymentCode], O.[PaymentTitle], O.[PaymentID], O.[VoucherID], O.[RecieptCount], O.[ProjectCode], O.[ApplyPerson], O.[ApplyDate], O.[Accountant], O.[AccountDate], O.[Payer], O.[PayDate], O.[Purpose], O.[Money], O.[CheckPerson], O.[CheckDate], O.[CheckOpinion], O.[IsContract], O.[ContractCode], O.[Status], O.[WBSCode], O.[IsApportion], O.[SupplyCode], O.[UnitCode], O.[SupplyName], O.[Remark], O.[OldMoney], O.[GroupCode], O.[BankName], O.[BankAccount], O.[OtherAttachMent], O.[PayType], O.[Issue], O.[IssueMode], O.[FactPayDate], O.[TotalPayMoney], O.[AHMoney], O.[APMoney], O.[UPMoney], O.[SupplierApplyMoney], O.[MaxPayMoney], O.[PlanPayMoney], O.[ContractMoney], O.[AdjustedContractMoney], O.[PayoutMoney], O.[AHCash], O.[APCash], O.[UPCash], O.[PayoutCash], O.[AHCash0], O.[AHCash1], O.[AHCash2], O.[AHCash3], O.[AHCash4], O.[AHCash5], O.[AHCash6], O.[AHCash7], O.[AHCash8], O.[AHCash9], O.[PaymentName], O.[TotalViseChangeMoney], O.[SumCode], O.[PaymentCodition], O.[CheckRemark]
				FROM
				    dbo.[Payment] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[PaymentCode] = PageIndex.[PaymentCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Payment]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Payment_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the Payment table
-- Table Comment: 请款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentTitle" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@VoucherID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@RecieptCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ApplyPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ApplyDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Accountant" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@AccountDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Payer" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Purpose" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@IsContract" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@WBSCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@IsApportion" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@SupplyCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SupplyName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@OldMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BankName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@BankAccount" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OtherAttachMent" type="varchar" direction="Input" size="1000" precision="0" scale="0" param="(1000)" nulldefault=""/>
				<parameter name="@PayType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Issue" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@IssueMode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@FactPayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@TotalPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@APMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@UPMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@SupplierApplyMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MaxPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PlanPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ContractMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AdjustedContractMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PayoutMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@APCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@UPCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PayoutCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PaymentName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@TotalViseChangeMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@SumCode" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@PaymentCodition" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@CheckRemark" type="varchar" direction="Input" size="1000" precision="0" scale="0" param="(1000)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Payment]
					(
					[PaymentCode]
					,[PaymentTitle]
					,[PaymentID]
					,[VoucherID]
					,[RecieptCount]
					,[ProjectCode]
					,[ApplyPerson]
					,[ApplyDate]
					,[Accountant]
					,[AccountDate]
					,[Payer]
					,[PayDate]
					,[Purpose]
					,[Money]
					,[CheckPerson]
					,[CheckDate]
					,[CheckOpinion]
					,[IsContract]
					,[ContractCode]
					,[Status]
					,[WBSCode]
					,[IsApportion]
					,[SupplyCode]
					,[UnitCode]
					,[SupplyName]
					,[Remark]
					,[OldMoney]
					,[GroupCode]
					,[BankName]
					,[BankAccount]
					,[OtherAttachMent]
					,[PayType]
					,[Issue]
					,[IssueMode]
					,[FactPayDate]
					,[TotalPayMoney]
					,[AHMoney]
					,[APMoney]
					,[UPMoney]
					,[SupplierApplyMoney]
					,[MaxPayMoney]
					,[PlanPayMoney]
					,[ContractMoney]
					,[AdjustedContractMoney]
					,[PayoutMoney]
					,[AHCash]
					,[APCash]
					,[UPCash]
					,[PayoutCash]
					,[AHCash0]
					,[AHCash1]
					,[AHCash2]
					,[AHCash3]
					,[AHCash4]
					,[AHCash5]
					,[AHCash6]
					,[AHCash7]
					,[AHCash8]
					,[AHCash9]
					,[PaymentName]
					,[TotalViseChangeMoney]
					,[SumCode]
					,[PaymentCodition]
					,[CheckRemark]
					)
				VALUES
					(
					@PaymentCode
					,@PaymentTitle
					,@PaymentID
					,@VoucherID
					,@RecieptCount
					,@ProjectCode
					,@ApplyPerson
					,@ApplyDate
					,@Accountant
					,@AccountDate
					,@Payer
					,@PayDate
					,@Purpose
					,@Money
					,@CheckPerson
					,@CheckDate
					,@CheckOpinion
					,@IsContract
					,@ContractCode
					,@Status
					,@WBSCode
					,@IsApportion
					,@SupplyCode
					,@UnitCode
					,@SupplyName
					,@Remark
					,@OldMoney
					,@GroupCode
					,@BankName
					,@BankAccount
					,@OtherAttachMent
					,@PayType
					,@Issue
					,@IssueMode
					,@FactPayDate
					,@TotalPayMoney
					,@AHMoney
					,@APMoney
					,@UPMoney
					,@SupplierApplyMoney
					,@MaxPayMoney
					,@PlanPayMoney
					,@ContractMoney
					,@AdjustedContractMoney
					,@PayoutMoney
					,@AHCash
					,@APCash
					,@UPCash
					,@PayoutCash
					,@AHCash0
					,@AHCash1
					,@AHCash2
					,@AHCash3
					,@AHCash4
					,@AHCash5
					,@AHCash6
					,@AHCash7
					,@AHCash8
					,@AHCash9
					,@PaymentName
					,@TotalViseChangeMoney
					,@SumCode
					,@PaymentCodition
					,@CheckRemark
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payment_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the Payment table
-- Table Comment: 请款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalPaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentTitle" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@VoucherID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@RecieptCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ApplyPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ApplyDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Accountant" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@AccountDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Payer" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Purpose" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@IsContract" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@WBSCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@IsApportion" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@SupplyCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@SupplyName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@OldMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BankName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@BankAccount" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OtherAttachMent" type="varchar" direction="Input" size="1000" precision="0" scale="0" param="(1000)" nulldefault=""/>
				<parameter name="@PayType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Issue" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@IssueMode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@FactPayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@TotalPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@APMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@UPMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@SupplierApplyMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MaxPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PlanPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ContractMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AdjustedContractMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PayoutMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@APCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@UPCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PayoutCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AHCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PaymentName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@TotalViseChangeMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@SumCode" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@PaymentCodition" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault=""/>
				<parameter name="@CheckRemark" type="varchar" direction="Input" size="1000" precision="0" scale="0" param="(1000)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Payment]
				SET
					[PaymentCode] = @PaymentCode
					,[PaymentTitle] = @PaymentTitle
					,[PaymentID] = @PaymentID
					,[VoucherID] = @VoucherID
					,[RecieptCount] = @RecieptCount
					,[ProjectCode] = @ProjectCode
					,[ApplyPerson] = @ApplyPerson
					,[ApplyDate] = @ApplyDate
					,[Accountant] = @Accountant
					,[AccountDate] = @AccountDate
					,[Payer] = @Payer
					,[PayDate] = @PayDate
					,[Purpose] = @Purpose
					,[Money] = @Money
					,[CheckPerson] = @CheckPerson
					,[CheckDate] = @CheckDate
					,[CheckOpinion] = @CheckOpinion
					,[IsContract] = @IsContract
					,[ContractCode] = @ContractCode
					,[Status] = @Status
					,[WBSCode] = @WBSCode
					,[IsApportion] = @IsApportion
					,[SupplyCode] = @SupplyCode
					,[UnitCode] = @UnitCode
					,[SupplyName] = @SupplyName
					,[Remark] = @Remark
					,[OldMoney] = @OldMoney
					,[GroupCode] = @GroupCode
					,[BankName] = @BankName
					,[BankAccount] = @BankAccount
					,[OtherAttachMent] = @OtherAttachMent
					,[PayType] = @PayType
					,[Issue] = @Issue
					,[IssueMode] = @IssueMode
					,[FactPayDate] = @FactPayDate
					,[TotalPayMoney] = @TotalPayMoney
					,[AHMoney] = @AHMoney
					,[APMoney] = @APMoney
					,[UPMoney] = @UPMoney
					,[SupplierApplyMoney] = @SupplierApplyMoney
					,[MaxPayMoney] = @MaxPayMoney
					,[PlanPayMoney] = @PlanPayMoney
					,[ContractMoney] = @ContractMoney
					,[AdjustedContractMoney] = @AdjustedContractMoney
					,[PayoutMoney] = @PayoutMoney
					,[AHCash] = @AHCash
					,[APCash] = @APCash
					,[UPCash] = @UPCash
					,[PayoutCash] = @PayoutCash
					,[AHCash0] = @AHCash0
					,[AHCash1] = @AHCash1
					,[AHCash2] = @AHCash2
					,[AHCash3] = @AHCash3
					,[AHCash4] = @AHCash4
					,[AHCash5] = @AHCash5
					,[AHCash6] = @AHCash6
					,[AHCash7] = @AHCash7
					,[AHCash8] = @AHCash8
					,[AHCash9] = @AHCash9
					,[PaymentName] = @PaymentName
					,[TotalViseChangeMoney] = @TotalViseChangeMoney
					,[SumCode] = @SumCode
					,[PaymentCodition] = @PaymentCodition
					,[CheckRemark] = @CheckRemark
				WHERE
[PaymentCode] = @OriginalPaymentCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payment_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the Payment table
-- Table Comment: 请款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Payment] WITH (ROWLOCK) 
				WHERE
					[PaymentCode] = @PaymentCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payment_GetByProjectCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Payment table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[PaymentCode],
					[PaymentTitle],
					[PaymentID],
					[VoucherID],
					[RecieptCount],
					[ProjectCode],
					[ApplyPerson],
					[ApplyDate],
					[Accountant],
					[AccountDate],
					[Payer],
					[PayDate],
					[Purpose],
					[Money],
					[CheckPerson],
					[CheckDate],
					[CheckOpinion],
					[IsContract],
					[ContractCode],
					[Status],
					[WBSCode],
					[IsApportion],
					[SupplyCode],
					[UnitCode],
					[SupplyName],
					[Remark],
					[OldMoney],
					[GroupCode],
					[BankName],
					[BankAccount],
					[OtherAttachMent],
					[PayType],
					[Issue],
					[IssueMode],
					[FactPayDate],
					[TotalPayMoney],
					[AHMoney],
					[APMoney],
					[UPMoney],
					[SupplierApplyMoney],
					[MaxPayMoney],
					[PlanPayMoney],
					[ContractMoney],
					[AdjustedContractMoney],
					[PayoutMoney],
					[AHCash],
					[APCash],
					[UPCash],
					[PayoutCash],
					[AHCash0],
					[AHCash1],
					[AHCash2],
					[AHCash3],
					[AHCash4],
					[AHCash5],
					[AHCash6],
					[AHCash7],
					[AHCash8],
					[AHCash9],
					[PaymentName],
					[TotalViseChangeMoney],
					[SumCode],
					[PaymentCodition],
					[CheckRemark]
				FROM
					dbo.[Payment]
				WHERE
					[ProjectCode] = @ProjectCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payment_GetByContractCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Payment table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[PaymentCode],
					[PaymentTitle],
					[PaymentID],
					[VoucherID],
					[RecieptCount],
					[ProjectCode],
					[ApplyPerson],
					[ApplyDate],
					[Accountant],
					[AccountDate],
					[Payer],
					[PayDate],
					[Purpose],
					[Money],
					[CheckPerson],
					[CheckDate],
					[CheckOpinion],
					[IsContract],
					[ContractCode],
					[Status],
					[WBSCode],
					[IsApportion],
					[SupplyCode],
					[UnitCode],
					[SupplyName],
					[Remark],
					[OldMoney],
					[GroupCode],
					[BankName],
					[BankAccount],
					[OtherAttachMent],
					[PayType],
					[Issue],
					[IssueMode],
					[FactPayDate],
					[TotalPayMoney],
					[AHMoney],
					[APMoney],
					[UPMoney],
					[SupplierApplyMoney],
					[MaxPayMoney],
					[PlanPayMoney],
					[ContractMoney],
					[AdjustedContractMoney],
					[PayoutMoney],
					[AHCash],
					[APCash],
					[UPCash],
					[PayoutCash],
					[AHCash0],
					[AHCash1],
					[AHCash2],
					[AHCash3],
					[AHCash4],
					[AHCash5],
					[AHCash6],
					[AHCash7],
					[AHCash8],
					[AHCash9],
					[PaymentName],
					[TotalViseChangeMoney],
					[SumCode],
					[PaymentCodition],
					[CheckRemark]
				FROM
					dbo.[Payment]
				WHERE
					[ContractCode] = @ContractCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Payment_GetByPaymentCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the Payment table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[PaymentCode],
					[PaymentTitle],
					[PaymentID],
					[VoucherID],
					[RecieptCount],
					[ProjectCode],
					[ApplyPerson],
					[ApplyDate],
					[Accountant],
					[AccountDate],
					[Payer],
					[PayDate],
					[Purpose],
					[Money],
					[CheckPerson],
					[CheckDate],
					[CheckOpinion],
					[IsContract],
					[ContractCode],
					[Status],
					[WBSCode],
					[IsApportion],
					[SupplyCode],
					[UnitCode],
					[SupplyName],
					[Remark],
					[OldMoney],
					[GroupCode],
					[BankName],
					[BankAccount],
					[OtherAttachMent],
					[PayType],
					[Issue],
					[IssueMode],
					[FactPayDate],
					[TotalPayMoney],
					[AHMoney],
					[APMoney],
					[UPMoney],
					[SupplierApplyMoney],
					[MaxPayMoney],
					[PlanPayMoney],
					[ContractMoney],
					[AdjustedContractMoney],
					[PayoutMoney],
					[AHCash],
					[APCash],
					[UPCash],
					[PayoutCash],
					[AHCash0],
					[AHCash1],
					[AHCash2],
					[AHCash3],
					[AHCash4],
					[AHCash5],
					[AHCash6],
					[AHCash7],
					[AHCash8],
					[AHCash9],
					[PaymentName],
					[TotalViseChangeMoney],
					[SumCode],
					[PaymentCodition],
					[CheckRemark]
				FROM
					dbo.[Payment]
				WHERE
					[PaymentCode] = @PaymentCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Payment_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the Payment table passing nullable parameters
-- Table Comment: 请款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PaymentTitle" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PaymentID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@VoucherID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@RecieptCount" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ApplyPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ApplyDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Accountant" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@AccountDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Payer" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Purpose" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@CheckPerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CheckDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@CheckOpinion" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@IsContract" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@WBSCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@IsApportion" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@SupplyCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@UnitCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@SupplyName" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@OldMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@GroupCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BankName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
				<parameter name="@BankAccount" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@OtherAttachMent" type="varchar" direction="Input" size="1000" precision="0" scale="0" param="(1000)" nulldefault="null"/>
				<parameter name="@PayType" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Issue" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@IssueMode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@FactPayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@TotalPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@APMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@UPMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@SupplierApplyMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@MaxPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PlanPayMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ContractMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AdjustedContractMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PayoutMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@APCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@UPCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PayoutCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AHCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PaymentName" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
				<parameter name="@TotalViseChangeMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@SumCode" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
				<parameter name="@PaymentCodition" type="varchar" direction="Input" size="100" precision="0" scale="0" param="(100)" nulldefault="null"/>
				<parameter name="@CheckRemark" type="varchar" direction="Input" size="1000" precision="0" scale="0" param="(1000)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [PaymentCode]
	, [PaymentTitle]
	, [PaymentID]
	, [VoucherID]
	, [RecieptCount]
	, [ProjectCode]
	, [ApplyPerson]
	, [ApplyDate]
	, [Accountant]
	, [AccountDate]
	, [Payer]
	, [PayDate]
	, [Purpose]
	, [Money]
	, [CheckPerson]
	, [CheckDate]
	, [CheckOpinion]
	, [IsContract]
	, [ContractCode]
	, [Status]
	, [WBSCode]
	, [IsApportion]
	, [SupplyCode]
	, [UnitCode]
	, [SupplyName]
	, [Remark]
	, [OldMoney]
	, [GroupCode]
	, [BankName]
	, [BankAccount]
	, [OtherAttachMent]
	, [PayType]
	, [Issue]
	, [IssueMode]
	, [FactPayDate]
	, [TotalPayMoney]
	, [AHMoney]
	, [APMoney]
	, [UPMoney]
	, [SupplierApplyMoney]
	, [MaxPayMoney]
	, [PlanPayMoney]
	, [ContractMoney]
	, [AdjustedContractMoney]
	, [PayoutMoney]
	, [AHCash]
	, [APCash]
	, [UPCash]
	, [PayoutCash]
	, [AHCash0]
	, [AHCash1]
	, [AHCash2]
	, [AHCash3]
	, [AHCash4]
	, [AHCash5]
	, [AHCash6]
	, [AHCash7]
	, [AHCash8]
	, [AHCash9]
	, [PaymentName]
	, [TotalViseChangeMoney]
	, [SumCode]
	, [PaymentCodition]
	, [CheckRemark]
    FROM
	dbo.[Payment]
    WHERE 
	 ([PaymentCode] = @PaymentCode OR @PaymentCode is null)
	AND ([PaymentTitle] = @PaymentTitle OR @PaymentTitle is null)
	AND ([PaymentID] = @PaymentID OR @PaymentID is null)
	AND ([VoucherID] = @VoucherID OR @VoucherID is null)
	AND ([RecieptCount] = @RecieptCount OR @RecieptCount is null)
	AND ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([ApplyPerson] = @ApplyPerson OR @ApplyPerson is null)
	AND ([ApplyDate] = @ApplyDate OR @ApplyDate is null)
	AND ([Accountant] = @Accountant OR @Accountant is null)
	AND ([AccountDate] = @AccountDate OR @AccountDate is null)
	AND ([Payer] = @Payer OR @Payer is null)
	AND ([PayDate] = @PayDate OR @PayDate is null)
	AND ([Purpose] = @Purpose OR @Purpose is null)
	AND ([Money] = @Money OR @Money is null)
	AND ([CheckPerson] = @CheckPerson OR @CheckPerson is null)
	AND ([CheckDate] = @CheckDate OR @CheckDate is null)
	AND ([CheckOpinion] = @CheckOpinion OR @CheckOpinion is null)
	AND ([IsContract] = @IsContract OR @IsContract is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([Status] = @Status OR @Status is null)
	AND ([WBSCode] = @WBSCode OR @WBSCode is null)
	AND ([IsApportion] = @IsApportion OR @IsApportion is null)
	AND ([SupplyCode] = @SupplyCode OR @SupplyCode is null)
	AND ([UnitCode] = @UnitCode OR @UnitCode is null)
	AND ([SupplyName] = @SupplyName OR @SupplyName is null)
	AND ([Remark] = @Remark OR @Remark is null)
	AND ([OldMoney] = @OldMoney OR @OldMoney is null)
	AND ([GroupCode] = @GroupCode OR @GroupCode is null)
	AND ([BankName] = @BankName OR @BankName is null)
	AND ([BankAccount] = @BankAccount OR @BankAccount is null)
	AND ([OtherAttachMent] = @OtherAttachMent OR @OtherAttachMent is null)
	AND ([PayType] = @PayType OR @PayType is null)
	AND ([Issue] = @Issue OR @Issue is null)
	AND ([IssueMode] = @IssueMode OR @IssueMode is null)
	AND ([FactPayDate] = @FactPayDate OR @FactPayDate is null)
	AND ([TotalPayMoney] = @TotalPayMoney OR @TotalPayMoney is null)
	AND ([AHMoney] = @AHMoney OR @AHMoney is null)
	AND ([APMoney] = @APMoney OR @APMoney is null)
	AND ([UPMoney] = @UPMoney OR @UPMoney is null)
	AND ([SupplierApplyMoney] = @SupplierApplyMoney OR @SupplierApplyMoney is null)
	AND ([MaxPayMoney] = @MaxPayMoney OR @MaxPayMoney is null)
	AND ([PlanPayMoney] = @PlanPayMoney OR @PlanPayMoney is null)
	AND ([ContractMoney] = @ContractMoney OR @ContractMoney is null)
	AND ([AdjustedContractMoney] = @AdjustedContractMoney OR @AdjustedContractMoney is null)
	AND ([PayoutMoney] = @PayoutMoney OR @PayoutMoney is null)
	AND ([AHCash] = @AHCash OR @AHCash is null)
	AND ([APCash] = @APCash OR @APCash is null)
	AND ([UPCash] = @UPCash OR @UPCash is null)
	AND ([PayoutCash] = @PayoutCash OR @PayoutCash is null)
	AND ([AHCash0] = @AHCash0 OR @AHCash0 is null)
	AND ([AHCash1] = @AHCash1 OR @AHCash1 is null)
	AND ([AHCash2] = @AHCash2 OR @AHCash2 is null)
	AND ([AHCash3] = @AHCash3 OR @AHCash3 is null)
	AND ([AHCash4] = @AHCash4 OR @AHCash4 is null)
	AND ([AHCash5] = @AHCash5 OR @AHCash5 is null)
	AND ([AHCash6] = @AHCash6 OR @AHCash6 is null)
	AND ([AHCash7] = @AHCash7 OR @AHCash7 is null)
	AND ([AHCash8] = @AHCash8 OR @AHCash8 is null)
	AND ([AHCash9] = @AHCash9 OR @AHCash9 is null)
	AND ([PaymentName] = @PaymentName OR @PaymentName is null)
	AND ([TotalViseChangeMoney] = @TotalViseChangeMoney OR @TotalViseChangeMoney is null)
	AND ([SumCode] = @SumCode OR @SumCode is null)
	AND ([PaymentCodition] = @PaymentCodition OR @PaymentCodition is null)
	AND ([CheckRemark] = @CheckRemark OR @CheckRemark is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [PaymentCode]
	, [PaymentTitle]
	, [PaymentID]
	, [VoucherID]
	, [RecieptCount]
	, [ProjectCode]
	, [ApplyPerson]
	, [ApplyDate]
	, [Accountant]
	, [AccountDate]
	, [Payer]
	, [PayDate]
	, [Purpose]
	, [Money]
	, [CheckPerson]
	, [CheckDate]
	, [CheckOpinion]
	, [IsContract]
	, [ContractCode]
	, [Status]
	, [WBSCode]
	, [IsApportion]
	, [SupplyCode]
	, [UnitCode]
	, [SupplyName]
	, [Remark]
	, [OldMoney]
	, [GroupCode]
	, [BankName]
	, [BankAccount]
	, [OtherAttachMent]
	, [PayType]
	, [Issue]
	, [IssueMode]
	, [FactPayDate]
	, [TotalPayMoney]
	, [AHMoney]
	, [APMoney]
	, [UPMoney]
	, [SupplierApplyMoney]
	, [MaxPayMoney]
	, [PlanPayMoney]
	, [ContractMoney]
	, [AdjustedContractMoney]
	, [PayoutMoney]
	, [AHCash]
	, [APCash]
	, [UPCash]
	, [PayoutCash]
	, [AHCash0]
	, [AHCash1]
	, [AHCash2]
	, [AHCash3]
	, [AHCash4]
	, [AHCash5]
	, [AHCash6]
	, [AHCash7]
	, [AHCash8]
	, [AHCash9]
	, [PaymentName]
	, [TotalViseChangeMoney]
	, [SumCode]
	, [PaymentCodition]
	, [CheckRemark]
    FROM
	dbo.[Payment]
    WHERE 
	 ([PaymentCode] = @PaymentCode AND @PaymentCode is not null)
	OR ([PaymentTitle] = @PaymentTitle AND @PaymentTitle is not null)
	OR ([PaymentID] = @PaymentID AND @PaymentID is not null)
	OR ([VoucherID] = @VoucherID AND @VoucherID is not null)
	OR ([RecieptCount] = @RecieptCount AND @RecieptCount is not null)
	OR ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([ApplyPerson] = @ApplyPerson AND @ApplyPerson is not null)
	OR ([ApplyDate] = @ApplyDate AND @ApplyDate is not null)
	OR ([Accountant] = @Accountant AND @Accountant is not null)
	OR ([AccountDate] = @AccountDate AND @AccountDate is not null)
	OR ([Payer] = @Payer AND @Payer is not null)
	OR ([PayDate] = @PayDate AND @PayDate is not null)
	OR ([Purpose] = @Purpose AND @Purpose is not null)
	OR ([Money] = @Money AND @Money is not null)
	OR ([CheckPerson] = @CheckPerson AND @CheckPerson is not null)
	OR ([CheckDate] = @CheckDate AND @CheckDate is not null)
	OR ([CheckOpinion] = @CheckOpinion AND @CheckOpinion is not null)
	OR ([IsContract] = @IsContract AND @IsContract is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([WBSCode] = @WBSCode AND @WBSCode is not null)
	OR ([IsApportion] = @IsApportion AND @IsApportion is not null)
	OR ([SupplyCode] = @SupplyCode AND @SupplyCode is not null)
	OR ([UnitCode] = @UnitCode AND @UnitCode is not null)
	OR ([SupplyName] = @SupplyName AND @SupplyName is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	OR ([OldMoney] = @OldMoney AND @OldMoney is not null)
	OR ([GroupCode] = @GroupCode AND @GroupCode is not null)
	OR ([BankName] = @BankName AND @BankName is not null)
	OR ([BankAccount] = @BankAccount AND @BankAccount is not null)
	OR ([OtherAttachMent] = @OtherAttachMent AND @OtherAttachMent is not null)
	OR ([PayType] = @PayType AND @PayType is not null)
	OR ([Issue] = @Issue AND @Issue is not null)
	OR ([IssueMode] = @IssueMode AND @IssueMode is not null)
	OR ([FactPayDate] = @FactPayDate AND @FactPayDate is not null)
	OR ([TotalPayMoney] = @TotalPayMoney AND @TotalPayMoney is not null)
	OR ([AHMoney] = @AHMoney AND @AHMoney is not null)
	OR ([APMoney] = @APMoney AND @APMoney is not null)
	OR ([UPMoney] = @UPMoney AND @UPMoney is not null)
	OR ([SupplierApplyMoney] = @SupplierApplyMoney AND @SupplierApplyMoney is not null)
	OR ([MaxPayMoney] = @MaxPayMoney AND @MaxPayMoney is not null)
	OR ([PlanPayMoney] = @PlanPayMoney AND @PlanPayMoney is not null)
	OR ([ContractMoney] = @ContractMoney AND @ContractMoney is not null)
	OR ([AdjustedContractMoney] = @AdjustedContractMoney AND @AdjustedContractMoney is not null)
	OR ([PayoutMoney] = @PayoutMoney AND @PayoutMoney is not null)
	OR ([AHCash] = @AHCash AND @AHCash is not null)
	OR ([APCash] = @APCash AND @APCash is not null)
	OR ([UPCash] = @UPCash AND @UPCash is not null)
	OR ([PayoutCash] = @PayoutCash AND @PayoutCash is not null)
	OR ([AHCash0] = @AHCash0 AND @AHCash0 is not null)
	OR ([AHCash1] = @AHCash1 AND @AHCash1 is not null)
	OR ([AHCash2] = @AHCash2 AND @AHCash2 is not null)
	OR ([AHCash3] = @AHCash3 AND @AHCash3 is not null)
	OR ([AHCash4] = @AHCash4 AND @AHCash4 is not null)
	OR ([AHCash5] = @AHCash5 AND @AHCash5 is not null)
	OR ([AHCash6] = @AHCash6 AND @AHCash6 is not null)
	OR ([AHCash7] = @AHCash7 AND @AHCash7 is not null)
	OR ([AHCash8] = @AHCash8 AND @AHCash8 is not null)
	OR ([AHCash9] = @AHCash9 AND @AHCash9 is not null)
	OR ([PaymentName] = @PaymentName AND @PaymentName is not null)
	OR ([TotalViseChangeMoney] = @TotalViseChangeMoney AND @TotalViseChangeMoney is not null)
	OR ([SumCode] = @SumCode AND @SumCode is not null)
	OR ([PaymentCodition] = @PaymentCodition AND @PaymentCodition is not null)
	OR ([CheckRemark] = @CheckRemark AND @CheckRemark is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="Payment_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the Payment table using a dynamically generated query.
-- Table Comment: 请款
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [PaymentCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( PaymentCode )
				SELECT TOP {3} [PaymentCode]
				FROM dbo.[Payment] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[PaymentCode], O.[PaymentTitle], O.[PaymentID], O.[VoucherID], O.[RecieptCount], O.[ProjectCode], O.[ApplyPerson], O.[ApplyDate], O.[Accountant], O.[AccountDate], O.[Payer], O.[PayDate], O.[Purpose], O.[Money], O.[CheckPerson], O.[CheckDate], O.[CheckOpinion], O.[IsContract], O.[ContractCode], O.[Status], O.[WBSCode], O.[IsApportion], O.[SupplyCode], O.[UnitCode], O.[SupplyName], O.[Remark], O.[OldMoney], O.[GroupCode], O.[BankName], O.[BankAccount], O.[OtherAttachMent], O.[PayType], O.[Issue], O.[IssueMode], O.[FactPayDate], O.[TotalPayMoney], O.[AHMoney], O.[APMoney], O.[UPMoney], O.[SupplierApplyMoney], O.[MaxPayMoney], O.[PlanPayMoney], O.[ContractMoney], O.[AdjustedContractMoney], O.[PayoutMoney], O.[AHCash], O.[APCash], O.[UPCash], O.[PayoutCash], O.[AHCash0], O.[AHCash1], O.[AHCash2], O.[AHCash3], O.[AHCash4], O.[AHCash5], O.[AHCash6], O.[AHCash7], O.[AHCash8], O.[AHCash9], O.[PaymentName], O.[TotalViseChangeMoney], O.[SumCode], O.[PaymentCodition], O.[CheckRemark]
				FROM
				    dbo.[Payment] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[PaymentCode] = PageIndex.[PaymentCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[Payment] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractAccount_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractAccount table
-- Table Comment: 合同结算
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractAccountCode],
					[ContractAccountID],
					[ContractCode],
					[Reason],
					[Status],
					[CreateDate],
					[CreatePerson],
					[ContractChangeCode]
				FROM
					dbo.[ContractAccount]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractAccount_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractAccount table passing page index and page count parameters
-- Table Comment: 合同结算
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractAccountCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractAccountCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractAccountCode]'
				SET @SQL = @SQL + ' FROM dbo.[ContractAccount]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractAccountCode], O.[ContractAccountID], O.[ContractCode], O.[Reason], O.[Status], O.[CreateDate], O.[CreatePerson], O.[ContractChangeCode]
				FROM
				    dbo.[ContractAccount] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractAccountCode] = PageIndex.[ContractAccountCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractAccount]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractAccount_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractAccount table
-- Table Comment: 合同结算
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractAccountCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractAccountID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Reason" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@CreateDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CreatePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractAccount]
					(
					[ContractAccountCode]
					,[ContractAccountID]
					,[ContractCode]
					,[Reason]
					,[Status]
					,[CreateDate]
					,[CreatePerson]
					,[ContractChangeCode]
					)
				VALUES
					(
					@ContractAccountCode
					,@ContractAccountID
					,@ContractCode
					,@Reason
					,@Status
					,@CreateDate
					,@CreatePerson
					,@ContractChangeCode
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractAccount_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractAccount table
-- Table Comment: 合同结算
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractAccountCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractAccountCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractAccountID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Reason" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@CreateDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@CreatePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractAccount]
				SET
					[ContractAccountCode] = @ContractAccountCode
					,[ContractAccountID] = @ContractAccountID
					,[ContractCode] = @ContractCode
					,[Reason] = @Reason
					,[Status] = @Status
					,[CreateDate] = @CreateDate
					,[CreatePerson] = @CreatePerson
					,[ContractChangeCode] = @ContractChangeCode
				WHERE
[ContractAccountCode] = @OriginalContractAccountCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractAccount_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractAccount table
-- Table Comment: 合同结算
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractAccountCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractAccount] WITH (ROWLOCK) 
				WHERE
					[ContractAccountCode] = @ContractAccountCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractAccount_GetByContractCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractAccount table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractAccountCode],
					[ContractAccountID],
					[ContractCode],
					[Reason],
					[Status],
					[CreateDate],
					[CreatePerson],
					[ContractChangeCode]
				FROM
					dbo.[ContractAccount]
				WHERE
					[ContractCode] = @ContractCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractAccount_GetByContractAccountCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractAccount table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractAccountCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractAccountCode],
					[ContractAccountID],
					[ContractCode],
					[Reason],
					[Status],
					[CreateDate],
					[CreatePerson],
					[ContractChangeCode]
				FROM
					dbo.[ContractAccount]
				WHERE
					[ContractAccountCode] = @ContractAccountCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractAccount_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractAccount table passing nullable parameters
-- Table Comment: 合同结算
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractAccountCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractAccountID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Reason" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@CreateDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@CreatePerson" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractAccountCode]
	, [ContractAccountID]
	, [ContractCode]
	, [Reason]
	, [Status]
	, [CreateDate]
	, [CreatePerson]
	, [ContractChangeCode]
    FROM
	dbo.[ContractAccount]
    WHERE 
	 ([ContractAccountCode] = @ContractAccountCode OR @ContractAccountCode is null)
	AND ([ContractAccountID] = @ContractAccountID OR @ContractAccountID is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([Reason] = @Reason OR @Reason is null)
	AND ([Status] = @Status OR @Status is null)
	AND ([CreateDate] = @CreateDate OR @CreateDate is null)
	AND ([CreatePerson] = @CreatePerson OR @CreatePerson is null)
	AND ([ContractChangeCode] = @ContractChangeCode OR @ContractChangeCode is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractAccountCode]
	, [ContractAccountID]
	, [ContractCode]
	, [Reason]
	, [Status]
	, [CreateDate]
	, [CreatePerson]
	, [ContractChangeCode]
    FROM
	dbo.[ContractAccount]
    WHERE 
	 ([ContractAccountCode] = @ContractAccountCode AND @ContractAccountCode is not null)
	OR ([ContractAccountID] = @ContractAccountID AND @ContractAccountID is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([Reason] = @Reason AND @Reason is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([CreateDate] = @CreateDate AND @CreateDate is not null)
	OR ([CreatePerson] = @CreatePerson AND @CreatePerson is not null)
	OR ([ContractChangeCode] = @ContractChangeCode AND @ContractChangeCode is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractAccount_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractAccount table using a dynamically generated query.
-- Table Comment: 合同结算
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractAccountCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractAccountCode )
				SELECT TOP {3} [ContractAccountCode]
				FROM dbo.[ContractAccount] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractAccountCode], O.[ContractAccountID], O.[ContractCode], O.[Reason], O.[Status], O.[CreateDate], O.[CreatePerson], O.[ContractChangeCode]
				FROM
				    dbo.[ContractAccount] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractAccountCode] = PageIndex.[ContractAccountCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractAccount] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractBill_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractBill table
-- Table Comment: 合同发票
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[Code],
					[ProjectCode],
					[ContractCode],
					[BillNo],
					[BillMoney]
				FROM
					dbo.[ContractBill]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractBill_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractBill table passing page index and page count parameters
-- Table Comment: 合同发票
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [Code] int 
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (Code)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [Code]'
				SET @SQL = @SQL + ' FROM dbo.[ContractBill]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[Code], O.[ProjectCode], O.[ContractCode], O.[BillNo], O.[BillMoney]
				FROM
				    dbo.[ContractBill] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[Code] = PageIndex.[Code]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractBill]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractBill_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractBill table
-- Table Comment: 合同发票
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Code" type="int" direction="Output" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BillNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BillMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractBill]
					(
					[ProjectCode]
					,[ContractCode]
					,[BillNo]
					,[BillMoney]
					)
				VALUES
					(
					@ProjectCode
					,@ContractCode
					,@BillNo
					,@BillMoney
					)
				
				-- Get the identity value
				SET @Code = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractBill_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractBill table
-- Table Comment: 合同发票
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Code" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BillNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@BillMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractBill]
				SET
					[ProjectCode] = @ProjectCode
					,[ContractCode] = @ContractCode
					,[BillNo] = @BillNo
					,[BillMoney] = @BillMoney
				WHERE
[Code] = @Code 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractBill_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractBill table
-- Table Comment: 合同发票
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Code" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractBill] WITH (ROWLOCK) 
				WHERE
					[Code] = @Code
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractBill_GetByContractCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractBill table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[Code],
					[ProjectCode],
					[ContractCode],
					[BillNo],
					[BillMoney]
				FROM
					dbo.[ContractBill]
				WHERE
					[ContractCode] = @ContractCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractBill_GetByCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractBill table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Code" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[Code],
					[ProjectCode],
					[ContractCode],
					[BillNo],
					[BillMoney]
				FROM
					dbo.[ContractBill]
				WHERE
					[Code] = @Code
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractBill_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractBill table passing nullable parameters
-- Table Comment: 合同发票
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Code" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ProjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BillNo" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@BillMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [Code]
	, [ProjectCode]
	, [ContractCode]
	, [BillNo]
	, [BillMoney]
    FROM
	dbo.[ContractBill]
    WHERE 
	 ([Code] = @Code OR @Code is null)
	AND ([ProjectCode] = @ProjectCode OR @ProjectCode is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([BillNo] = @BillNo OR @BillNo is null)
	AND ([BillMoney] = @BillMoney OR @BillMoney is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [Code]
	, [ProjectCode]
	, [ContractCode]
	, [BillNo]
	, [BillMoney]
    FROM
	dbo.[ContractBill]
    WHERE 
	 ([Code] = @Code AND @Code is not null)
	OR ([ProjectCode] = @ProjectCode AND @ProjectCode is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([BillNo] = @BillNo AND @BillNo is not null)
	OR ([BillMoney] = @BillMoney AND @BillMoney is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractBill_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractBill table using a dynamically generated query.
-- Table Comment: 合同发票
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [Code] int 
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( Code )
				SELECT TOP {3} [Code]
				FROM dbo.[ContractBill] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[Code], O.[ProjectCode], O.[ContractCode], O.[BillNo], O.[BillMoney]
				FROM
				    dbo.[ContractBill] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[Code] = PageIndex.[Code]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractBill] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractCost_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractCost table
-- Table Comment: 款项
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractCostCode],
					[ContractCode],
					[CostCode],
					[Amount],
					[Money],
					[UnitPrise],
					[Moneycash],
					[OriginalMoneycash],
					[MoneyType],
					[ExchangeRate],
					[CostBudgetSetCode],
					[Description],
					[OriginalMoney]
				FROM
					dbo.[ContractCost]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractCost_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractCost table passing page index and page count parameters
-- Table Comment: 款项
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractCostCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractCostCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractCostCode]'
				SET @SQL = @SQL + ' FROM dbo.[ContractCost]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractCostCode], O.[ContractCode], O.[CostCode], O.[Amount], O.[Money], O.[UnitPrise], O.[Moneycash], O.[OriginalMoneycash], O.[MoneyType], O.[ExchangeRate], O.[CostBudgetSetCode], O.[Description], O.[OriginalMoney]
				FROM
				    dbo.[ContractCost] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractCostCode] = PageIndex.[ContractCostCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractCost]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractCost_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractCost table
-- Table Comment: 款项
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Amount" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@UnitPrise" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Moneycash" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalMoneycash" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="numeric" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractCost]
					(
					[ContractCostCode]
					,[ContractCode]
					,[CostCode]
					,[Amount]
					,[Money]
					,[UnitPrise]
					,[Moneycash]
					,[OriginalMoneycash]
					,[MoneyType]
					,[ExchangeRate]
					,[CostBudgetSetCode]
					,[Description]
					,[OriginalMoney]
					)
				VALUES
					(
					@ContractCostCode
					,@ContractCode
					,@CostCode
					,@Amount
					,@Money
					,@UnitPrise
					,@Moneycash
					,@OriginalMoneycash
					,@MoneyType
					,@ExchangeRate
					,@CostBudgetSetCode
					,@Description
					,@OriginalMoney
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCost_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractCost table
-- Table Comment: 款项
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Amount" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@UnitPrise" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Moneycash" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalMoneycash" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="numeric" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractCost]
				SET
					[ContractCostCode] = @ContractCostCode
					,[ContractCode] = @ContractCode
					,[CostCode] = @CostCode
					,[Amount] = @Amount
					,[Money] = @Money
					,[UnitPrise] = @UnitPrise
					,[Moneycash] = @Moneycash
					,[OriginalMoneycash] = @OriginalMoneycash
					,[MoneyType] = @MoneyType
					,[ExchangeRate] = @ExchangeRate
					,[CostBudgetSetCode] = @CostBudgetSetCode
					,[Description] = @Description
					,[OriginalMoney] = @OriginalMoney
				WHERE
[ContractCostCode] = @OriginalContractCostCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCost_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractCost table
-- Table Comment: 款项
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractCost] WITH (ROWLOCK) 
				WHERE
					[ContractCostCode] = @ContractCostCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCost_GetByCostCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractCost table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractCostCode],
					[ContractCode],
					[CostCode],
					[Amount],
					[Money],
					[UnitPrise],
					[Moneycash],
					[OriginalMoneycash],
					[MoneyType],
					[ExchangeRate],
					[CostBudgetSetCode],
					[Description],
					[OriginalMoney]
				FROM
					dbo.[ContractCost]
				WHERE
					[CostCode] = @CostCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCost_GetByContractCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractCost table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractCostCode],
					[ContractCode],
					[CostCode],
					[Amount],
					[Money],
					[UnitPrise],
					[Moneycash],
					[OriginalMoneycash],
					[MoneyType],
					[ExchangeRate],
					[CostBudgetSetCode],
					[Description],
					[OriginalMoney]
				FROM
					dbo.[ContractCost]
				WHERE
					[ContractCode] = @ContractCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCost_GetByContractCostCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractCost table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractCostCode],
					[ContractCode],
					[CostCode],
					[Amount],
					[Money],
					[UnitPrise],
					[Moneycash],
					[OriginalMoneycash],
					[MoneyType],
					[ExchangeRate],
					[CostBudgetSetCode],
					[Description],
					[OriginalMoney]
				FROM
					dbo.[ContractCost]
				WHERE
					[ContractCostCode] = @ContractCostCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractCost_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractCost table passing nullable parameters
-- Table Comment: 款项
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Amount" type="numeric" direction="Input" size="9" precision="18" scale="0" param="(18, 0)" nulldefault="null"/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@UnitPrise" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@Moneycash" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@OriginalMoneycash" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ExchangeRate" type="numeric" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault="null"/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractCostCode]
	, [ContractCode]
	, [CostCode]
	, [Amount]
	, [Money]
	, [UnitPrise]
	, [Moneycash]
	, [OriginalMoneycash]
	, [MoneyType]
	, [ExchangeRate]
	, [CostBudgetSetCode]
	, [Description]
	, [OriginalMoney]
    FROM
	dbo.[ContractCost]
    WHERE 
	 ([ContractCostCode] = @ContractCostCode OR @ContractCostCode is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([CostCode] = @CostCode OR @CostCode is null)
	AND ([Amount] = @Amount OR @Amount is null)
	AND ([Money] = @Money OR @Money is null)
	AND ([UnitPrise] = @UnitPrise OR @UnitPrise is null)
	AND ([Moneycash] = @Moneycash OR @Moneycash is null)
	AND ([OriginalMoneycash] = @OriginalMoneycash OR @OriginalMoneycash is null)
	AND ([MoneyType] = @MoneyType OR @MoneyType is null)
	AND ([ExchangeRate] = @ExchangeRate OR @ExchangeRate is null)
	AND ([CostBudgetSetCode] = @CostBudgetSetCode OR @CostBudgetSetCode is null)
	AND ([Description] = @Description OR @Description is null)
	AND ([OriginalMoney] = @OriginalMoney OR @OriginalMoney is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractCostCode]
	, [ContractCode]
	, [CostCode]
	, [Amount]
	, [Money]
	, [UnitPrise]
	, [Moneycash]
	, [OriginalMoneycash]
	, [MoneyType]
	, [ExchangeRate]
	, [CostBudgetSetCode]
	, [Description]
	, [OriginalMoney]
    FROM
	dbo.[ContractCost]
    WHERE 
	 ([ContractCostCode] = @ContractCostCode AND @ContractCostCode is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([CostCode] = @CostCode AND @CostCode is not null)
	OR ([Amount] = @Amount AND @Amount is not null)
	OR ([Money] = @Money AND @Money is not null)
	OR ([UnitPrise] = @UnitPrise AND @UnitPrise is not null)
	OR ([Moneycash] = @Moneycash AND @Moneycash is not null)
	OR ([OriginalMoneycash] = @OriginalMoneycash AND @OriginalMoneycash is not null)
	OR ([MoneyType] = @MoneyType AND @MoneyType is not null)
	OR ([ExchangeRate] = @ExchangeRate AND @ExchangeRate is not null)
	OR ([CostBudgetSetCode] = @CostBudgetSetCode AND @CostBudgetSetCode is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([OriginalMoney] = @OriginalMoney AND @OriginalMoney is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractCost_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractCost table using a dynamically generated query.
-- Table Comment: 款项
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractCostCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractCostCode )
				SELECT TOP {3} [ContractCostCode]
				FROM dbo.[ContractCost] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractCostCode], O.[ContractCode], O.[CostCode], O.[Amount], O.[Money], O.[UnitPrise], O.[Moneycash], O.[OriginalMoneycash], O.[MoneyType], O.[ExchangeRate], O.[CostBudgetSetCode], O.[Description], O.[OriginalMoney]
				FROM
				    dbo.[ContractCost] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractCostCode] = PageIndex.[ContractCostCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractCost] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractMaterial_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractMaterial table
-- Table Comment: 合同材料
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractMaterialCode],
					[ContractCode],
					[MaterialCode],
					[Qty],
					[Price],
					[Money]
				FROM
					dbo.[ContractMaterial]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractMaterial_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractMaterial table passing page index and page count parameters
-- Table Comment: 合同材料
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractMaterialCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractMaterialCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractMaterialCode]'
				SET @SQL = @SQL + ' FROM dbo.[ContractMaterial]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractMaterialCode], O.[ContractCode], O.[MaterialCode], O.[Qty], O.[Price], O.[Money]
				FROM
				    dbo.[ContractMaterial] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractMaterialCode] = PageIndex.[ContractMaterialCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractMaterial]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractMaterial_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractMaterial table
-- Table Comment: 合同材料
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Qty" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Price" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractMaterial]
					(
					[ContractMaterialCode]
					,[ContractCode]
					,[MaterialCode]
					,[Qty]
					,[Price]
					,[Money]
					)
				VALUES
					(
					@ContractMaterialCode
					,@ContractCode
					,@MaterialCode
					,@Qty
					,@Price
					,@Money
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterial_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractMaterial table
-- Table Comment: 合同材料
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Qty" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Price" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractMaterial]
				SET
					[ContractMaterialCode] = @ContractMaterialCode
					,[ContractCode] = @ContractCode
					,[MaterialCode] = @MaterialCode
					,[Qty] = @Qty
					,[Price] = @Price
					,[Money] = @Money
				WHERE
[ContractMaterialCode] = @OriginalContractMaterialCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterial_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractMaterial table
-- Table Comment: 合同材料
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractMaterial] WITH (ROWLOCK) 
				WHERE
					[ContractMaterialCode] = @ContractMaterialCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterial_GetByMaterialCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractMaterial table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractMaterialCode],
					[ContractCode],
					[MaterialCode],
					[Qty],
					[Price],
					[Money]
				FROM
					dbo.[ContractMaterial]
				WHERE
					[MaterialCode] = @MaterialCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterial_GetByContractCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractMaterial table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractMaterialCode],
					[ContractCode],
					[MaterialCode],
					[Qty],
					[Price],
					[Money]
				FROM
					dbo.[ContractMaterial]
				WHERE
					[ContractCode] = @ContractCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterial_GetByContractMaterialCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractMaterial table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractMaterialCode],
					[ContractCode],
					[MaterialCode],
					[Qty],
					[Price],
					[Money]
				FROM
					dbo.[ContractMaterial]
				WHERE
					[ContractMaterialCode] = @ContractMaterialCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractMaterial_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractMaterial table passing nullable parameters
-- Table Comment: 合同材料
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@MaterialCode" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Qty" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@Price" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractMaterialCode]
	, [ContractCode]
	, [MaterialCode]
	, [Qty]
	, [Price]
	, [Money]
    FROM
	dbo.[ContractMaterial]
    WHERE 
	 ([ContractMaterialCode] = @ContractMaterialCode OR @ContractMaterialCode is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([MaterialCode] = @MaterialCode OR @MaterialCode is null)
	AND ([Qty] = @Qty OR @Qty is null)
	AND ([Price] = @Price OR @Price is null)
	AND ([Money] = @Money OR @Money is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractMaterialCode]
	, [ContractCode]
	, [MaterialCode]
	, [Qty]
	, [Price]
	, [Money]
    FROM
	dbo.[ContractMaterial]
    WHERE 
	 ([ContractMaterialCode] = @ContractMaterialCode AND @ContractMaterialCode is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([MaterialCode] = @MaterialCode AND @MaterialCode is not null)
	OR ([Qty] = @Qty AND @Qty is not null)
	OR ([Price] = @Price AND @Price is not null)
	OR ([Money] = @Money AND @Money is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractMaterial_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractMaterial table using a dynamically generated query.
-- Table Comment: 合同材料
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractMaterialCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractMaterialCode )
				SELECT TOP {3} [ContractMaterialCode]
				FROM dbo.[ContractMaterial] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractMaterialCode], O.[ContractCode], O.[MaterialCode], O.[Qty], O.[Price], O.[Money]
				FROM
				    dbo.[ContractMaterial] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractMaterialCode] = PageIndex.[ContractMaterialCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractMaterial] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractMaterialPlan_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractMaterialPlan table
-- Table Comment: 合同材料计划 这个表没用了
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractMaterialPlanCode],
					[ContractMaterialCode],
					[ContractCode],
					[PlanDate],
					[PlanQty]
				FROM
					dbo.[ContractMaterialPlan]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractMaterialPlan_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractMaterialPlan table passing page index and page count parameters
-- Table Comment: 合同材料计划 这个表没用了
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractMaterialPlanCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractMaterialPlanCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractMaterialPlanCode]'
				SET @SQL = @SQL + ' FROM dbo.[ContractMaterialPlan]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractMaterialPlanCode], O.[ContractMaterialCode], O.[ContractCode], O.[PlanDate], O.[PlanQty]
				FROM
				    dbo.[ContractMaterialPlan] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractMaterialPlanCode] = PageIndex.[ContractMaterialPlanCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractMaterialPlan]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractMaterialPlan_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractMaterialPlan table
-- Table Comment: 合同材料计划 这个表没用了
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PlanDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PlanQty" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractMaterialPlan]
					(
					[ContractMaterialPlanCode]
					,[ContractMaterialCode]
					,[ContractCode]
					,[PlanDate]
					,[PlanQty]
					)
				VALUES
					(
					@ContractMaterialPlanCode
					,@ContractMaterialCode
					,@ContractCode
					,@PlanDate
					,@PlanQty
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterialPlan_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractMaterialPlan table
-- Table Comment: 合同材料计划 这个表没用了
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractMaterialPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PlanDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PlanQty" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractMaterialPlan]
				SET
					[ContractMaterialPlanCode] = @ContractMaterialPlanCode
					,[ContractMaterialCode] = @ContractMaterialCode
					,[ContractCode] = @ContractCode
					,[PlanDate] = @PlanDate
					,[PlanQty] = @PlanQty
				WHERE
[ContractMaterialPlanCode] = @OriginalContractMaterialPlanCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterialPlan_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractMaterialPlan table
-- Table Comment: 合同材料计划 这个表没用了
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractMaterialPlan] WITH (ROWLOCK) 
				WHERE
					[ContractMaterialPlanCode] = @ContractMaterialPlanCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterialPlan_GetByContractMaterialCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractMaterialPlan table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractMaterialPlanCode],
					[ContractMaterialCode],
					[ContractCode],
					[PlanDate],
					[PlanQty]
				FROM
					dbo.[ContractMaterialPlan]
				WHERE
					[ContractMaterialCode] = @ContractMaterialCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractMaterialPlan_GetByContractMaterialPlanCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractMaterialPlan table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractMaterialPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractMaterialPlanCode],
					[ContractMaterialCode],
					[ContractCode],
					[PlanDate],
					[PlanQty]
				FROM
					dbo.[ContractMaterialPlan]
				WHERE
					[ContractMaterialPlanCode] = @ContractMaterialPlanCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractMaterialPlan_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractMaterialPlan table passing nullable parameters
-- Table Comment: 合同材料计划 这个表没用了
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractMaterialPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractMaterialCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PlanDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@PlanQty" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractMaterialPlanCode]
	, [ContractMaterialCode]
	, [ContractCode]
	, [PlanDate]
	, [PlanQty]
    FROM
	dbo.[ContractMaterialPlan]
    WHERE 
	 ([ContractMaterialPlanCode] = @ContractMaterialPlanCode OR @ContractMaterialPlanCode is null)
	AND ([ContractMaterialCode] = @ContractMaterialCode OR @ContractMaterialCode is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([PlanDate] = @PlanDate OR @PlanDate is null)
	AND ([PlanQty] = @PlanQty OR @PlanQty is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractMaterialPlanCode]
	, [ContractMaterialCode]
	, [ContractCode]
	, [PlanDate]
	, [PlanQty]
    FROM
	dbo.[ContractMaterialPlan]
    WHERE 
	 ([ContractMaterialPlanCode] = @ContractMaterialPlanCode AND @ContractMaterialPlanCode is not null)
	OR ([ContractMaterialCode] = @ContractMaterialCode AND @ContractMaterialCode is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([PlanDate] = @PlanDate AND @PlanDate is not null)
	OR ([PlanQty] = @PlanQty AND @PlanQty is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractMaterialPlan_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractMaterialPlan table using a dynamically generated query.
-- Table Comment: 合同材料计划 这个表没用了
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractMaterialPlanCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractMaterialPlanCode )
				SELECT TOP {3} [ContractMaterialPlanCode]
				FROM dbo.[ContractMaterialPlan] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractMaterialPlanCode], O.[ContractMaterialCode], O.[ContractCode], O.[PlanDate], O.[PlanQty]
				FROM
				    dbo.[ContractMaterialPlan] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractMaterialPlanCode] = PageIndex.[ContractMaterialPlanCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractMaterialPlan] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractNexus_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractNexus table
-- Table Comment: 合同关系
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractNexusCode],
					[ContractCode],
					[ContractChangeCode],
					[Code],
					[Type],
					[Name],
					[ID],
					[Person],
					[Date],
					[Path],
					[Money]
				FROM
					dbo.[ContractNexus]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractNexus_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractNexus table passing page index and page count parameters
-- Table Comment: 合同关系
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractNexusCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractNexusCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractNexusCode]'
				SET @SQL = @SQL + ' FROM dbo.[ContractNexus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractNexusCode], O.[ContractCode], O.[ContractChangeCode], O.[Code], O.[Type], O.[Name], O.[ID], O.[Person], O.[Date], O.[Path], O.[Money]
				FROM
				    dbo.[ContractNexus] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractNexusCode] = PageIndex.[ContractNexusCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractNexus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractNexus_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractNexus table
-- Table Comment: 合同关系
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractNexusCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Type" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Person" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Date" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Path" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractNexus]
					(
					[ContractNexusCode]
					,[ContractCode]
					,[ContractChangeCode]
					,[Code]
					,[Type]
					,[Name]
					,[ID]
					,[Person]
					,[Date]
					,[Path]
					,[Money]
					)
				VALUES
					(
					@ContractNexusCode
					,@ContractCode
					,@ContractChangeCode
					,@Code
					,@Type
					,@Name
					,@ID
					,@Person
					,@Date
					,@Path
					,@Money
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractNexus_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractNexus table
-- Table Comment: 合同关系
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractNexusCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractNexusCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Type" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Person" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Date" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@Path" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault=""/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractNexus]
				SET
					[ContractNexusCode] = @ContractNexusCode
					,[ContractCode] = @ContractCode
					,[ContractChangeCode] = @ContractChangeCode
					,[Code] = @Code
					,[Type] = @Type
					,[Name] = @Name
					,[ID] = @ID
					,[Person] = @Person
					,[Date] = @Date
					,[Path] = @Path
					,[Money] = @Money
				WHERE
[ContractNexusCode] = @OriginalContractNexusCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractNexus_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractNexus table
-- Table Comment: 合同关系
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractNexusCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractNexus] WITH (ROWLOCK) 
				WHERE
					[ContractNexusCode] = @ContractNexusCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractNexus_GetByContractChangeCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractNexus table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractNexusCode],
					[ContractCode],
					[ContractChangeCode],
					[Code],
					[Type],
					[Name],
					[ID],
					[Person],
					[Date],
					[Path],
					[Money]
				FROM
					dbo.[ContractNexus]
				WHERE
					[ContractChangeCode] = @ContractChangeCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractNexus_GetByContractNexusCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractNexus table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractNexusCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractNexusCode],
					[ContractCode],
					[ContractChangeCode],
					[Code],
					[Type],
					[Name],
					[ID],
					[Person],
					[Date],
					[Path],
					[Money]
				FROM
					dbo.[ContractNexus]
				WHERE
					[ContractNexusCode] = @ContractNexusCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractNexus_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractNexus table passing nullable parameters
-- Table Comment: 合同关系
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractNexusCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Code" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Type" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Name" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ID" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Person" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Date" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@Path" type="varchar" direction="Input" size="500" precision="0" scale="0" param="(500)" nulldefault="null"/>
				<parameter name="@Money" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractNexusCode]
	, [ContractCode]
	, [ContractChangeCode]
	, [Code]
	, [Type]
	, [Name]
	, [ID]
	, [Person]
	, [Date]
	, [Path]
	, [Money]
    FROM
	dbo.[ContractNexus]
    WHERE 
	 ([ContractNexusCode] = @ContractNexusCode OR @ContractNexusCode is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([ContractChangeCode] = @ContractChangeCode OR @ContractChangeCode is null)
	AND ([Code] = @Code OR @Code is null)
	AND ([Type] = @Type OR @Type is null)
	AND ([Name] = @Name OR @Name is null)
	AND ([ID] = @ID OR @ID is null)
	AND ([Person] = @Person OR @Person is null)
	AND ([Date] = @Date OR @Date is null)
	AND ([Path] = @Path OR @Path is null)
	AND ([Money] = @Money OR @Money is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractNexusCode]
	, [ContractCode]
	, [ContractChangeCode]
	, [Code]
	, [Type]
	, [Name]
	, [ID]
	, [Person]
	, [Date]
	, [Path]
	, [Money]
    FROM
	dbo.[ContractNexus]
    WHERE 
	 ([ContractNexusCode] = @ContractNexusCode AND @ContractNexusCode is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([ContractChangeCode] = @ContractChangeCode AND @ContractChangeCode is not null)
	OR ([Code] = @Code AND @Code is not null)
	OR ([Type] = @Type AND @Type is not null)
	OR ([Name] = @Name AND @Name is not null)
	OR ([ID] = @ID AND @ID is not null)
	OR ([Person] = @Person AND @Person is not null)
	OR ([Date] = @Date AND @Date is not null)
	OR ([Path] = @Path AND @Path is not null)
	OR ([Money] = @Money AND @Money is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractNexus_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractNexus table using a dynamically generated query.
-- Table Comment: 合同关系
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractNexusCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractNexusCode )
				SELECT TOP {3} [ContractNexusCode]
				FROM dbo.[ContractNexus] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractNexusCode], O.[ContractCode], O.[ContractChangeCode], O.[Code], O.[Type], O.[Name], O.[ID], O.[Person], O.[Date], O.[Path], O.[Money]
				FROM
				    dbo.[ContractNexus] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractNexusCode] = PageIndex.[ContractNexusCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractNexus] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="PayoutItem_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the PayoutItem table
-- Table Comment: 付款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[PayoutItemCode],
					[PayoutCode],
					[PaymentItemCode],
					[PayoutMoney],
					[SubjectCode],
					[Remark],
					[AlloType],
					[IsManualAlloc],
					[PayoutCash],
					[MoneyType],
					[ExchangeRate],
					[PayoutMoneyType],
					[PayoutExchangeRate]
				FROM
					dbo.[PayoutItem]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="PayoutItem_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the PayoutItem table passing page index and page count parameters
-- Table Comment: 付款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [PayoutItemCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (PayoutItemCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [PayoutItemCode]'
				SET @SQL = @SQL + ' FROM dbo.[PayoutItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[PayoutItemCode], O.[PayoutCode], O.[PaymentItemCode], O.[PayoutMoney], O.[SubjectCode], O.[Remark], O.[AlloType], O.[IsManualAlloc], O.[PayoutCash], O.[MoneyType], O.[ExchangeRate], O.[PayoutMoneyType], O.[PayoutExchangeRate]
				FROM
				    dbo.[PayoutItem] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[PayoutItemCode] = PageIndex.[PayoutItemCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[PayoutItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="PayoutItem_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the PayoutItem table
-- Table Comment: 付款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayoutMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@SubjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@AlloType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@IsManualAlloc" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@PayoutCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
				<parameter name="@PayoutMoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayoutExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[PayoutItem]
					(
					[PayoutItemCode]
					,[PayoutCode]
					,[PaymentItemCode]
					,[PayoutMoney]
					,[SubjectCode]
					,[Remark]
					,[AlloType]
					,[IsManualAlloc]
					,[PayoutCash]
					,[MoneyType]
					,[ExchangeRate]
					,[PayoutMoneyType]
					,[PayoutExchangeRate]
					)
				VALUES
					(
					@PayoutItemCode
					,@PayoutCode
					,@PaymentItemCode
					,@PayoutMoney
					,@SubjectCode
					,@Remark
					,@AlloType
					,@IsManualAlloc
					,@PayoutCash
					,@MoneyType
					,@ExchangeRate
					,@PayoutMoneyType
					,@PayoutExchangeRate
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PayoutItem_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the PayoutItem table
-- Table Comment: 付款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalPayoutItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayoutMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@SubjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@AlloType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@IsManualAlloc" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@PayoutCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
				<parameter name="@PayoutMoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PayoutExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[PayoutItem]
				SET
					[PayoutItemCode] = @PayoutItemCode
					,[PayoutCode] = @PayoutCode
					,[PaymentItemCode] = @PaymentItemCode
					,[PayoutMoney] = @PayoutMoney
					,[SubjectCode] = @SubjectCode
					,[Remark] = @Remark
					,[AlloType] = @AlloType
					,[IsManualAlloc] = @IsManualAlloc
					,[PayoutCash] = @PayoutCash
					,[MoneyType] = @MoneyType
					,[ExchangeRate] = @ExchangeRate
					,[PayoutMoneyType] = @PayoutMoneyType
					,[PayoutExchangeRate] = @PayoutExchangeRate
				WHERE
[PayoutItemCode] = @OriginalPayoutItemCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PayoutItem_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the PayoutItem table
-- Table Comment: 付款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[PayoutItem] WITH (ROWLOCK) 
				WHERE
					[PayoutItemCode] = @PayoutItemCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PayoutItem_GetByPayoutCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the PayoutItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[PayoutItemCode],
					[PayoutCode],
					[PaymentItemCode],
					[PayoutMoney],
					[SubjectCode],
					[Remark],
					[AlloType],
					[IsManualAlloc],
					[PayoutCash],
					[MoneyType],
					[ExchangeRate],
					[PayoutMoneyType],
					[PayoutExchangeRate]
				FROM
					dbo.[PayoutItem]
				WHERE
					[PayoutCode] = @PayoutCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PayoutItem_GetByPaymentItemCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the PayoutItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[PayoutItemCode],
					[PayoutCode],
					[PaymentItemCode],
					[PayoutMoney],
					[SubjectCode],
					[Remark],
					[AlloType],
					[IsManualAlloc],
					[PayoutCash],
					[MoneyType],
					[ExchangeRate],
					[PayoutMoneyType],
					[PayoutExchangeRate]
				FROM
					dbo.[PayoutItem]
				WHERE
					[PaymentItemCode] = @PaymentItemCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PayoutItem_GetByPayoutItemCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the PayoutItem table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PayoutItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[PayoutItemCode],
					[PayoutCode],
					[PaymentItemCode],
					[PayoutMoney],
					[SubjectCode],
					[Remark],
					[AlloType],
					[IsManualAlloc],
					[PayoutCash],
					[MoneyType],
					[ExchangeRate],
					[PayoutMoneyType],
					[PayoutExchangeRate]
				FROM
					dbo.[PayoutItem]
				WHERE
					[PayoutItemCode] = @PayoutItemCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="PayoutItem_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the PayoutItem table passing nullable parameters
-- Table Comment: 付款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@PayoutItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PayoutCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PayoutMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@SubjectCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@AlloType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@IsManualAlloc" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@PayoutCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault="null"/>
				<parameter name="@PayoutMoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PayoutExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="8" param="(18, 8)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [PayoutItemCode]
	, [PayoutCode]
	, [PaymentItemCode]
	, [PayoutMoney]
	, [SubjectCode]
	, [Remark]
	, [AlloType]
	, [IsManualAlloc]
	, [PayoutCash]
	, [MoneyType]
	, [ExchangeRate]
	, [PayoutMoneyType]
	, [PayoutExchangeRate]
    FROM
	dbo.[PayoutItem]
    WHERE 
	 ([PayoutItemCode] = @PayoutItemCode OR @PayoutItemCode is null)
	AND ([PayoutCode] = @PayoutCode OR @PayoutCode is null)
	AND ([PaymentItemCode] = @PaymentItemCode OR @PaymentItemCode is null)
	AND ([PayoutMoney] = @PayoutMoney OR @PayoutMoney is null)
	AND ([SubjectCode] = @SubjectCode OR @SubjectCode is null)
	AND ([Remark] = @Remark OR @Remark is null)
	AND ([AlloType] = @AlloType OR @AlloType is null)
	AND ([IsManualAlloc] = @IsManualAlloc OR @IsManualAlloc is null)
	AND ([PayoutCash] = @PayoutCash OR @PayoutCash is null)
	AND ([MoneyType] = @MoneyType OR @MoneyType is null)
	AND ([ExchangeRate] = @ExchangeRate OR @ExchangeRate is null)
	AND ([PayoutMoneyType] = @PayoutMoneyType OR @PayoutMoneyType is null)
	AND ([PayoutExchangeRate] = @PayoutExchangeRate OR @PayoutExchangeRate is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [PayoutItemCode]
	, [PayoutCode]
	, [PaymentItemCode]
	, [PayoutMoney]
	, [SubjectCode]
	, [Remark]
	, [AlloType]
	, [IsManualAlloc]
	, [PayoutCash]
	, [MoneyType]
	, [ExchangeRate]
	, [PayoutMoneyType]
	, [PayoutExchangeRate]
    FROM
	dbo.[PayoutItem]
    WHERE 
	 ([PayoutItemCode] = @PayoutItemCode AND @PayoutItemCode is not null)
	OR ([PayoutCode] = @PayoutCode AND @PayoutCode is not null)
	OR ([PaymentItemCode] = @PaymentItemCode AND @PaymentItemCode is not null)
	OR ([PayoutMoney] = @PayoutMoney AND @PayoutMoney is not null)
	OR ([SubjectCode] = @SubjectCode AND @SubjectCode is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	OR ([AlloType] = @AlloType AND @AlloType is not null)
	OR ([IsManualAlloc] = @IsManualAlloc AND @IsManualAlloc is not null)
	OR ([PayoutCash] = @PayoutCash AND @PayoutCash is not null)
	OR ([MoneyType] = @MoneyType AND @MoneyType is not null)
	OR ([ExchangeRate] = @ExchangeRate AND @ExchangeRate is not null)
	OR ([PayoutMoneyType] = @PayoutMoneyType AND @PayoutMoneyType is not null)
	OR ([PayoutExchangeRate] = @PayoutExchangeRate AND @PayoutExchangeRate is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="PayoutItem_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the PayoutItem table using a dynamically generated query.
-- Table Comment: 付款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [PayoutItemCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( PayoutItemCode )
				SELECT TOP {3} [PayoutItemCode]
				FROM dbo.[PayoutItem] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[PayoutItemCode], O.[PayoutCode], O.[PaymentItemCode], O.[PayoutMoney], O.[SubjectCode], O.[Remark], O.[AlloType], O.[IsManualAlloc], O.[PayoutCash], O.[MoneyType], O.[ExchangeRate], O.[PayoutMoneyType], O.[PayoutExchangeRate]
				FROM
				    dbo.[PayoutItem] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[PayoutItemCode] = PageIndex.[PayoutItemCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[PayoutItem] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractCostChange_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractCostChange table
-- Table Comment: 合同金额变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractCostChangeCode],
					[ContractCode],
					[ContractCostCode],
					[ContractChangeCode],
					[Cash],
					[ChangeCash],
					[NewCash],
					[OriginalCash],
					[TotalChangeCash],
					[MoneyType],
					[ExchangeRate],
					[Money],
					[ChangeMoney],
					[NewMoney],
					[OriginalMoney],
					[TotalChangeMoney],
					[CostCode],
					[CostBudgetSetCode],
					[Description],
					[Status]
				FROM
					dbo.[ContractCostChange]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractCostChange_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractCostChange table passing page index and page count parameters
-- Table Comment: 合同金额变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractCostChangeCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractCostChangeCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractCostChangeCode]'
				SET @SQL = @SQL + ' FROM dbo.[ContractCostChange]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractCostChangeCode], O.[ContractCode], O.[ContractCostCode], O.[ContractChangeCode], O.[Cash], O.[ChangeCash], O.[NewCash], O.[OriginalCash], O.[TotalChangeCash], O.[MoneyType], O.[ExchangeRate], O.[Money], O.[ChangeMoney], O.[NewMoney], O.[OriginalMoney], O.[TotalChangeMoney], O.[CostCode], O.[CostBudgetSetCode], O.[Description], O.[Status]
				FROM
				    dbo.[ContractCostChange] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractCostChangeCode] = PageIndex.[ContractCostChangeCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractCostChange]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractCostChange_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractCostChange table
-- Table Comment: 合同金额变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Cash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ChangeCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@NewCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalChangeCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@NewMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractCostChange]
					(
					[ContractCostChangeCode]
					,[ContractCode]
					,[ContractCostCode]
					,[ContractChangeCode]
					,[Cash]
					,[ChangeCash]
					,[NewCash]
					,[OriginalCash]
					,[TotalChangeCash]
					,[MoneyType]
					,[ExchangeRate]
					,[Money]
					,[ChangeMoney]
					,[NewMoney]
					,[OriginalMoney]
					,[TotalChangeMoney]
					,[CostCode]
					,[CostBudgetSetCode]
					,[Description]
					,[Status]
					)
				VALUES
					(
					@ContractCostChangeCode
					,@ContractCode
					,@ContractCostCode
					,@ContractChangeCode
					,@Cash
					,@ChangeCash
					,@NewCash
					,@OriginalCash
					,@TotalChangeCash
					,@MoneyType
					,@ExchangeRate
					,@Money
					,@ChangeMoney
					,@NewMoney
					,@OriginalMoney
					,@TotalChangeMoney
					,@CostCode
					,@CostBudgetSetCode
					,@Description
					,@Status
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCostChange_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractCostChange table
-- Table Comment: 合同金额变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractCostChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Cash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ChangeCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@NewCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalChangeCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@NewMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@TotalChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractCostChange]
				SET
					[ContractCostChangeCode] = @ContractCostChangeCode
					,[ContractCode] = @ContractCode
					,[ContractCostCode] = @ContractCostCode
					,[ContractChangeCode] = @ContractChangeCode
					,[Cash] = @Cash
					,[ChangeCash] = @ChangeCash
					,[NewCash] = @NewCash
					,[OriginalCash] = @OriginalCash
					,[TotalChangeCash] = @TotalChangeCash
					,[MoneyType] = @MoneyType
					,[ExchangeRate] = @ExchangeRate
					,[Money] = @Money
					,[ChangeMoney] = @ChangeMoney
					,[NewMoney] = @NewMoney
					,[OriginalMoney] = @OriginalMoney
					,[TotalChangeMoney] = @TotalChangeMoney
					,[CostCode] = @CostCode
					,[CostBudgetSetCode] = @CostBudgetSetCode
					,[Description] = @Description
					,[Status] = @Status
				WHERE
[ContractCostChangeCode] = @OriginalContractCostChangeCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCostChange_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractCostChange table
-- Table Comment: 合同金额变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractCostChange] WITH (ROWLOCK) 
				WHERE
					[ContractCostChangeCode] = @ContractCostChangeCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCostChange_GetByContractChangeCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractCostChange table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractCostChangeCode],
					[ContractCode],
					[ContractCostCode],
					[ContractChangeCode],
					[Cash],
					[ChangeCash],
					[NewCash],
					[OriginalCash],
					[TotalChangeCash],
					[MoneyType],
					[ExchangeRate],
					[Money],
					[ChangeMoney],
					[NewMoney],
					[OriginalMoney],
					[TotalChangeMoney],
					[CostCode],
					[CostBudgetSetCode],
					[Description],
					[Status]
				FROM
					dbo.[ContractCostChange]
				WHERE
					[ContractChangeCode] = @ContractChangeCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCostChange_GetByContractCostChangeCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractCostChange table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractCostChangeCode],
					[ContractCode],
					[ContractCostCode],
					[ContractChangeCode],
					[Cash],
					[ChangeCash],
					[NewCash],
					[OriginalCash],
					[TotalChangeCash],
					[MoneyType],
					[ExchangeRate],
					[Money],
					[ChangeMoney],
					[NewMoney],
					[OriginalMoney],
					[TotalChangeMoney],
					[CostCode],
					[CostBudgetSetCode],
					[Description],
					[Status]
				FROM
					dbo.[ContractCostChange]
				WHERE
					[ContractCostChangeCode] = @ContractCostChangeCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractCostChange_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractCostChange table passing nullable parameters
-- Table Comment: 合同金额变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractCostChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractChangeCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Cash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ChangeCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@NewCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@OriginalCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@TotalChangeCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@NewMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@OriginalMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@TotalChangeMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@Status" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractCostChangeCode]
	, [ContractCode]
	, [ContractCostCode]
	, [ContractChangeCode]
	, [Cash]
	, [ChangeCash]
	, [NewCash]
	, [OriginalCash]
	, [TotalChangeCash]
	, [MoneyType]
	, [ExchangeRate]
	, [Money]
	, [ChangeMoney]
	, [NewMoney]
	, [OriginalMoney]
	, [TotalChangeMoney]
	, [CostCode]
	, [CostBudgetSetCode]
	, [Description]
	, [Status]
    FROM
	dbo.[ContractCostChange]
    WHERE 
	 ([ContractCostChangeCode] = @ContractCostChangeCode OR @ContractCostChangeCode is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([ContractCostCode] = @ContractCostCode OR @ContractCostCode is null)
	AND ([ContractChangeCode] = @ContractChangeCode OR @ContractChangeCode is null)
	AND ([Cash] = @Cash OR @Cash is null)
	AND ([ChangeCash] = @ChangeCash OR @ChangeCash is null)
	AND ([NewCash] = @NewCash OR @NewCash is null)
	AND ([OriginalCash] = @OriginalCash OR @OriginalCash is null)
	AND ([TotalChangeCash] = @TotalChangeCash OR @TotalChangeCash is null)
	AND ([MoneyType] = @MoneyType OR @MoneyType is null)
	AND ([ExchangeRate] = @ExchangeRate OR @ExchangeRate is null)
	AND ([Money] = @Money OR @Money is null)
	AND ([ChangeMoney] = @ChangeMoney OR @ChangeMoney is null)
	AND ([NewMoney] = @NewMoney OR @NewMoney is null)
	AND ([OriginalMoney] = @OriginalMoney OR @OriginalMoney is null)
	AND ([TotalChangeMoney] = @TotalChangeMoney OR @TotalChangeMoney is null)
	AND ([CostCode] = @CostCode OR @CostCode is null)
	AND ([CostBudgetSetCode] = @CostBudgetSetCode OR @CostBudgetSetCode is null)
	AND ([Description] = @Description OR @Description is null)
	AND ([Status] = @Status OR @Status is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractCostChangeCode]
	, [ContractCode]
	, [ContractCostCode]
	, [ContractChangeCode]
	, [Cash]
	, [ChangeCash]
	, [NewCash]
	, [OriginalCash]
	, [TotalChangeCash]
	, [MoneyType]
	, [ExchangeRate]
	, [Money]
	, [ChangeMoney]
	, [NewMoney]
	, [OriginalMoney]
	, [TotalChangeMoney]
	, [CostCode]
	, [CostBudgetSetCode]
	, [Description]
	, [Status]
    FROM
	dbo.[ContractCostChange]
    WHERE 
	 ([ContractCostChangeCode] = @ContractCostChangeCode AND @ContractCostChangeCode is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([ContractCostCode] = @ContractCostCode AND @ContractCostCode is not null)
	OR ([ContractChangeCode] = @ContractChangeCode AND @ContractChangeCode is not null)
	OR ([Cash] = @Cash AND @Cash is not null)
	OR ([ChangeCash] = @ChangeCash AND @ChangeCash is not null)
	OR ([NewCash] = @NewCash AND @NewCash is not null)
	OR ([OriginalCash] = @OriginalCash AND @OriginalCash is not null)
	OR ([TotalChangeCash] = @TotalChangeCash AND @TotalChangeCash is not null)
	OR ([MoneyType] = @MoneyType AND @MoneyType is not null)
	OR ([ExchangeRate] = @ExchangeRate AND @ExchangeRate is not null)
	OR ([Money] = @Money AND @Money is not null)
	OR ([ChangeMoney] = @ChangeMoney AND @ChangeMoney is not null)
	OR ([NewMoney] = @NewMoney AND @NewMoney is not null)
	OR ([OriginalMoney] = @OriginalMoney AND @OriginalMoney is not null)
	OR ([TotalChangeMoney] = @TotalChangeMoney AND @TotalChangeMoney is not null)
	OR ([CostCode] = @CostCode AND @CostCode is not null)
	OR ([CostBudgetSetCode] = @CostBudgetSetCode AND @CostBudgetSetCode is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([Status] = @Status AND @Status is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractCostChange_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractCostChange table using a dynamically generated query.
-- Table Comment: 合同金额变更
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractCostChangeCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractCostChangeCode )
				SELECT TOP {3} [ContractCostChangeCode]
				FROM dbo.[ContractCostChange] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractCostChangeCode], O.[ContractCode], O.[ContractCostCode], O.[ContractChangeCode], O.[Cash], O.[ChangeCash], O.[NewCash], O.[OriginalCash], O.[TotalChangeCash], O.[MoneyType], O.[ExchangeRate], O.[Money], O.[ChangeMoney], O.[NewMoney], O.[OriginalMoney], O.[TotalChangeMoney], O.[CostCode], O.[CostBudgetSetCode], O.[Description], O.[Status]
				FROM
				    dbo.[ContractCostChange] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractCostChangeCode] = PageIndex.[ContractCostChangeCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractCostChange] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="PaymentItem_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the PaymentItem table
-- Table Comment: 请款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[PaymentItemCode],
					[PaymentCode],
					[CostCode],
					[PaymentType],
					[ItemMoney],
					[Summary],
					[Remark],
					[AllocateCode],
					[OldItemMoney],
					[AlloType],
					[CostBudgetSetCode],
					[PBSType],
					[PBSCode],
					[Description],
					[ContractCostCode],
					[ItemCash],
					[MoneyType],
					[ExchangeRate],
					[ItemCash0],
					[ItemCash1],
					[ItemCash2],
					[ItemCash3],
					[ItemCash4],
					[ItemCash5],
					[ItemCash6],
					[ItemCash7],
					[ItemCash8],
					[ItemCash9]
				FROM
					dbo.[PaymentItem]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="PaymentItem_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the PaymentItem table passing page index and page count parameters
-- Table Comment: 请款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [PaymentItemCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (PaymentItemCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [PaymentItemCode]'
				SET @SQL = @SQL + ' FROM dbo.[PaymentItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[PaymentItemCode], O.[PaymentCode], O.[CostCode], O.[PaymentType], O.[ItemMoney], O.[Summary], O.[Remark], O.[AllocateCode], O.[OldItemMoney], O.[AlloType], O.[CostBudgetSetCode], O.[PBSType], O.[PBSCode], O.[Description], O.[ContractCostCode], O.[ItemCash], O.[MoneyType], O.[ExchangeRate], O.[ItemCash0], O.[ItemCash1], O.[ItemCash2], O.[ItemCash3], O.[ItemCash4], O.[ItemCash5], O.[ItemCash6], O.[ItemCash7], O.[ItemCash8], O.[ItemCash9]
				FROM
				    dbo.[PaymentItem] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[PaymentItemCode] = PageIndex.[PaymentItemCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[PaymentItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="PaymentItem_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the PaymentItem table
-- Table Comment: 请款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ItemMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Summary" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@AllocateCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OldItemMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AlloType" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault=""/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PBSType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PBSCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ItemCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="9" param="(18, 9)" nulldefault=""/>
				<parameter name="@ItemCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[PaymentItem]
					(
					[PaymentItemCode]
					,[PaymentCode]
					,[CostCode]
					,[PaymentType]
					,[ItemMoney]
					,[Summary]
					,[Remark]
					,[AllocateCode]
					,[OldItemMoney]
					,[AlloType]
					,[CostBudgetSetCode]
					,[PBSType]
					,[PBSCode]
					,[Description]
					,[ContractCostCode]
					,[ItemCash]
					,[MoneyType]
					,[ExchangeRate]
					,[ItemCash0]
					,[ItemCash1]
					,[ItemCash2]
					,[ItemCash3]
					,[ItemCash4]
					,[ItemCash5]
					,[ItemCash6]
					,[ItemCash7]
					,[ItemCash8]
					,[ItemCash9]
					)
				VALUES
					(
					@PaymentItemCode
					,@PaymentCode
					,@CostCode
					,@PaymentType
					,@ItemMoney
					,@Summary
					,@Remark
					,@AllocateCode
					,@OldItemMoney
					,@AlloType
					,@CostBudgetSetCode
					,@PBSType
					,@PBSCode
					,@Description
					,@ContractCostCode
					,@ItemCash
					,@MoneyType
					,@ExchangeRate
					,@ItemCash0
					,@ItemCash1
					,@ItemCash2
					,@ItemCash3
					,@ItemCash4
					,@ItemCash5
					,@ItemCash6
					,@ItemCash7
					,@ItemCash8
					,@ItemCash9
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PaymentItem_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the PaymentItem table
-- Table Comment: 请款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalPaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PaymentType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ItemMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@Summary" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@AllocateCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OldItemMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@AlloType" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault=""/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PBSType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@PBSCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault=""/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ItemCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="9" param="(18, 9)" nulldefault=""/>
				<parameter name="@ItemCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@ItemCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[PaymentItem]
				SET
					[PaymentItemCode] = @PaymentItemCode
					,[PaymentCode] = @PaymentCode
					,[CostCode] = @CostCode
					,[PaymentType] = @PaymentType
					,[ItemMoney] = @ItemMoney
					,[Summary] = @Summary
					,[Remark] = @Remark
					,[AllocateCode] = @AllocateCode
					,[OldItemMoney] = @OldItemMoney
					,[AlloType] = @AlloType
					,[CostBudgetSetCode] = @CostBudgetSetCode
					,[PBSType] = @PBSType
					,[PBSCode] = @PBSCode
					,[Description] = @Description
					,[ContractCostCode] = @ContractCostCode
					,[ItemCash] = @ItemCash
					,[MoneyType] = @MoneyType
					,[ExchangeRate] = @ExchangeRate
					,[ItemCash0] = @ItemCash0
					,[ItemCash1] = @ItemCash1
					,[ItemCash2] = @ItemCash2
					,[ItemCash3] = @ItemCash3
					,[ItemCash4] = @ItemCash4
					,[ItemCash5] = @ItemCash5
					,[ItemCash6] = @ItemCash6
					,[ItemCash7] = @ItemCash7
					,[ItemCash8] = @ItemCash8
					,[ItemCash9] = @ItemCash9
				WHERE
[PaymentItemCode] = @OriginalPaymentItemCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PaymentItem_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the PaymentItem table
-- Table Comment: 请款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[PaymentItem] WITH (ROWLOCK) 
				WHERE
					[PaymentItemCode] = @PaymentItemCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PaymentItem_GetByContractCostCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the PaymentItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[PaymentItemCode],
					[PaymentCode],
					[CostCode],
					[PaymentType],
					[ItemMoney],
					[Summary],
					[Remark],
					[AllocateCode],
					[OldItemMoney],
					[AlloType],
					[CostBudgetSetCode],
					[PBSType],
					[PBSCode],
					[Description],
					[ContractCostCode],
					[ItemCash],
					[MoneyType],
					[ExchangeRate],
					[ItemCash0],
					[ItemCash1],
					[ItemCash2],
					[ItemCash3],
					[ItemCash4],
					[ItemCash5],
					[ItemCash6],
					[ItemCash7],
					[ItemCash8],
					[ItemCash9]
				FROM
					dbo.[PaymentItem]
				WHERE
					[ContractCostCode] = @ContractCostCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PaymentItem_GetByPaymentCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the PaymentItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[PaymentItemCode],
					[PaymentCode],
					[CostCode],
					[PaymentType],
					[ItemMoney],
					[Summary],
					[Remark],
					[AllocateCode],
					[OldItemMoney],
					[AlloType],
					[CostBudgetSetCode],
					[PBSType],
					[PBSCode],
					[Description],
					[ContractCostCode],
					[ItemCash],
					[MoneyType],
					[ExchangeRate],
					[ItemCash0],
					[ItemCash1],
					[ItemCash2],
					[ItemCash3],
					[ItemCash4],
					[ItemCash5],
					[ItemCash6],
					[ItemCash7],
					[ItemCash8],
					[ItemCash9]
				FROM
					dbo.[PaymentItem]
				WHERE
					[PaymentCode] = @PaymentCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="PaymentItem_GetByPaymentItemCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the PaymentItem table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[PaymentItemCode],
					[PaymentCode],
					[CostCode],
					[PaymentType],
					[ItemMoney],
					[Summary],
					[Remark],
					[AllocateCode],
					[OldItemMoney],
					[AlloType],
					[CostBudgetSetCode],
					[PBSType],
					[PBSCode],
					[Description],
					[ContractCostCode],
					[ItemCash],
					[MoneyType],
					[ExchangeRate],
					[ItemCash0],
					[ItemCash1],
					[ItemCash2],
					[ItemCash3],
					[ItemCash4],
					[ItemCash5],
					[ItemCash6],
					[ItemCash7],
					[ItemCash8],
					[ItemCash9]
				FROM
					dbo.[PaymentItem]
				WHERE
					[PaymentItemCode] = @PaymentItemCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="PaymentItem_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the PaymentItem table passing nullable parameters
-- Table Comment: 请款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@PaymentItemCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PaymentCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@CostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PaymentType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ItemMoney" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@Summary" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@Remark" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@AllocateCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@OldItemMoney" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@AlloType" type="varchar" direction="Input" size="1" precision="0" scale="0" param="(1)" nulldefault="null"/>
				<parameter name="@CostBudgetSetCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PBSType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@PBSCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Description" type="varchar" direction="Input" size="800" precision="0" scale="0" param="(800)" nulldefault="null"/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ItemCash" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@MoneyType" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ExchangeRate" type="decimal" direction="Input" size="9" precision="18" scale="9" param="(18, 9)" nulldefault="null"/>
				<parameter name="@ItemCash0" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash1" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash2" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash3" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash4" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash5" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash6" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash7" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash8" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@ItemCash9" type="decimal" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [PaymentItemCode]
	, [PaymentCode]
	, [CostCode]
	, [PaymentType]
	, [ItemMoney]
	, [Summary]
	, [Remark]
	, [AllocateCode]
	, [OldItemMoney]
	, [AlloType]
	, [CostBudgetSetCode]
	, [PBSType]
	, [PBSCode]
	, [Description]
	, [ContractCostCode]
	, [ItemCash]
	, [MoneyType]
	, [ExchangeRate]
	, [ItemCash0]
	, [ItemCash1]
	, [ItemCash2]
	, [ItemCash3]
	, [ItemCash4]
	, [ItemCash5]
	, [ItemCash6]
	, [ItemCash7]
	, [ItemCash8]
	, [ItemCash9]
    FROM
	dbo.[PaymentItem]
    WHERE 
	 ([PaymentItemCode] = @PaymentItemCode OR @PaymentItemCode is null)
	AND ([PaymentCode] = @PaymentCode OR @PaymentCode is null)
	AND ([CostCode] = @CostCode OR @CostCode is null)
	AND ([PaymentType] = @PaymentType OR @PaymentType is null)
	AND ([ItemMoney] = @ItemMoney OR @ItemMoney is null)
	AND ([Summary] = @Summary OR @Summary is null)
	AND ([Remark] = @Remark OR @Remark is null)
	AND ([AllocateCode] = @AllocateCode OR @AllocateCode is null)
	AND ([OldItemMoney] = @OldItemMoney OR @OldItemMoney is null)
	AND ([AlloType] = @AlloType OR @AlloType is null)
	AND ([CostBudgetSetCode] = @CostBudgetSetCode OR @CostBudgetSetCode is null)
	AND ([PBSType] = @PBSType OR @PBSType is null)
	AND ([PBSCode] = @PBSCode OR @PBSCode is null)
	AND ([Description] = @Description OR @Description is null)
	AND ([ContractCostCode] = @ContractCostCode OR @ContractCostCode is null)
	AND ([ItemCash] = @ItemCash OR @ItemCash is null)
	AND ([MoneyType] = @MoneyType OR @MoneyType is null)
	AND ([ExchangeRate] = @ExchangeRate OR @ExchangeRate is null)
	AND ([ItemCash0] = @ItemCash0 OR @ItemCash0 is null)
	AND ([ItemCash1] = @ItemCash1 OR @ItemCash1 is null)
	AND ([ItemCash2] = @ItemCash2 OR @ItemCash2 is null)
	AND ([ItemCash3] = @ItemCash3 OR @ItemCash3 is null)
	AND ([ItemCash4] = @ItemCash4 OR @ItemCash4 is null)
	AND ([ItemCash5] = @ItemCash5 OR @ItemCash5 is null)
	AND ([ItemCash6] = @ItemCash6 OR @ItemCash6 is null)
	AND ([ItemCash7] = @ItemCash7 OR @ItemCash7 is null)
	AND ([ItemCash8] = @ItemCash8 OR @ItemCash8 is null)
	AND ([ItemCash9] = @ItemCash9 OR @ItemCash9 is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [PaymentItemCode]
	, [PaymentCode]
	, [CostCode]
	, [PaymentType]
	, [ItemMoney]
	, [Summary]
	, [Remark]
	, [AllocateCode]
	, [OldItemMoney]
	, [AlloType]
	, [CostBudgetSetCode]
	, [PBSType]
	, [PBSCode]
	, [Description]
	, [ContractCostCode]
	, [ItemCash]
	, [MoneyType]
	, [ExchangeRate]
	, [ItemCash0]
	, [ItemCash1]
	, [ItemCash2]
	, [ItemCash3]
	, [ItemCash4]
	, [ItemCash5]
	, [ItemCash6]
	, [ItemCash7]
	, [ItemCash8]
	, [ItemCash9]
    FROM
	dbo.[PaymentItem]
    WHERE 
	 ([PaymentItemCode] = @PaymentItemCode AND @PaymentItemCode is not null)
	OR ([PaymentCode] = @PaymentCode AND @PaymentCode is not null)
	OR ([CostCode] = @CostCode AND @CostCode is not null)
	OR ([PaymentType] = @PaymentType AND @PaymentType is not null)
	OR ([ItemMoney] = @ItemMoney AND @ItemMoney is not null)
	OR ([Summary] = @Summary AND @Summary is not null)
	OR ([Remark] = @Remark AND @Remark is not null)
	OR ([AllocateCode] = @AllocateCode AND @AllocateCode is not null)
	OR ([OldItemMoney] = @OldItemMoney AND @OldItemMoney is not null)
	OR ([AlloType] = @AlloType AND @AlloType is not null)
	OR ([CostBudgetSetCode] = @CostBudgetSetCode AND @CostBudgetSetCode is not null)
	OR ([PBSType] = @PBSType AND @PBSType is not null)
	OR ([PBSCode] = @PBSCode AND @PBSCode is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([ContractCostCode] = @ContractCostCode AND @ContractCostCode is not null)
	OR ([ItemCash] = @ItemCash AND @ItemCash is not null)
	OR ([MoneyType] = @MoneyType AND @MoneyType is not null)
	OR ([ExchangeRate] = @ExchangeRate AND @ExchangeRate is not null)
	OR ([ItemCash0] = @ItemCash0 AND @ItemCash0 is not null)
	OR ([ItemCash1] = @ItemCash1 AND @ItemCash1 is not null)
	OR ([ItemCash2] = @ItemCash2 AND @ItemCash2 is not null)
	OR ([ItemCash3] = @ItemCash3 AND @ItemCash3 is not null)
	OR ([ItemCash4] = @ItemCash4 AND @ItemCash4 is not null)
	OR ([ItemCash5] = @ItemCash5 AND @ItemCash5 is not null)
	OR ([ItemCash6] = @ItemCash6 AND @ItemCash6 is not null)
	OR ([ItemCash7] = @ItemCash7 AND @ItemCash7 is not null)
	OR ([ItemCash8] = @ItemCash8 AND @ItemCash8 is not null)
	OR ([ItemCash9] = @ItemCash9 AND @ItemCash9 is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="PaymentItem_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the PaymentItem table using a dynamically generated query.
-- Table Comment: 请款明细
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [PaymentItemCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( PaymentItemCode )
				SELECT TOP {3} [PaymentItemCode]
				FROM dbo.[PaymentItem] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[PaymentItemCode], O.[PaymentCode], O.[CostCode], O.[PaymentType], O.[ItemMoney], O.[Summary], O.[Remark], O.[AllocateCode], O.[OldItemMoney], O.[AlloType], O.[CostBudgetSetCode], O.[PBSType], O.[PBSCode], O.[Description], O.[ContractCostCode], O.[ItemCash], O.[MoneyType], O.[ExchangeRate], O.[ItemCash0], O.[ItemCash1], O.[ItemCash2], O.[ItemCash3], O.[ItemCash4], O.[ItemCash5], O.[ItemCash6], O.[ItemCash7], O.[ItemCash8], O.[ItemCash9]
				FROM
				    dbo.[PaymentItem] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[PaymentItemCode] = PageIndex.[PaymentItemCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[PaymentItem] {0};
			
				END
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractCostPlan_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets all records from the ContractCostPlan table
-- Table Comment: 合同付款计划
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ContractCostPlanCode],
					[ContractCostCode],
					[ContractCode],
					[Money],
					[PlanningPayDate],
					[PayConditionText]
				FROM
					dbo.[ContractCostPlan]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="ContractCostPlan_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractCostPlan table passing page index and page count parameters
-- Table Comment: 合同付款计划
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractCostPlanCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				declare @SQL as nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex (ContractCostPlanCode)'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ContractCostPlanCode]'
				SET @SQL = @SQL + ' FROM dbo.[ContractCostPlan]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				exec sp_executesql @SQL

				-- Return paged results
				SELECT O.[ContractCostPlanCode], O.[ContractCostCode], O.[ContractCode], O.[Money], O.[PlanningPayDate], O.[PayConditionText]
				FROM
				    dbo.[ContractCostPlan] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > @PageLowerBound
					AND O.[ContractCostPlanCode] = PageIndex.[ContractCostPlanCode]
				ORDER BY
				    PageIndex.IndexID
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ContractCostPlan]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ContractCostPlan_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Inserts a record into the ContractCostPlan table
-- Table Comment: 合同付款计划
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PlanningPayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PayConditionText" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[ContractCostPlan]
					(
					[ContractCostPlanCode]
					,[ContractCostCode]
					,[ContractCode]
					,[Money]
					,[PlanningPayDate]
					,[PayConditionText]
					)
				VALUES
					(
					@ContractCostPlanCode
					,@ContractCostCode
					,@ContractCode
					,@Money
					,@PlanningPayDate
					,@PayConditionText
					)
				
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCostPlan_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Updates a record in the ContractCostPlan table
-- Table Comment: 合同付款计划
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@OriginalContractCostPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault=""/>
				<parameter name="@PlanningPayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@PayConditionText" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[ContractCostPlan]
				SET
					[ContractCostPlanCode] = @ContractCostPlanCode
					,[ContractCostCode] = @ContractCostCode
					,[ContractCode] = @ContractCode
					,[Money] = @Money
					,[PlanningPayDate] = @PlanningPayDate
					,[PayConditionText] = @PayConditionText
				WHERE
[ContractCostPlanCode] = @OriginalContractCostPlanCode 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCostPlan_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Deletes a record in the ContractCostPlan table
-- Table Comment: 合同付款计划
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[ContractCostPlan] WITH (ROWLOCK) 
				WHERE
					[ContractCostPlanCode] = @ContractCostPlanCode
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCostPlan_GetByContractCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractCostPlan table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SET ANSI_NULLS OFF
				
				SELECT
					[ContractCostPlanCode],
					[ContractCostCode],
					[ContractCode],
					[Money],
					[PlanningPayDate],
					[PayConditionText]
				FROM
					dbo.[ContractCostPlan]
				WHERE
					[ContractCode] = @ContractCode
				
				Select @@ROWCOUNT
				SET ANSI_NULLS ON
			]]></body>
		</procedure>
		<procedure owner="dbo" name="ContractCostPlan_GetByContractCostPlanCode" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Select records from the ContractCostPlan table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ContractCostPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ContractCostPlanCode],
					[ContractCostCode],
					[ContractCode],
					[Money],
					[PlanningPayDate],
					[PayConditionText]
				FROM
					dbo.[ContractCostPlan]
				WHERE
					[ContractCostPlanCode] = @ContractCostPlanCode
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="ContractCostPlan_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Finds records in the ContractCostPlan table passing nullable parameters
-- Table Comment: 合同付款计划
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ContractCostPlanCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCostCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@ContractCode" type="varchar" direction="Input" size="50" precision="0" scale="0" param="(50)" nulldefault="null"/>
				<parameter name="@Money" type="numeric" direction="Input" size="9" precision="18" scale="2" param="(18, 2)" nulldefault="null"/>
				<parameter name="@PlanningPayDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@PayConditionText" type="varchar" direction="Input" size="200" precision="0" scale="0" param="(200)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ContractCostPlanCode]
	, [ContractCostCode]
	, [ContractCode]
	, [Money]
	, [PlanningPayDate]
	, [PayConditionText]
    FROM
	dbo.[ContractCostPlan]
    WHERE 
	 ([ContractCostPlanCode] = @ContractCostPlanCode OR @ContractCostPlanCode is null)
	AND ([ContractCostCode] = @ContractCostCode OR @ContractCostCode is null)
	AND ([ContractCode] = @ContractCode OR @ContractCode is null)
	AND ([Money] = @Money OR @Money is null)
	AND ([PlanningPayDate] = @PlanningPayDate OR @PlanningPayDate is null)
	AND ([PayConditionText] = @PayConditionText OR @PayConditionText is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ContractCostPlanCode]
	, [ContractCostCode]
	, [ContractCode]
	, [Money]
	, [PlanningPayDate]
	, [PayConditionText]
    FROM
	dbo.[ContractCostPlan]
    WHERE 
	 ([ContractCostPlanCode] = @ContractCostPlanCode AND @ContractCostPlanCode is not null)
	OR ([ContractCostCode] = @ContractCostCode AND @ContractCostCode is not null)
	OR ([ContractCode] = @ContractCode AND @ContractCode is not null)
	OR ([Money] = @Money AND @Money is not null)
	OR ([PlanningPayDate] = @PlanningPayDate AND @PlanningPayDate is not null)
	OR ([PayConditionText] = @PayConditionText AND @PayConditionText is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>

		
		<procedure owner="dbo" name="ContractCostPlan_Find_Dynamic" grant="" skip="true">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: 2007年3月13日

-- Created By: 上海天诺科技有限公司 (WWW.TIANNUO.COM)
-- Purpose: Gets records from the ContractCostPlan table using a dynamically generated query.
-- Table Comment: 合同付款计划
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				BEGIN
				
				-- Create a temp table to store the select results
				Create Table #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ContractCostPlanCode] varchar(50) COLLATE database_default  
				)
				
				-- Insert into the temp table
				INSERT INTO #PageIndex ( ContractCostPlanCode )
				SELECT TOP {3} [ContractCostPlanCode]
				FROM dbo.[ContractCostPlan] {0}
				ORDER BY {1}
				
				-- Return paged results
				SELECT O.[ContractCostPlanCode], O.[ContractCostCode], O.[ContractCode], O.[Money], O.[PlanningPayDate], O.[PayConditionText]
				FROM
				    dbo.[ContractCostPlan] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexID > {2}
				    AND O.[ContractCostPlanCode] = PageIndex.[ContractCostPlanCode]
				ORDER BY
				    PageIndex.IndexID
				

				-- get total count
				select count(*) as TotalRowCount from dbo.[ContractCostPlan] {0};
			
				END
			]]></body>
		</procedure>
		
</procedures>
</root>
