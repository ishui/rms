<?xml version="1.0"?>
<Entity>
  <Name>TaskExecute</Name>
  <Type>Single</Type>
  <Table>
    <Name>TaskExecute</Name>
    <Column>
      <Name>TaskExecuteCode</Name>
      <DataType>System.String</DataType>
      <IsKey>true</IsKey>
      <IsAllowNull>false</IsAllowNull>
      <ColumnSize>50</ColumnSize>
    </Column>
    <Column>
      <Name>WBSCode</Name>
      <DataType>System.String</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>50</ColumnSize>
    </Column>
    <Column>
      <Name>ExecuteDate</Name>
      <DataType>System.DateTime</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>8</ColumnSize>
    </Column>
    <Column>
      <Name>Detail</Name>
      <DataType>System.String</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>2147483647</ColumnSize>
    </Column>
    <Column>
      <Name>HtmlDetail</Name>
      <DataType>System.String</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>2147483647</ColumnSize>
    </Column>
    <Column>
      <Name>ExecutePerson</Name>
      <DataType>System.String</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>50</ColumnSize>
    </Column>
    <Column>
      <Name>ProjectCode</Name>
      <DataType>System.String</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>50</ColumnSize>
    </Column>
    <Column>
      <Name>RiskRemark</Name>
      <DataType>System.String</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>2147483647</ColumnSize>
    </Column>
    <Column>
      <Name>HtmlRiskRemark</Name>
      <DataType>System.String</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>2147483647</ColumnSize>
    </Column>
    <Column>
      <Name>InputDate</Name>
      <DataType>System.DateTime</DataType>
      <IsKey>false</IsKey>
      <IsAllowNull>true</IsAllowNull>
      <ColumnSize>8</ColumnSize>
    </Column>
    <Sql>
      <Name>Insert</Name>
      <String> Insert into TaskExecute (  TaskExecuteCode, WBSCode, ExecuteDate, Detail, HtmlDetail, ExecutePerson, ProjectCode, RiskRemark, HtmlRiskRemark, InputDate ) values (  @TaskExecuteCode, @WBSCode, @ExecuteDate, @Detail, @HtmlDetail, @ExecutePerson, @ProjectCode, @RiskRemark, @HtmlRiskRemark, @InputDate )</String>
      <CommandType>Text</CommandType>
      <Param>
        <Name>@TaskExecuteCode</Name>
        <Column>TaskExecuteCode</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
      <Param>
        <Name>@WBSCode</Name>
        <Column>WBSCode</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
      <Param>
        <Name>@ExecuteDate</Name>
        <Column>ExecuteDate</Column>
        <SqlDbType>DateTime</SqlDbType>
      </Param>
      <Param>
        <Name>@Detail</Name>
        <Column>Detail</Column>
        <SqlDbType>Text</SqlDbType>
      </Param>
      <Param>
        <Name>@HtmlDetail</Name>
        <Column>HtmlDetail</Column>
        <SqlDbType>Text</SqlDbType>
      </Param>
      <Param>
        <Name>@ExecutePerson</Name>
        <Column>ExecutePerson</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
      <Param>
        <Name>@ProjectCode</Name>
        <Column>ProjectCode</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
      <Param>
        <Name>@RiskRemark</Name>
        <Column>RiskRemark</Column>
        <SqlDbType>Text</SqlDbType>
      </Param>
      <Param>
        <Name>@HtmlRiskRemark</Name>
        <Column>HtmlRiskRemark</Column>
        <SqlDbType>Text</SqlDbType>
      </Param>
      <Param>
        <Name>@InputDate</Name>
        <Column>InputDate</Column>
        <SqlDbType>DateTime</SqlDbType>
      </Param>
    </Sql>
    <Sql>
      <Name>Update</Name>
      <String> Update TaskExecute set WBSCode=@WBSCode,ExecuteDate=@ExecuteDate,Detail=@Detail,HtmlDetail=@HtmlDetail,ExecutePerson=@ExecutePerson,ProjectCode=@ProjectCode,RiskRemark=@RiskRemark,HtmlRiskRemark=@HtmlRiskRemark,InputDate=@InputDate where  TaskExecuteCode=@TaskExecuteCode</String>
      <CommandType>Text</CommandType>
      <Param>
        <Name>@TaskExecuteCode</Name>
        <Column>TaskExecuteCode</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
      <Param>
        <Name>@WBSCode</Name>
        <Column>WBSCode</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
      <Param>
        <Name>@ExecuteDate</Name>
        <Column>ExecuteDate</Column>
        <SqlDbType>DateTime</SqlDbType>
      </Param>
      <Param>
        <Name>@Detail</Name>
        <Column>Detail</Column>
        <SqlDbType>Text</SqlDbType>
      </Param>
      <Param>
        <Name>@HtmlDetail</Name>
        <Column>HtmlDetail</Column>
        <SqlDbType>Text</SqlDbType>
      </Param>
      <Param>
        <Name>@ExecutePerson</Name>
        <Column>ExecutePerson</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
      <Param>
        <Name>@ProjectCode</Name>
        <Column>ProjectCode</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
      <Param>
        <Name>@RiskRemark</Name>
        <Column>RiskRemark</Column>
        <SqlDbType>Text</SqlDbType>
      </Param>
      <Param>
        <Name>@HtmlRiskRemark</Name>
        <Column>HtmlRiskRemark</Column>
        <SqlDbType>Text</SqlDbType>
      </Param>
      <Param>
        <Name>@InputDate</Name>
        <Column>InputDate</Column>
        <SqlDbType>DateTime</SqlDbType>
      </Param>
    </Sql>
    <Sql>
      <Name>Delete</Name>
      <String> Delete from TaskExecute  where  TaskExecuteCode=@TaskExecuteCode</String>
      <CommandType>Text</CommandType>
      <Param>
        <Name>@TaskExecuteCode</Name>
        <Column>TaskExecuteCode</Column>
        <SqlDbType>VarChar</SqlDbType>
      </Param>
    </Sql>
    <Sql>
      <Name>Select</Name>
			<String>select * from TaskExecute where  TaskExecuteCode=@TaskExecuteCode</String>
			<CommandType>Text</CommandType>
			<Param>
				<Name>@TaskExecuteCode</Name>
				<Column>TaskExecuteCode</Column>
				<SqlDbType>VarChar</SqlDbType>
			</Param>
		</Sql>
		<Sql>
			<Name>SelectAll</Name>
			<String>select * from TaskExecute a</String>
			<CommandType>Text</CommandType>
		</Sql>
		<Sql>
			<Name>SelectView</Name>
			<String> select * from V_TaskExecute a</String>
			<CommandType>Text</CommandType>
		</Sql>
		<Sql>
			<Name>SelectByWBSCode</Name>
			<String>select * from TaskExecute where WBSCode=@WBSCode</String>
			<CommandType>Text</CommandType>
			<Param>
				<Name>@WBSCode</Name>
				<Column>WBSCode</Column>
				<SqlDbType>VarChar</SqlDbType>
			</Param>
		</Sql>
		<Sql>
			<Name>SelectDeskTopByUserCode</Name>
			<String>select * from taskexecute a,task b where a.wbscode=b.wbscode and (a.TaskExecuteCode in (select ExecuteCode from TaskPerson where UserCode=@UserCode) or a.ExecutePerson=@UserCode )</String>
			<CommandType>Text</CommandType>
			<Param>
				<Name>@UserCode</Name>
				<Column>UserCode</Column>
				<SqlDbType>VarChar</SqlDbType>
			</Param>
		</Sql>
	</Table>
</Entity>